{"version":3,"file":"355a6ca7-7d3ff1df35f7958f1b25.js","mappings":"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","sources":["webpack://AutoGen_Studio/./node_modules/@antv/g-lite/dist/index.esm.js"],"sourcesContent":["import { __assign, __read, __extends, __spreadArray, __awaiter, __generator, __values, __rest } from 'tslib';\nimport EventEmitter from 'eventemitter3';\nimport { mat4, vec4, vec3, mat3, quat as quat$1, vec2 } from 'gl-matrix';\nimport { isNumber, distanceSquareRoot, isString, isNil, clamp, getTotalLength, min, max, isNumberEqual, mod, normalizePath, path2Curve, equalizeSegments, getDrawDirection, reverseCurve, clonePath, getRotatedCurve, isUndefined, isArray, isBoolean, isObject, getPointAtLength } from '@antv/util';\nimport * as d3 from 'd3-color';\nimport { polylineLength, arcBox, cubicBox, quadBox, linePointAt, lineLength } from '@antv/g-math';\n\nvar commonjsGlobal = typeof globalThis !== 'undefined' ? globalThis : typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n\nvar rbush = {exports: {}};\n\n(function (module, exports) {\n(function (global, factory) {\nmodule.exports = factory() ;\n}(commonjsGlobal, function () {\nfunction quickselect(arr, k, left, right, compare) {\n    quickselectStep(arr, k, left || 0, right || (arr.length - 1), compare || defaultCompare);\n}\n\nfunction quickselectStep(arr, k, left, right, compare) {\n\n    while (right > left) {\n        if (right - left > 600) {\n            var n = right - left + 1;\n            var m = k - left + 1;\n            var z = Math.log(n);\n            var s = 0.5 * Math.exp(2 * z / 3);\n            var sd = 0.5 * Math.sqrt(z * s * (n - s) / n) * (m - n / 2 < 0 ? -1 : 1);\n            var newLeft = Math.max(left, Math.floor(k - m * s / n + sd));\n            var newRight = Math.min(right, Math.floor(k + (n - m) * s / n + sd));\n            quickselectStep(arr, k, newLeft, newRight, compare);\n        }\n\n        var t = arr[k];\n        var i = left;\n        var j = right;\n\n        swap(arr, left, k);\n        if (compare(arr[right], t) > 0) { swap(arr, left, right); }\n\n        while (i < j) {\n            swap(arr, i, j);\n            i++;\n            j--;\n            while (compare(arr[i], t) < 0) { i++; }\n            while (compare(arr[j], t) > 0) { j--; }\n        }\n\n        if (compare(arr[left], t) === 0) { swap(arr, left, j); }\n        else {\n            j++;\n            swap(arr, j, right);\n        }\n\n        if (j <= k) { left = j + 1; }\n        if (k <= j) { right = j - 1; }\n    }\n}\n\nfunction swap(arr, i, j) {\n    var tmp = arr[i];\n    arr[i] = arr[j];\n    arr[j] = tmp;\n}\n\nfunction defaultCompare(a, b) {\n    return a < b ? -1 : a > b ? 1 : 0;\n}\n\nvar RBush = function RBush(maxEntries) {\n    if ( maxEntries === void 0 ) maxEntries = 9;\n\n    // max entries in a node is 9 by default; min node fill is 40% for best performance\n    this._maxEntries = Math.max(4, maxEntries);\n    this._minEntries = Math.max(2, Math.ceil(this._maxEntries * 0.4));\n    this.clear();\n};\n\nRBush.prototype.all = function all () {\n    return this._all(this.data, []);\n};\n\nRBush.prototype.search = function search (bbox) {\n    var node = this.data;\n    var result = [];\n\n    if (!intersects(bbox, node)) { return result; }\n\n    var toBBox = this.toBBox;\n    var nodesToSearch = [];\n\n    while (node) {\n        for (var i = 0; i < node.children.length; i++) {\n            var child = node.children[i];\n            var childBBox = node.leaf ? toBBox(child) : child;\n\n            if (intersects(bbox, childBBox)) {\n                if (node.leaf) { result.push(child); }\n                else if (contains(bbox, childBBox)) { this._all(child, result); }\n                else { nodesToSearch.push(child); }\n            }\n        }\n        node = nodesToSearch.pop();\n    }\n\n    return result;\n};\n\nRBush.prototype.collides = function collides (bbox) {\n    var node = this.data;\n\n    if (!intersects(bbox, node)) { return false; }\n\n    var nodesToSearch = [];\n    while (node) {\n        for (var i = 0; i < node.children.length; i++) {\n            var child = node.children[i];\n            var childBBox = node.leaf ? this.toBBox(child) : child;\n\n            if (intersects(bbox, childBBox)) {\n                if (node.leaf || contains(bbox, childBBox)) { return true; }\n                nodesToSearch.push(child);\n            }\n        }\n        node = nodesToSearch.pop();\n    }\n\n    return false;\n};\n\nRBush.prototype.load = function load (data) {\n    if (!(data && data.length)) { return this; }\n\n    if (data.length < this._minEntries) {\n        for (var i = 0; i < data.length; i++) {\n            this.insert(data[i]);\n        }\n        return this;\n    }\n\n    // recursively build the tree with the given data from scratch using OMT algorithm\n    var node = this._build(data.slice(), 0, data.length - 1, 0);\n\n    if (!this.data.children.length) {\n        // save as is if tree is empty\n        this.data = node;\n\n    } else if (this.data.height === node.height) {\n        // split root if trees have the same height\n        this._splitRoot(this.data, node);\n\n    } else {\n        if (this.data.height < node.height) {\n            // swap trees if inserted one is bigger\n            var tmpNode = this.data;\n            this.data = node;\n            node = tmpNode;\n        }\n\n        // insert the small tree into the large tree at appropriate level\n        this._insert(node, this.data.height - node.height - 1, true);\n    }\n\n    return this;\n};\n\nRBush.prototype.insert = function insert (item) {\n    if (item) { this._insert(item, this.data.height - 1); }\n    return this;\n};\n\nRBush.prototype.clear = function clear () {\n    this.data = createNode([]);\n    return this;\n};\n\nRBush.prototype.remove = function remove (item, equalsFn) {\n    if (!item) { return this; }\n\n    var node = this.data;\n    var bbox = this.toBBox(item);\n    var path = [];\n    var indexes = [];\n    var i, parent, goingUp;\n\n    // depth-first iterative tree traversal\n    while (node || path.length) {\n\n        if (!node) { // go up\n            node = path.pop();\n            parent = path[path.length - 1];\n            i = indexes.pop();\n            goingUp = true;\n        }\n\n        if (node.leaf) { // check current node\n            var index = findItem(item, node.children, equalsFn);\n\n            if (index !== -1) {\n                // item found, remove the item and condense tree upwards\n                node.children.splice(index, 1);\n                path.push(node);\n                this._condense(path);\n                return this;\n            }\n        }\n\n        if (!goingUp && !node.leaf && contains(node, bbox)) { // go down\n            path.push(node);\n            indexes.push(i);\n            i = 0;\n            parent = node;\n            node = node.children[0];\n\n        } else if (parent) { // go right\n            i++;\n            node = parent.children[i];\n            goingUp = false;\n\n        } else { node = null; } // nothing found\n    }\n\n    return this;\n};\n\nRBush.prototype.toBBox = function toBBox (item) { return item; };\n\nRBush.prototype.compareMinX = function compareMinX (a, b) { return a.minX - b.minX; };\nRBush.prototype.compareMinY = function compareMinY (a, b) { return a.minY - b.minY; };\n\nRBush.prototype.toJSON = function toJSON () { return this.data; };\n\nRBush.prototype.fromJSON = function fromJSON (data) {\n    this.data = data;\n    return this;\n};\n\nRBush.prototype._all = function _all (node, result) {\n    var nodesToSearch = [];\n    while (node) {\n        if (node.leaf) { result.push.apply(result, node.children); }\n        else { nodesToSearch.push.apply(nodesToSearch, node.children); }\n\n        node = nodesToSearch.pop();\n    }\n    return result;\n};\n\nRBush.prototype._build = function _build (items, left, right, height) {\n\n    var N = right - left + 1;\n    var M = this._maxEntries;\n    var node;\n\n    if (N <= M) {\n        // reached leaf level; return leaf\n        node = createNode(items.slice(left, right + 1));\n        calcBBox(node, this.toBBox);\n        return node;\n    }\n\n    if (!height) {\n        // target height of the bulk-loaded tree\n        height = Math.ceil(Math.log(N) / Math.log(M));\n\n        // target number of root entries to maximize storage utilization\n        M = Math.ceil(N / Math.pow(M, height - 1));\n    }\n\n    node = createNode([]);\n    node.leaf = false;\n    node.height = height;\n\n    // split the items into M mostly square tiles\n\n    var N2 = Math.ceil(N / M);\n    var N1 = N2 * Math.ceil(Math.sqrt(M));\n\n    multiSelect(items, left, right, N1, this.compareMinX);\n\n    for (var i = left; i <= right; i += N1) {\n\n        var right2 = Math.min(i + N1 - 1, right);\n\n        multiSelect(items, i, right2, N2, this.compareMinY);\n\n        for (var j = i; j <= right2; j += N2) {\n\n            var right3 = Math.min(j + N2 - 1, right2);\n\n            // pack each entry recursively\n            node.children.push(this._build(items, j, right3, height - 1));\n        }\n    }\n\n    calcBBox(node, this.toBBox);\n\n    return node;\n};\n\nRBush.prototype._chooseSubtree = function _chooseSubtree (bbox, node, level, path) {\n    while (true) {\n        path.push(node);\n\n        if (node.leaf || path.length - 1 === level) { break; }\n\n        var minArea = Infinity;\n        var minEnlargement = Infinity;\n        var targetNode = (void 0);\n\n        for (var i = 0; i < node.children.length; i++) {\n            var child = node.children[i];\n            var area = bboxArea(child);\n            var enlargement = enlargedArea(bbox, child) - area;\n\n            // choose entry with the least area enlargement\n            if (enlargement < minEnlargement) {\n                minEnlargement = enlargement;\n                minArea = area < minArea ? area : minArea;\n                targetNode = child;\n\n            } else if (enlargement === minEnlargement) {\n                // otherwise choose one with the smallest area\n                if (area < minArea) {\n                    minArea = area;\n                    targetNode = child;\n                }\n            }\n        }\n\n        node = targetNode || node.children[0];\n    }\n\n    return node;\n};\n\nRBush.prototype._insert = function _insert (item, level, isNode) {\n    var bbox = isNode ? item : this.toBBox(item);\n    var insertPath = [];\n\n    // find the best node for accommodating the item, saving all nodes along the path too\n    var node = this._chooseSubtree(bbox, this.data, level, insertPath);\n\n    // put the item into the node\n    node.children.push(item);\n    extend(node, bbox);\n\n    // split on node overflow; propagate upwards if necessary\n    while (level >= 0) {\n        if (insertPath[level].children.length > this._maxEntries) {\n            this._split(insertPath, level);\n            level--;\n        } else { break; }\n    }\n\n    // adjust bboxes along the insertion path\n    this._adjustParentBBoxes(bbox, insertPath, level);\n};\n\n// split overflowed node into two\nRBush.prototype._split = function _split (insertPath, level) {\n    var node = insertPath[level];\n    var M = node.children.length;\n    var m = this._minEntries;\n\n    this._chooseSplitAxis(node, m, M);\n\n    var splitIndex = this._chooseSplitIndex(node, m, M);\n\n    var newNode = createNode(node.children.splice(splitIndex, node.children.length - splitIndex));\n    newNode.height = node.height;\n    newNode.leaf = node.leaf;\n\n    calcBBox(node, this.toBBox);\n    calcBBox(newNode, this.toBBox);\n\n    if (level) { insertPath[level - 1].children.push(newNode); }\n    else { this._splitRoot(node, newNode); }\n};\n\nRBush.prototype._splitRoot = function _splitRoot (node, newNode) {\n    // split root node\n    this.data = createNode([node, newNode]);\n    this.data.height = node.height + 1;\n    this.data.leaf = false;\n    calcBBox(this.data, this.toBBox);\n};\n\nRBush.prototype._chooseSplitIndex = function _chooseSplitIndex (node, m, M) {\n    var index;\n    var minOverlap = Infinity;\n    var minArea = Infinity;\n\n    for (var i = m; i <= M - m; i++) {\n        var bbox1 = distBBox(node, 0, i, this.toBBox);\n        var bbox2 = distBBox(node, i, M, this.toBBox);\n\n        var overlap = intersectionArea(bbox1, bbox2);\n        var area = bboxArea(bbox1) + bboxArea(bbox2);\n\n        // choose distribution with minimum overlap\n        if (overlap < minOverlap) {\n            minOverlap = overlap;\n            index = i;\n\n            minArea = area < minArea ? area : minArea;\n\n        } else if (overlap === minOverlap) {\n            // otherwise choose distribution with minimum area\n            if (area < minArea) {\n                minArea = area;\n                index = i;\n            }\n        }\n    }\n\n    return index || M - m;\n};\n\n// sorts node children by the best axis for split\nRBush.prototype._chooseSplitAxis = function _chooseSplitAxis (node, m, M) {\n    var compareMinX = node.leaf ? this.compareMinX : compareNodeMinX;\n    var compareMinY = node.leaf ? this.compareMinY : compareNodeMinY;\n    var xMargin = this._allDistMargin(node, m, M, compareMinX);\n    var yMargin = this._allDistMargin(node, m, M, compareMinY);\n\n    // if total distributions margin value is minimal for x, sort by minX,\n    // otherwise it's already sorted by minY\n    if (xMargin < yMargin) { node.children.sort(compareMinX); }\n};\n\n// total margin of all possible split distributions where each node is at least m full\nRBush.prototype._allDistMargin = function _allDistMargin (node, m, M, compare) {\n    node.children.sort(compare);\n\n    var toBBox = this.toBBox;\n    var leftBBox = distBBox(node, 0, m, toBBox);\n    var rightBBox = distBBox(node, M - m, M, toBBox);\n    var margin = bboxMargin(leftBBox) + bboxMargin(rightBBox);\n\n    for (var i = m; i < M - m; i++) {\n        var child = node.children[i];\n        extend(leftBBox, node.leaf ? toBBox(child) : child);\n        margin += bboxMargin(leftBBox);\n    }\n\n    for (var i$1 = M - m - 1; i$1 >= m; i$1--) {\n        var child$1 = node.children[i$1];\n        extend(rightBBox, node.leaf ? toBBox(child$1) : child$1);\n        margin += bboxMargin(rightBBox);\n    }\n\n    return margin;\n};\n\nRBush.prototype._adjustParentBBoxes = function _adjustParentBBoxes (bbox, path, level) {\n    // adjust bboxes along the given tree path\n    for (var i = level; i >= 0; i--) {\n        extend(path[i], bbox);\n    }\n};\n\nRBush.prototype._condense = function _condense (path) {\n    // go through the path, removing empty nodes and updating bboxes\n    for (var i = path.length - 1, siblings = (void 0); i >= 0; i--) {\n        if (path[i].children.length === 0) {\n            if (i > 0) {\n                siblings = path[i - 1].children;\n                siblings.splice(siblings.indexOf(path[i]), 1);\n\n            } else { this.clear(); }\n\n        } else { calcBBox(path[i], this.toBBox); }\n    }\n};\n\nfunction findItem(item, items, equalsFn) {\n    if (!equalsFn) { return items.indexOf(item); }\n\n    for (var i = 0; i < items.length; i++) {\n        if (equalsFn(item, items[i])) { return i; }\n    }\n    return -1;\n}\n\n// calculate node's bbox from bboxes of its children\nfunction calcBBox(node, toBBox) {\n    distBBox(node, 0, node.children.length, toBBox, node);\n}\n\n// min bounding rectangle of node children from k to p-1\nfunction distBBox(node, k, p, toBBox, destNode) {\n    if (!destNode) { destNode = createNode(null); }\n    destNode.minX = Infinity;\n    destNode.minY = Infinity;\n    destNode.maxX = -Infinity;\n    destNode.maxY = -Infinity;\n\n    for (var i = k; i < p; i++) {\n        var child = node.children[i];\n        extend(destNode, node.leaf ? toBBox(child) : child);\n    }\n\n    return destNode;\n}\n\nfunction extend(a, b) {\n    a.minX = Math.min(a.minX, b.minX);\n    a.minY = Math.min(a.minY, b.minY);\n    a.maxX = Math.max(a.maxX, b.maxX);\n    a.maxY = Math.max(a.maxY, b.maxY);\n    return a;\n}\n\nfunction compareNodeMinX(a, b) { return a.minX - b.minX; }\nfunction compareNodeMinY(a, b) { return a.minY - b.minY; }\n\nfunction bboxArea(a)   { return (a.maxX - a.minX) * (a.maxY - a.minY); }\nfunction bboxMargin(a) { return (a.maxX - a.minX) + (a.maxY - a.minY); }\n\nfunction enlargedArea(a, b) {\n    return (Math.max(b.maxX, a.maxX) - Math.min(b.minX, a.minX)) *\n           (Math.max(b.maxY, a.maxY) - Math.min(b.minY, a.minY));\n}\n\nfunction intersectionArea(a, b) {\n    var minX = Math.max(a.minX, b.minX);\n    var minY = Math.max(a.minY, b.minY);\n    var maxX = Math.min(a.maxX, b.maxX);\n    var maxY = Math.min(a.maxY, b.maxY);\n\n    return Math.max(0, maxX - minX) *\n           Math.max(0, maxY - minY);\n}\n\nfunction contains(a, b) {\n    return a.minX <= b.minX &&\n           a.minY <= b.minY &&\n           b.maxX <= a.maxX &&\n           b.maxY <= a.maxY;\n}\n\nfunction intersects(a, b) {\n    return b.minX <= a.maxX &&\n           b.minY <= a.maxY &&\n           b.maxX >= a.minX &&\n           b.maxY >= a.minY;\n}\n\nfunction createNode(children) {\n    return {\n        children: children,\n        height: 1,\n        leaf: true,\n        minX: Infinity,\n        minY: Infinity,\n        maxX: -Infinity,\n        maxY: -Infinity\n    };\n}\n\n// sort an array so that items come in groups of n unsorted items, with groups sorted between each other;\n// combines selection algorithm with binary divide & conquer approach\n\nfunction multiSelect(arr, left, right, n, compare) {\n    var stack = [left, right];\n\n    while (stack.length) {\n        right = stack.pop();\n        left = stack.pop();\n\n        if (right - left <= n) { continue; }\n\n        var mid = left + Math.ceil((right - left) / n / 2) * n;\n        quickselect(arr, mid, left, right, compare);\n\n        stack.push(left, mid, mid, right);\n    }\n}\n\nreturn RBush;\n\n}));\n}(rbush));\n\nvar RBush = rbush.exports;\n\nvar Shape;\n(function (Shape) {\n    Shape[\"GROUP\"] = \"g\";\n    Shape[\"CIRCLE\"] = \"circle\";\n    Shape[\"ELLIPSE\"] = \"ellipse\";\n    Shape[\"IMAGE\"] = \"image\";\n    Shape[\"RECT\"] = \"rect\";\n    Shape[\"LINE\"] = \"line\";\n    Shape[\"POLYLINE\"] = \"polyline\";\n    Shape[\"POLYGON\"] = \"polygon\";\n    Shape[\"TEXT\"] = \"text\";\n    Shape[\"PATH\"] = \"path\";\n    Shape[\"HTML\"] = \"html\";\n    Shape[\"MESH\"] = \"mesh\";\n})(Shape || (Shape = {}));\nvar ClipSpaceNearZ;\n(function (ClipSpaceNearZ) {\n    ClipSpaceNearZ[ClipSpaceNearZ[\"ZERO\"] = 0] = \"ZERO\";\n    ClipSpaceNearZ[ClipSpaceNearZ[\"NEGATIVE_ONE\"] = 1] = \"NEGATIVE_ONE\";\n})(ClipSpaceNearZ || (ClipSpaceNearZ = {}));\n\nvar AbstractRendererPlugin = /** @class */ (function () {\n    function AbstractRendererPlugin() {\n        this.plugins = [];\n    }\n    AbstractRendererPlugin.prototype.addRenderingPlugin = function (plugin) {\n        this.plugins.push(plugin);\n        this.context.renderingPlugins.push(plugin);\n    };\n    AbstractRendererPlugin.prototype.removeAllRenderingPlugins = function () {\n        var _this = this;\n        this.plugins.forEach(function (plugin) {\n            var index = _this.context.renderingPlugins.indexOf(plugin);\n            if (index >= 0) {\n                _this.context.renderingPlugins.splice(index, 1);\n            }\n        });\n    };\n    return AbstractRendererPlugin;\n}());\nvar AbstractRenderer = /** @class */ (function () {\n    function AbstractRenderer(config) {\n        this.clipSpaceNearZ = ClipSpaceNearZ.NEGATIVE_ONE;\n        this.plugins = [];\n        this.config = __assign({ \n            /**\n             * only dirty object will cause re-render\n             */\n            enableDirtyCheck: true, enableCulling: false, \n            /**\n             * enable auto rendering by default\n             */\n            enableAutoRendering: true, \n            /**\n             * enable dirty rectangle rendering by default\n             */\n            enableDirtyRectangleRendering: true, enableDirtyRectangleRenderingDebug: false, enableSizeAttenuation: true }, config);\n    }\n    AbstractRenderer.prototype.registerPlugin = function (plugin) {\n        var index = this.plugins.findIndex(function (p) { return p === plugin; });\n        if (index === -1) {\n            this.plugins.push(plugin);\n        }\n    };\n    AbstractRenderer.prototype.unregisterPlugin = function (plugin) {\n        var index = this.plugins.findIndex(function (p) { return p === plugin; });\n        if (index > -1) {\n            this.plugins.splice(index, 1);\n        }\n    };\n    AbstractRenderer.prototype.getPlugins = function () {\n        return this.plugins;\n    };\n    AbstractRenderer.prototype.getPlugin = function (name) {\n        return this.plugins.find(function (plugin) { return plugin.name === name; });\n    };\n    AbstractRenderer.prototype.getConfig = function () {\n        return this.config;\n    };\n    AbstractRenderer.prototype.setConfig = function (config) {\n        Object.assign(this.config, config);\n    };\n    return AbstractRenderer;\n}());\n\nfunction copyVec3(a, b) {\n    a[0] = b[0];\n    a[1] = b[1];\n    a[2] = b[2];\n    return a;\n}\nfunction subVec3(o, a, b) {\n    o[0] = a[0] - b[0];\n    o[1] = a[1] - b[1];\n    o[2] = a[2] - b[2];\n    return o;\n}\nfunction addVec3(o, a, b) {\n    o[0] = a[0] + b[0];\n    o[1] = a[1] + b[1];\n    o[2] = a[2] + b[2];\n    return o;\n}\nfunction scaleVec3(o, a, b) {\n    o[0] = a[0] * b;\n    o[1] = a[1] * b;\n    o[2] = a[2] * b;\n    return o;\n}\nfunction maxVec3(o, a, b) {\n    o[0] = Math.max(a[0], b[0]);\n    o[1] = Math.max(a[1], b[1]);\n    o[2] = Math.max(a[2], b[2]);\n    return o;\n}\nfunction minVec3(o, a, b) {\n    o[0] = Math.min(a[0], b[0]);\n    o[1] = Math.min(a[1], b[1]);\n    o[2] = Math.min(a[2], b[2]);\n    return o;\n}\nfunction getAngle(angle) {\n    if (angle === undefined) {\n        return 0;\n    }\n    else if (angle > 360 || angle < -360) {\n        return angle % 360;\n    }\n    return angle;\n}\nfunction createVec3(x, y, z) {\n    if (y === void 0) { y = 0; }\n    if (z === void 0) { z = 0; }\n    if (Array.isArray(x) && x.length === 3) {\n        return vec3.clone(x);\n    }\n    if (isNumber(x)) {\n        return vec3.fromValues(x, y, z);\n    }\n    return vec3.fromValues(x[0], x[1] || y, x[2] || z);\n}\nfunction deg2rad(deg) {\n    return deg * (Math.PI / 180);\n}\nfunction rad2deg(rad) {\n    return rad * (180 / Math.PI);\n}\nfunction grad2deg(grads) {\n    grads = grads % 400;\n    if (grads < 0) {\n        grads += 400;\n    }\n    return (grads / 400) * 360;\n}\nfunction deg2turn(deg) {\n    return deg / 360;\n}\nfunction turn2deg(turn) {\n    return 360 * turn;\n}\nfunction getEulerFromQuat(out, quat) {\n    var x = quat[0];\n    var y = quat[1];\n    var z = quat[2];\n    var w = quat[3];\n    var x2 = x * x;\n    var y2 = y * y;\n    var z2 = z * z;\n    var w2 = w * w;\n    var unit = x2 + y2 + z2 + w2;\n    var test = x * w - y * z;\n    if (test > 0.499995 * unit) {\n        // TODO: Use glmatrix.EPSILON\n        // singularity at the north pole\n        out[0] = Math.PI / 2;\n        out[1] = 2 * Math.atan2(y, x);\n        out[2] = 0;\n    }\n    else if (test < -0.499995 * unit) {\n        //TODO: Use glmatrix.EPSILON\n        // singularity at the south pole\n        out[0] = -Math.PI / 2;\n        out[1] = 2 * Math.atan2(y, x);\n        out[2] = 0;\n    }\n    else {\n        out[0] = Math.asin(2 * (x * z - w * y));\n        out[1] = Math.atan2(2 * (x * w + y * z), 1 - 2 * (z2 + w2));\n        out[2] = Math.atan2(2 * (x * y + z * w), 1 - 2 * (y2 + z2));\n    }\n    // TODO: Return them as degrees and not as radians\n    return out;\n}\nfunction getEulerFromMat4(out, m) {\n    var x;\n    var z;\n    var halfPi = Math.PI * 0.5;\n    var _a = __read(mat4.getScaling(vec3.create(), m), 3), sx = _a[0], sy = _a[1], sz = _a[2];\n    var y = Math.asin(-m[2] / sx);\n    if (y < halfPi) {\n        if (y > -halfPi) {\n            x = Math.atan2(m[6] / sy, m[10] / sz);\n            z = Math.atan2(m[1] / sx, m[0] / sx);\n        }\n        else {\n            // Not a unique solution\n            z = 0;\n            x = -Math.atan2(m[4] / sy, m[5] / sy);\n        }\n    }\n    else {\n        // Not a unique solution\n        z = 0;\n        x = Math.atan2(m[4] / sy, m[5] / sy);\n    }\n    out[0] = x;\n    out[1] = y;\n    out[2] = z;\n    return out;\n}\n/**\n * @see https://github.com/toji/gl-matrix/issues/329\n * @see https://doc.babylonjs.com/divingDeeper/mesh/transforms/center_origin/rotation_conventions\n */\nfunction getEuler(out, quat) {\n    if (quat.length === 16) {\n        return getEulerFromMat4(out, quat);\n    }\n    else {\n        return getEulerFromQuat(out, quat);\n    }\n}\nfunction fromRotationTranslationScale(rotation, x, y, scaleX, scaleY) {\n    var cos = Math.cos(rotation);\n    var sin = Math.sin(rotation);\n    return mat3.fromValues(scaleX * cos, scaleY * sin, 0, -scaleX * sin, scaleY * cos, 0, x, y, 1);\n}\nfunction makePerspective(out, left, right, top, bottom, near, far, zero) {\n    if (zero === void 0) { zero = false; }\n    var x = (2 * near) / (right - left);\n    var y = (2 * near) / (top - bottom);\n    var a = (right + left) / (right - left);\n    var b = (top + bottom) / (top - bottom);\n    var c;\n    var d;\n    if (zero) {\n        c = -far / (far - near);\n        d = (-far * near) / (far - near);\n    }\n    else {\n        c = -(far + near) / (far - near);\n        d = (-2 * far * near) / (far - near);\n    }\n    out[0] = x;\n    out[1] = 0;\n    out[2] = 0;\n    out[3] = 0;\n    out[4] = 0;\n    out[5] = y;\n    out[6] = 0;\n    out[7] = 0;\n    out[8] = a;\n    out[9] = b;\n    out[10] = c;\n    out[11] = -1;\n    out[12] = 0;\n    out[13] = 0;\n    out[14] = d;\n    out[15] = 0;\n    return out;\n}\nfunction decompose(mat) {\n    var row0x = mat[0];\n    var row0y = mat[1];\n    var row1x = mat[3];\n    var row1y = mat[4];\n    // decompose 3x3 matrix\n    // @see https://www.w3.org/TR/css-transforms-1/#decomposing-a-2d-matrix\n    var scalingX = Math.sqrt(row0x * row0x + row0y * row0y);\n    var scalingY = Math.sqrt(row1x * row1x + row1y * row1y);\n    // If determinant is negative, one axis was flipped.\n    var determinant = row0x * row1y - row0y * row1x;\n    if (determinant < 0) {\n        // Flip axis with minimum unit vector dot product.\n        if (row0x < row1y) {\n            scalingX = -scalingX;\n        }\n        else {\n            scalingY = -scalingY;\n        }\n    }\n    // Renormalize matrix to remove scale.\n    if (scalingX) {\n        row0x *= 1 / scalingX;\n        row0y *= 1 / scalingX;\n    }\n    if (scalingY) {\n        row1x *= 1 / scalingY;\n        row1y *= 1 / scalingY;\n    }\n    // Compute rotation and renormalize matrix.\n    var rotation = Math.atan2(row0y, row0x);\n    var angle = rad2deg(rotation);\n    return [mat[6], mat[7], scalingX, scalingY, angle];\n}\nvar tmp = mat4.create();\nvar perspectiveMatrix = mat4.create();\nvar tmpVec4 = vec4.create();\nvar row = [vec3.create(), vec3.create(), vec3.create()];\nvar pdum3 = vec3.create();\n/*\nInput:  matrix      ; a 4x4 matrix\nOutput: translation ; a 3 component vector\n        scale       ; a 3 component vector\n        skew        ; skew factors XY,XZ,YZ represented as a 3 component vector\n        perspective ; a 4 component vector\n        quaternion  ; a 4 component vector\nReturns false if the matrix cannot be decomposed, true if it can\n\n\nReferences:\nhttps://github.com/kamicane/matrix3d/blob/master/lib/Matrix3d.js\nhttps://github.com/ChromiumWebApps/chromium/blob/master/ui/gfx/transform_util.cc\nhttp://www.w3.org/TR/css3-transforms/#decomposing-a-3d-matrix\n*/\nfunction decomposeMat4(matrix, translation, scale, skew, perspective, quaternion) {\n    //normalize, if not possible then bail out early\n    if (!normalize(tmp, matrix))\n        return false;\n    // perspectiveMatrix is used to solve for perspective, but it also provides\n    // an easy way to test for singularity of the upper 3x3 component.\n    mat4.copy(perspectiveMatrix, tmp);\n    perspectiveMatrix[3] = 0;\n    perspectiveMatrix[7] = 0;\n    perspectiveMatrix[11] = 0;\n    perspectiveMatrix[15] = 1;\n    // If the perspectiveMatrix is not invertible, we are also unable to\n    // decompose, so we'll bail early. Constant taken from SkMatrix44::invert.\n    if (Math.abs(mat4.determinant(perspectiveMatrix)) < 1e-8)\n        return false;\n    var a03 = tmp[3], a13 = tmp[7], a23 = tmp[11], a30 = tmp[12], a31 = tmp[13], a32 = tmp[14], a33 = tmp[15];\n    // First, isolate perspective.\n    if (a03 !== 0 || a13 !== 0 || a23 !== 0) {\n        tmpVec4[0] = a03;\n        tmpVec4[1] = a13;\n        tmpVec4[2] = a23;\n        tmpVec4[3] = a33;\n        // Solve the equation by inverting perspectiveMatrix and multiplying\n        // rightHandSide by the inverse.\n        // resuing the perspectiveMatrix here since it's no longer needed\n        var ret = mat4.invert(perspectiveMatrix, perspectiveMatrix);\n        if (!ret)\n            return false;\n        mat4.transpose(perspectiveMatrix, perspectiveMatrix);\n        //multiply by transposed inverse perspective matrix, into perspective vec4\n        vec4.transformMat4(perspective, tmpVec4, perspectiveMatrix);\n    }\n    else {\n        //no perspective\n        perspective[0] = perspective[1] = perspective[2] = 0;\n        perspective[3] = 1;\n    }\n    // Next take care of translation\n    translation[0] = a30;\n    translation[1] = a31;\n    translation[2] = a32;\n    // Now get scale and shear. 'row' is a 3 element array of 3 component vectors\n    mat3from4(row, tmp);\n    // Compute X scale factor and normalize first row.\n    scale[0] = vec3.length(row[0]);\n    vec3.normalize(row[0], row[0]);\n    // Compute XY shear factor and make 2nd row orthogonal to 1st.\n    skew[0] = vec3.dot(row[0], row[1]);\n    combine(row[1], row[1], row[0], 1.0, -skew[0]);\n    // Now, compute Y scale and normalize 2nd row.\n    scale[1] = vec3.length(row[1]);\n    vec3.normalize(row[1], row[1]);\n    skew[0] /= scale[1];\n    // Compute XZ and YZ shears, orthogonalize 3rd row\n    skew[1] = vec3.dot(row[0], row[2]);\n    combine(row[2], row[2], row[0], 1.0, -skew[1]);\n    skew[2] = vec3.dot(row[1], row[2]);\n    combine(row[2], row[2], row[1], 1.0, -skew[2]);\n    // Next, get Z scale and normalize 3rd row.\n    scale[2] = vec3.length(row[2]);\n    vec3.normalize(row[2], row[2]);\n    skew[1] /= scale[2];\n    skew[2] /= scale[2];\n    // At this point, the matrix (in rows) is orthonormal.\n    // Check for a coordinate system flip.  If the determinant\n    // is -1, then negate the matrix and the scaling factors.\n    vec3.cross(pdum3, row[1], row[2]);\n    if (vec3.dot(row[0], pdum3) < 0) {\n        for (var i = 0; i < 3; i++) {\n            scale[i] *= -1;\n            row[i][0] *= -1;\n            row[i][1] *= -1;\n            row[i][2] *= -1;\n        }\n    }\n    // Now, get the rotations out\n    quaternion[0] =\n        0.5 * Math.sqrt(Math.max(1 + row[0][0] - row[1][1] - row[2][2], 0));\n    quaternion[1] =\n        0.5 * Math.sqrt(Math.max(1 - row[0][0] + row[1][1] - row[2][2], 0));\n    quaternion[2] =\n        0.5 * Math.sqrt(Math.max(1 - row[0][0] - row[1][1] + row[2][2], 0));\n    quaternion[3] =\n        0.5 * Math.sqrt(Math.max(1 + row[0][0] + row[1][1] + row[2][2], 0));\n    if (row[2][1] > row[1][2])\n        quaternion[0] = -quaternion[0];\n    if (row[0][2] > row[2][0])\n        quaternion[1] = -quaternion[1];\n    if (row[1][0] > row[0][1])\n        quaternion[2] = -quaternion[2];\n    return true;\n}\nfunction normalize(out, mat) {\n    var m44 = mat[15];\n    // Cannot normalize.\n    if (m44 === 0)\n        return false;\n    var scale = 1 / m44;\n    for (var i = 0; i < 16; i++)\n        out[i] = mat[i] * scale;\n    return true;\n}\n//gets upper-left of a 4x4 matrix into a 3x3 of vectors\nfunction mat3from4(out, mat4x4) {\n    out[0][0] = mat4x4[0];\n    out[0][1] = mat4x4[1];\n    out[0][2] = mat4x4[2];\n    out[1][0] = mat4x4[4];\n    out[1][1] = mat4x4[5];\n    out[1][2] = mat4x4[6];\n    out[2][0] = mat4x4[8];\n    out[2][1] = mat4x4[9];\n    out[2][2] = mat4x4[10];\n}\nfunction combine(out, a, b, scale1, scale2) {\n    out[0] = a[0] * scale1 + b[0] * scale2;\n    out[1] = a[1] * scale1 + b[1] * scale2;\n    out[2] = a[2] * scale1 + b[2] * scale2;\n}\n\n/**\n * Axis-Aligned Bounding Box\n * 为了便于后续 Frustum Culling，通过查找表定义 p-vertex 和 n-vertex\n * @see https://github.com/antvis/GWebGPUEngine/issues/3\n */\nvar AABB = /** @class */ (function () {\n    function AABB() {\n        this.center = [0, 0, 0];\n        this.halfExtents = [0, 0, 0];\n        this.min = [0, 0, 0];\n        this.max = [0, 0, 0];\n    }\n    AABB.isEmpty = function (aabb) {\n        return (!aabb ||\n            (aabb.halfExtents[0] === 0 &&\n                aabb.halfExtents[1] === 0 &&\n                aabb.halfExtents[2] === 0));\n    };\n    // center: vec3 = vec3.create();\n    // halfExtents: vec3 = vec3.create();\n    // min: vec3 = vec3.create();\n    // max: vec3 = vec3.create();\n    AABB.prototype.update = function (center, halfExtents) {\n        copyVec3(this.center, center);\n        copyVec3(this.halfExtents, halfExtents);\n        subVec3(this.min, this.center, this.halfExtents);\n        addVec3(this.max, this.center, this.halfExtents);\n        // vec3.copy(this.center, center);\n        // vec3.copy(this.halfExtents, halfExtents);\n        // vec3.sub(this.min, this.center, this.halfExtents);\n        // vec3.add(this.max, this.center, this.halfExtents);\n    };\n    AABB.prototype.setMinMax = function (min, max) {\n        // vec3.add(this.center, max, min);\n        // vec3.scale(this.center, this.center, 0.5);\n        // vec3.sub(this.halfExtents, max, min);\n        // vec3.scale(this.halfExtents, this.halfExtents, 0.5);\n        // vec3.copy(this.min, min);\n        // vec3.copy(this.max, max);\n        addVec3(this.center, max, min);\n        scaleVec3(this.center, this.center, 0.5);\n        subVec3(this.halfExtents, max, min);\n        scaleVec3(this.halfExtents, this.halfExtents, 0.5);\n        copyVec3(this.min, min);\n        copyVec3(this.max, max);\n    };\n    AABB.prototype.getMin = function () {\n        return this.min;\n    };\n    AABB.prototype.getMax = function () {\n        return this.max;\n    };\n    AABB.prototype.add = function (aabb) {\n        if (AABB.isEmpty(aabb)) {\n            return;\n        }\n        if (AABB.isEmpty(this)) {\n            this.setMinMax(aabb.getMin(), aabb.getMax());\n            return;\n        }\n        var tc = this.center;\n        var tcx = tc[0];\n        var tcy = tc[1];\n        var tcz = tc[2];\n        var th = this.halfExtents;\n        var thx = th[0];\n        var thy = th[1];\n        var thz = th[2];\n        var tminx = tcx - thx;\n        var tmaxx = tcx + thx;\n        var tminy = tcy - thy;\n        var tmaxy = tcy + thy;\n        var tminz = tcz - thz;\n        var tmaxz = tcz + thz;\n        var oc = aabb.center;\n        var ocx = oc[0];\n        var ocy = oc[1];\n        var ocz = oc[2];\n        var oh = aabb.halfExtents;\n        var ohx = oh[0];\n        var ohy = oh[1];\n        var ohz = oh[2];\n        var ominx = ocx - ohx;\n        var omaxx = ocx + ohx;\n        var ominy = ocy - ohy;\n        var omaxy = ocy + ohy;\n        var ominz = ocz - ohz;\n        var omaxz = ocz + ohz;\n        if (ominx < tminx) {\n            tminx = ominx;\n        }\n        if (omaxx > tmaxx) {\n            tmaxx = omaxx;\n        }\n        if (ominy < tminy) {\n            tminy = ominy;\n        }\n        if (omaxy > tmaxy) {\n            tmaxy = omaxy;\n        }\n        if (ominz < tminz) {\n            tminz = ominz;\n        }\n        if (omaxz > tmaxz) {\n            tmaxz = omaxz;\n        }\n        tc[0] = (tminx + tmaxx) * 0.5;\n        tc[1] = (tminy + tmaxy) * 0.5;\n        tc[2] = (tminz + tmaxz) * 0.5;\n        th[0] = (tmaxx - tminx) * 0.5;\n        th[1] = (tmaxy - tminy) * 0.5;\n        th[2] = (tmaxz - tminz) * 0.5;\n        this.min[0] = tminx;\n        this.min[1] = tminy;\n        this.min[2] = tminz;\n        this.max[0] = tmaxx;\n        this.max[1] = tmaxy;\n        this.max[2] = tmaxz;\n    };\n    AABB.prototype.setFromTransformedAABB = function (aabb, m) {\n        var bc = this.center;\n        var br = this.halfExtents;\n        var ac = aabb.center;\n        var ar = aabb.halfExtents;\n        var mx0 = m[0];\n        var mx1 = m[4];\n        var mx2 = m[8];\n        var my0 = m[1];\n        var my1 = m[5];\n        var my2 = m[9];\n        var mz0 = m[2];\n        var mz1 = m[6];\n        var mz2 = m[10];\n        var mx0a = Math.abs(mx0);\n        var mx1a = Math.abs(mx1);\n        var mx2a = Math.abs(mx2);\n        var my0a = Math.abs(my0);\n        var my1a = Math.abs(my1);\n        var my2a = Math.abs(my2);\n        var mz0a = Math.abs(mz0);\n        var mz1a = Math.abs(mz1);\n        var mz2a = Math.abs(mz2);\n        bc[0] = m[12] + mx0 * ac[0] + mx1 * ac[1] + mx2 * ac[2];\n        bc[1] = m[13] + my0 * ac[0] + my1 * ac[1] + my2 * ac[2];\n        bc[2] = m[14] + mz0 * ac[0] + mz1 * ac[1] + mz2 * ac[2];\n        // vec3.set(\n        //   bc,\n        //   m[12] + mx0 * ac[0] + mx1 * ac[1] + mx2 * ac[2],\n        //   m[13] + my0 * ac[0] + my1 * ac[1] + my2 * ac[2],\n        //   m[14] + mz0 * ac[0] + mz1 * ac[1] + mz2 * ac[2],\n        // );\n        br[0] = mx0a * ar[0] + mx1a * ar[1] + mx2a * ar[2];\n        br[1] = my0a * ar[0] + my1a * ar[1] + my2a * ar[2];\n        br[2] = mz0a * ar[0] + mz1a * ar[1] + mz2a * ar[2];\n        // vec3.set(\n        //   br,\n        //   mx0a * ar[0] + mx1a * ar[1] + mx2a * ar[2],\n        //   my0a * ar[0] + my1a * ar[1] + my2a * ar[2],\n        //   mz0a * ar[0] + mz1a * ar[1] + mz2a * ar[2],\n        // );\n        // this.min = vec3.sub(this.min, bc, br);\n        // this.max = vec3.add(this.max, bc, br);\n        subVec3(this.min, bc, br);\n        addVec3(this.max, bc, br);\n    };\n    AABB.prototype.intersects = function (aabb) {\n        var aMax = this.getMax();\n        var aMin = this.getMin();\n        var bMax = aabb.getMax();\n        var bMin = aabb.getMin();\n        return (aMin[0] <= bMax[0] &&\n            aMax[0] >= bMin[0] &&\n            aMin[1] <= bMax[1] &&\n            aMax[1] >= bMin[1] &&\n            aMin[2] <= bMax[2] &&\n            aMax[2] >= bMin[2]);\n    };\n    AABB.prototype.intersection = function (aabb) {\n        if (!this.intersects(aabb)) {\n            return null;\n        }\n        var intersection = new AABB();\n        // const min = vec3.max(vec3.create(), this.getMin(), aabb.getMin());\n        // const max = vec3.min(vec3.create(), this.getMax(), aabb.getMax());\n        var min = maxVec3([0, 0, 0], this.getMin(), aabb.getMin());\n        var max = minVec3([0, 0, 0], this.getMax(), aabb.getMax());\n        intersection.setMinMax(min, max);\n        return intersection;\n    };\n    // containsPoint(point: vec3) {\n    //   const min = this.getMin();\n    //   const max = this.getMax();\n    //   return !(\n    //     point[0] < min[0] ||\n    //     point[0] > max[0] ||\n    //     point[1] < min[1] ||\n    //     point[1] > max[1] ||\n    //     point[2] < min[2] ||\n    //     point[2] > max[2]\n    //   );\n    // }\n    /**\n     * get n-vertex\n     * @param plane plane of CullingVolume\n     */\n    AABB.prototype.getNegativeFarPoint = function (plane) {\n        if (plane.pnVertexFlag === 0x111) {\n            return copyVec3([0, 0, 0], this.min);\n            // return vec3.copy(vec3.create(), this.min);\n        }\n        else if (plane.pnVertexFlag === 0x110) {\n            return [this.min[0], this.min[1], this.max[2]];\n            // return vec3.fromValues(this.min[0], this.min[1], this.max[2]);\n        }\n        else if (plane.pnVertexFlag === 0x101) {\n            return [this.min[0], this.max[1], this.min[2]];\n            // return vec3.fromValues(this.min[0], this.max[1], this.min[2]);\n        }\n        else if (plane.pnVertexFlag === 0x100) {\n            return [this.min[0], this.max[1], this.max[2]];\n            // return vec3.fromValues(this.min[0], this.max[1], this.max[2]);\n        }\n        else if (plane.pnVertexFlag === 0x011) {\n            return [this.max[0], this.min[1], this.min[2]];\n            // return vec3.fromValues(this.max[0], this.min[1], this.min[2]);\n        }\n        else if (plane.pnVertexFlag === 0x010) {\n            return [this.max[0], this.min[1], this.max[2]];\n            // return vec3.fromValues(this.max[0], this.min[1], this.max[2]);\n        }\n        else if (plane.pnVertexFlag === 0x001) {\n            return [this.max[0], this.max[1], this.min[2]];\n            // return vec3.fromValues(this.max[0], this.max[1], this.min[2]);\n        }\n        else {\n            return [this.max[0], this.max[1], this.max[2]];\n            // return vec3.fromValues(this.max[0], this.max[1], this.max[2]);\n        }\n    };\n    /**\n     * get p-vertex\n     * @param plane plane of CullingVolume\n     */\n    AABB.prototype.getPositiveFarPoint = function (plane) {\n        if (plane.pnVertexFlag === 0x111) {\n            return copyVec3([0, 0, 0], this.max);\n            // return vec3.copy(vec3.create(), this.max);\n        }\n        else if (plane.pnVertexFlag === 0x110) {\n            return [this.max[0], this.max[1], this.min[2]];\n            // return vec3.fromValues(this.max[0], this.max[1], this.min[2]);\n        }\n        else if (plane.pnVertexFlag === 0x101) {\n            return [this.max[0], this.min[1], this.max[2]];\n            // return vec3.fromValues(this.max[0], this.min[1], this.max[2]);\n        }\n        else if (plane.pnVertexFlag === 0x100) {\n            return [this.max[0], this.min[1], this.min[2]];\n            // return vec3.fromValues(this.max[0], this.min[1], this.min[2]);\n        }\n        else if (plane.pnVertexFlag === 0x011) {\n            return [this.min[0], this.max[1], this.max[2]];\n            // return vec3.fromValues(this.min[0], this.max[1], this.max[2]);\n        }\n        else if (plane.pnVertexFlag === 0x010) {\n            return [this.min[0], this.max[1], this.min[2]];\n            // return vec3.fromValues(this.min[0], this.max[1], this.min[2]);\n        }\n        else if (plane.pnVertexFlag === 0x001) {\n            return [this.min[0], this.min[1], this.max[2]];\n            // return vec3.fromValues(this.min[0], this.min[1], this.max[2]);\n        }\n        else {\n            return [this.min[0], this.min[1], this.min[2]];\n            // return vec3.fromValues(this.min[0], this.min[1], this.min[2]);\n        }\n    };\n    return AABB;\n}());\n\nvar Plane = /** @class */ (function () {\n    function Plane(distance, normal) {\n        this.distance = distance || 0;\n        this.normal = normal || vec3.fromValues(0, 1, 0);\n        this.updatePNVertexFlag();\n    }\n    Plane.prototype.updatePNVertexFlag = function () {\n        this.pnVertexFlag =\n            (Number(this.normal[0] >= 0) << 8) +\n                (Number(this.normal[1] >= 0) << 4) +\n                Number(this.normal[2] >= 0);\n    };\n    Plane.prototype.distanceToPoint = function (point) {\n        return vec3.dot(point, this.normal) - this.distance;\n    };\n    Plane.prototype.normalize = function () {\n        var invLen = 1 / vec3.len(this.normal);\n        vec3.scale(this.normal, this.normal, invLen);\n        this.distance *= invLen;\n    };\n    Plane.prototype.intersectsLine = function (start, end, point) {\n        var d0 = this.distanceToPoint(start);\n        var d1 = this.distanceToPoint(end);\n        var t = d0 / (d0 - d1);\n        var intersects = t >= 0 && t <= 1;\n        if (intersects && point) {\n            vec3.lerp(point, start, end, t);\n        }\n        return intersects;\n    };\n    return Plane;\n}());\n\nvar Mask;\n(function (Mask) {\n    Mask[Mask[\"OUTSIDE\"] = 4294967295] = \"OUTSIDE\";\n    Mask[Mask[\"INSIDE\"] = 0] = \"INSIDE\";\n    Mask[Mask[\"INDETERMINATE\"] = 2147483647] = \"INDETERMINATE\";\n})(Mask || (Mask = {}));\nvar Frustum = /** @class */ (function () {\n    function Frustum(planes) {\n        this.planes = [];\n        if (planes) {\n            this.planes = planes;\n        }\n        else {\n            for (var i = 0; i < 6; i++) {\n                this.planes.push(new Plane());\n            }\n        }\n    }\n    /**\n     * extract 6 planes from projectionMatrix\n     * @see http://www8.cs.umu.se/kurser/5DV051/HT12/lab/plane_extraction.pdf\n     */\n    Frustum.prototype.extractFromVPMatrix = function (projectionMatrix) {\n        // @ts-ignore\n        var _a = __read(projectionMatrix, 16), m0 = _a[0], m1 = _a[1], m2 = _a[2], m3 = _a[3], m4 = _a[4], m5 = _a[5], m6 = _a[6], m7 = _a[7], m8 = _a[8], m9 = _a[9], m10 = _a[10], m11 = _a[11], m12 = _a[12], m13 = _a[13], m14 = _a[14], m15 = _a[15];\n        // right\n        vec3.set(this.planes[0].normal, m3 - m0, m7 - m4, m11 - m8);\n        this.planes[0].distance = m15 - m12;\n        // left\n        vec3.set(this.planes[1].normal, m3 + m0, m7 + m4, m11 + m8);\n        this.planes[1].distance = m15 + m12;\n        // bottom\n        vec3.set(this.planes[2].normal, m3 + m1, m7 + m5, m11 + m9);\n        this.planes[2].distance = m15 + m13;\n        // top\n        vec3.set(this.planes[3].normal, m3 - m1, m7 - m5, m11 - m9);\n        this.planes[3].distance = m15 - m13;\n        // far\n        vec3.set(this.planes[4].normal, m3 - m2, m7 - m6, m11 - m10);\n        this.planes[4].distance = m15 - m14;\n        // near\n        vec3.set(this.planes[5].normal, m3 + m2, m7 + m6, m11 + m10);\n        this.planes[5].distance = m15 + m14;\n        this.planes.forEach(function (plane) {\n            plane.normalize();\n            plane.updatePNVertexFlag();\n        });\n    };\n    return Frustum;\n}());\n\nvar Point = /** @class */ (function () {\n    function Point(x, y) {\n        if (x === void 0) { x = 0; }\n        if (y === void 0) { y = 0; }\n        this.x = 0;\n        this.y = 0;\n        this.x = x;\n        this.y = y;\n    }\n    Point.prototype.clone = function () {\n        return new Point(this.x, this.y);\n    };\n    Point.prototype.copyFrom = function (p) {\n        this.x = p.x;\n        this.y = p.y;\n    };\n    return Point;\n}());\n\nvar Rectangle = /** @class */ (function () {\n    function Rectangle(x, y, width, height) {\n        this.x = x;\n        this.y = y;\n        this.width = width;\n        this.height = height;\n        this.left = x;\n        this.right = x + width;\n        this.top = y;\n        this.bottom = y + height;\n    }\n    Rectangle.prototype.toJSON = function () { };\n    return Rectangle;\n}());\n\nvar ERROR_MSG_METHOD_NOT_IMPLEMENTED = 'Method not implemented.';\nvar ERROR_MSG_USE_DOCUMENT_ELEMENT = 'Use document.documentElement instead.';\nvar ERROR_MSG_APPEND_DESTROYED_ELEMENT = 'Cannot append a destroyed element.';\n\n/**\n * Different type of cameras, eg. simple camera used in 2D scene or\n * advanced camera which can do actions & switch between landmarks.\n */\nvar CameraType;\n(function (CameraType) {\n    /**\n     * Performs all the rotational operations with the focal point instead of the camera position.\n     * This type of camera is useful in applications(like CAD) where 3D objects are being designed or explored.\n     * Camera cannot orbits over the north & south poles.\n     * @see http://voxelent.com/tutorial-cameras/\n     *\n     * In Three.js it's used in OrbitControls.\n     * @see https://threejs.org/docs/#examples/zh/controls/OrbitControls\n     */\n    CameraType[CameraType[\"ORBITING\"] = 0] = \"ORBITING\";\n    /**\n     * It's similar to the ORBITING camera, but it allows the camera to orbit over the north or south poles.\n     *\n     * In Three.js it's used in OrbitControls.\n     * @see https://threejs.org/docs/#examples/en/controls/TrackballControls\n     */\n    CameraType[CameraType[\"EXPLORING\"] = 1] = \"EXPLORING\";\n    /**\n     * Performs all the rotational operations with the camera position.\n     * It's useful in first person shooting games.\n     * Camera cannot orbits over the north & south poles.\n     *\n     * In Three.js it's used in FirstPersonControls.\n     * @see https://threejs.org/docs/#examples/en/controls/FirstPersonControls\n     */\n    CameraType[CameraType[\"TRACKING\"] = 2] = \"TRACKING\";\n})(CameraType || (CameraType = {}));\n/**\n * CameraType must be TRACKING\n */\nvar CameraTrackingMode;\n(function (CameraTrackingMode) {\n    CameraTrackingMode[CameraTrackingMode[\"DEFAULT\"] = 0] = \"DEFAULT\";\n    CameraTrackingMode[CameraTrackingMode[\"ROTATIONAL\"] = 1] = \"ROTATIONAL\";\n    CameraTrackingMode[CameraTrackingMode[\"TRANSLATIONAL\"] = 2] = \"TRANSLATIONAL\";\n    CameraTrackingMode[CameraTrackingMode[\"CINEMATIC\"] = 3] = \"CINEMATIC\";\n})(CameraTrackingMode || (CameraTrackingMode = {}));\nvar CameraProjectionMode;\n(function (CameraProjectionMode) {\n    CameraProjectionMode[CameraProjectionMode[\"ORTHOGRAPHIC\"] = 0] = \"ORTHOGRAPHIC\";\n    CameraProjectionMode[CameraProjectionMode[\"PERSPECTIVE\"] = 1] = \"PERSPECTIVE\";\n})(CameraProjectionMode || (CameraProjectionMode = {}));\nvar CameraEvent = {\n    UPDATED: 'updated',\n};\n\nvar MIN_DISTANCE = 0.0002;\n/**\n * 参考「WebGL Insights - 23.Designing Cameras for WebGL Applications」，基于 Responsible Camera 思路设计\n * @see https://github.com/d13g0/nucleo.js/blob/master/source/camera/Camera.js\n *\n * 保存相机参数，定义相机动作：\n * 1. dolly 沿 n 轴移动\n * 2. pan 沿 u v 轴移动\n * 3. rotate 以方位角旋转\n * 4. 移动到 Landmark，具有平滑的动画效果，其间禁止其他用户交互\n */\nvar Camera = /** @class */ (function () {\n    function Camera() {\n        /**\n         * Clip space near Z, default to range `[-1, 1]`\n         */\n        this.clipSpaceNearZ = ClipSpaceNearZ.NEGATIVE_ONE;\n        this.eventEmitter = new EventEmitter();\n        /**\n         * Matrix of camera\n         */\n        this.matrix = mat4.create();\n        /**\n         * u axis +X is right\n         * @see http://learnwebgl.brown37.net/07_cameras/camera_introduction.html#a-camera-definition\n         */\n        this.right = vec3.fromValues(1, 0, 0);\n        /**\n         * v axis +Y is up\n         */\n        this.up = vec3.fromValues(0, 1, 0);\n        /**\n         * n axis +Z is inside\n         */\n        this.forward = vec3.fromValues(0, 0, 1);\n        /**\n         * Position of camera.\n         */\n        this.position = vec3.fromValues(0, 0, 1);\n        /**\n         * Position of focal point.\n         */\n        this.focalPoint = vec3.fromValues(0, 0, 0);\n        /**\n         * vector from focalPoint to position\n         */\n        this.distanceVector = vec3.fromValues(0, 0, -1);\n        /**\n         * length(focalPoint - position)\n         */\n        this.distance = 1;\n        /**\n         * @see https://en.wikipedia.org/wiki/Azimuth\n         */\n        this.azimuth = 0;\n        this.elevation = 0;\n        this.roll = 0;\n        this.relAzimuth = 0;\n        this.relElevation = 0;\n        this.relRoll = 0;\n        /**\n         * 沿 n 轴移动时，保证移动速度从快到慢\n         */\n        this.dollyingStep = 0;\n        this.maxDistance = Infinity;\n        this.minDistance = -Infinity;\n        /**\n         * zoom factor of the camera, default is 1\n         * eg. https://threejs.org/docs/#api/en/cameras/OrthographicCamera.zoom\n         */\n        this.zoom = 1;\n        /**\n         * invert the horizontal coordinate system HCS\n         */\n        this.rotateWorld = false;\n        /**\n         * 投影矩阵参数\n         */\n        /**\n         * field of view [0-360]\n         * @see http://en.wikipedia.org/wiki/Angle_of_view\n         */\n        this.fov = 30;\n        this.near = 0.1;\n        this.far = 1000;\n        this.aspect = 1;\n        this.projectionMatrix = mat4.create();\n        this.projectionMatrixInverse = mat4.create();\n        this.jitteredProjectionMatrix = undefined;\n        this.enableUpdate = true;\n        // protected following = undefined;\n        this.type = CameraType.EXPLORING;\n        this.trackingMode = CameraTrackingMode.DEFAULT;\n        this.projectionMode = CameraProjectionMode.PERSPECTIVE;\n        /**\n         * for culling use\n         */\n        this.frustum = new Frustum();\n        /**\n         * ortho matrix for Canvas2D & SVG\n         */\n        this.orthoMatrix = mat4.create();\n    }\n    // constructor(type = CameraType.EXPLORING, trackingMode = CameraTrackingMode.DEFAULT) {\n    //   this.setType(type, trackingMode);\n    // }\n    Camera.prototype.isOrtho = function () {\n        return this.projectionMode === CameraProjectionMode.ORTHOGRAPHIC;\n    };\n    Camera.prototype.getProjectionMode = function () {\n        return this.projectionMode;\n    };\n    Camera.prototype.getPerspective = function () {\n        // account for TAA\n        return this.jitteredProjectionMatrix || this.projectionMatrix;\n    };\n    Camera.prototype.getPerspectiveInverse = function () {\n        return this.projectionMatrixInverse;\n    };\n    Camera.prototype.getFrustum = function () {\n        return this.frustum;\n    };\n    Camera.prototype.getPosition = function () {\n        return this.position;\n    };\n    Camera.prototype.getFocalPoint = function () {\n        return this.focalPoint;\n    };\n    Camera.prototype.getDollyingStep = function () {\n        return this.dollyingStep;\n    };\n    Camera.prototype.getNear = function () {\n        return this.near;\n    };\n    Camera.prototype.getFar = function () {\n        return this.far;\n    };\n    Camera.prototype.getZoom = function () {\n        return this.zoom;\n    };\n    Camera.prototype.getOrthoMatrix = function () {\n        return this.orthoMatrix;\n    };\n    Camera.prototype.getView = function () {\n        return this.view;\n    };\n    Camera.prototype.setEnableUpdate = function (enabled) {\n        this.enableUpdate = enabled;\n    };\n    Camera.prototype.setType = function (type, trackingMode) {\n        this.type = type;\n        if (this.type === CameraType.EXPLORING) {\n            this.setWorldRotation(true);\n        }\n        else {\n            this.setWorldRotation(false);\n        }\n        this._getAngles();\n        if (this.type === CameraType.TRACKING && trackingMode !== undefined) {\n            this.setTrackingMode(trackingMode);\n        }\n        return this;\n    };\n    Camera.prototype.setProjectionMode = function (projectionMode) {\n        this.projectionMode = projectionMode;\n        return this;\n    };\n    Camera.prototype.setTrackingMode = function (trackingMode) {\n        if (this.type !== CameraType.TRACKING) {\n            throw new Error('Impossible to set a tracking mode if the camera is not of tracking type');\n        }\n        this.trackingMode = trackingMode;\n        return this;\n    };\n    /**\n     * If flag is true, it reverses the azimuth and elevation angles.\n     * Subsequent calls to rotate, setAzimuth, setElevation,\n     * changeAzimuth or changeElevation will cause the inverted effect.\n     * setRoll or changeRoll is not affected by this method.\n     *\n     * This inversion is useful when one wants to simulate that the world\n     * is moving, instead of the camera.\n     *\n     * By default the camera angles are not reversed.\n     * @param {Boolean} flag the boolean flag to reverse the angles.\n     */\n    Camera.prototype.setWorldRotation = function (flag) {\n        this.rotateWorld = flag;\n        this._getAngles();\n        return this;\n    };\n    /**\n     * 计算 MV 矩阵，为相机矩阵的逆矩阵\n     */\n    Camera.prototype.getViewTransform = function () {\n        return mat4.invert(mat4.create(), this.matrix);\n    };\n    Camera.prototype.getWorldTransform = function () {\n        return this.matrix;\n    };\n    Camera.prototype.jitterProjectionMatrix = function (x, y) {\n        var translation = mat4.fromTranslation(mat4.create(), [x, y, 0]);\n        this.jitteredProjectionMatrix = mat4.multiply(mat4.create(), translation, this.projectionMatrix);\n    };\n    Camera.prototype.clearJitterProjectionMatrix = function () {\n        this.jitteredProjectionMatrix = undefined;\n    };\n    /**\n     * 设置相机矩阵\n     */\n    Camera.prototype.setMatrix = function (matrix) {\n        this.matrix = matrix;\n        this._update();\n        return this;\n    };\n    /**\n     * Set projection matrix manually.\n     */\n    Camera.prototype.setProjectionMatrix = function (matrix) {\n        this.projectionMatrix = matrix;\n    };\n    Camera.prototype.setFov = function (fov) {\n        this.setPerspective(this.near, this.far, fov, this.aspect);\n        return this;\n    };\n    Camera.prototype.setAspect = function (aspect) {\n        this.setPerspective(this.near, this.far, this.fov, aspect);\n        return this;\n    };\n    Camera.prototype.setNear = function (near) {\n        if (this.projectionMode === CameraProjectionMode.PERSPECTIVE) {\n            this.setPerspective(near, this.far, this.fov, this.aspect);\n        }\n        else {\n            this.setOrthographic(this.left, this.rright, this.top, this.bottom, near, this.far);\n        }\n        return this;\n    };\n    Camera.prototype.setFar = function (far) {\n        if (this.projectionMode === CameraProjectionMode.PERSPECTIVE) {\n            this.setPerspective(this.near, far, this.fov, this.aspect);\n        }\n        else {\n            this.setOrthographic(this.left, this.rright, this.top, this.bottom, this.near, far);\n        }\n        return this;\n    };\n    /**\n     * Sets an offset in a larger frustum, used in PixelPicking\n     */\n    Camera.prototype.setViewOffset = function (fullWidth, fullHeight, x, y, width, height) {\n        this.aspect = fullWidth / fullHeight;\n        if (this.view === undefined) {\n            this.view = {\n                enabled: true,\n                fullWidth: 1,\n                fullHeight: 1,\n                offsetX: 0,\n                offsetY: 0,\n                width: 1,\n                height: 1,\n            };\n        }\n        this.view.enabled = true;\n        this.view.fullWidth = fullWidth;\n        this.view.fullHeight = fullHeight;\n        this.view.offsetX = x;\n        this.view.offsetY = y;\n        this.view.width = width;\n        this.view.height = height;\n        if (this.projectionMode === CameraProjectionMode.PERSPECTIVE) {\n            this.setPerspective(this.near, this.far, this.fov, this.aspect);\n        }\n        else {\n            this.setOrthographic(this.left, this.rright, this.top, this.bottom, this.near, this.far);\n        }\n        return this;\n    };\n    Camera.prototype.clearViewOffset = function () {\n        if (this.view !== undefined) {\n            this.view.enabled = false;\n        }\n        if (this.projectionMode === CameraProjectionMode.PERSPECTIVE) {\n            this.setPerspective(this.near, this.far, this.fov, this.aspect);\n        }\n        else {\n            this.setOrthographic(this.left, this.rright, this.top, this.bottom, this.near, this.far);\n        }\n        return this;\n    };\n    Camera.prototype.setZoom = function (zoom) {\n        this.zoom = zoom;\n        if (this.projectionMode === CameraProjectionMode.ORTHOGRAPHIC) {\n            this.setOrthographic(this.left, this.rright, this.top, this.bottom, this.near, this.far);\n        }\n        else if (this.projectionMode === CameraProjectionMode.PERSPECTIVE) {\n            this.setPerspective(this.near, this.far, this.fov, this.aspect);\n        }\n        return this;\n    };\n    /**\n     * Zoom by specified point in viewport coordinates.\n     */\n    Camera.prototype.setZoomByViewportPoint = function (zoom, viewportPoint) {\n        var _a = this.canvas.viewport2Canvas({\n            x: viewportPoint[0],\n            y: viewportPoint[1],\n        }), ox = _a.x, oy = _a.y;\n        var roll = this.roll;\n        this.rotate(0, 0, -roll);\n        this.setPosition(ox, oy);\n        this.setFocalPoint(ox, oy);\n        this.setZoom(zoom);\n        this.rotate(0, 0, roll);\n        var _b = this.canvas.viewport2Canvas({\n            x: viewportPoint[0],\n            y: viewportPoint[1],\n        }), cx = _b.x, cy = _b.y;\n        // project to rotated axis\n        var dvec = vec3.fromValues(cx - ox, cy - oy, 0);\n        var dx = vec3.dot(dvec, this.right) / vec3.length(this.right);\n        var dy = vec3.dot(dvec, this.up) / vec3.length(this.up);\n        this.pan(-dx, -dy);\n        return this;\n    };\n    Camera.prototype.setPerspective = function (near, far, fov, aspect) {\n        var _a;\n        this.projectionMode = CameraProjectionMode.PERSPECTIVE;\n        this.fov = fov;\n        this.near = near;\n        this.far = far;\n        this.aspect = aspect;\n        var top = (this.near * Math.tan(deg2rad(0.5 * this.fov))) / this.zoom;\n        var height = 2 * top;\n        var width = this.aspect * height;\n        var left = -0.5 * width;\n        if ((_a = this.view) === null || _a === void 0 ? void 0 : _a.enabled) {\n            var fullWidth = this.view.fullWidth;\n            var fullHeight = this.view.fullHeight;\n            left += (this.view.offsetX * width) / fullWidth;\n            top -= (this.view.offsetY * height) / fullHeight;\n            width *= this.view.width / fullWidth;\n            height *= this.view.height / fullHeight;\n        }\n        makePerspective(this.projectionMatrix, left, left + width, top, top - height, near, this.far, this.clipSpaceNearZ === ClipSpaceNearZ.ZERO);\n        // flipY since the origin of OpenGL/WebGL is bottom-left compared with top-left in Canvas2D\n        mat4.scale(this.projectionMatrix, this.projectionMatrix, vec3.fromValues(1, -1, 1));\n        mat4.invert(this.projectionMatrixInverse, this.projectionMatrix);\n        this.triggerUpdate();\n        return this;\n    };\n    Camera.prototype.setOrthographic = function (l, r, t, b, near, far) {\n        var _a;\n        this.projectionMode = CameraProjectionMode.ORTHOGRAPHIC;\n        this.rright = r;\n        this.left = l;\n        this.top = t;\n        this.bottom = b;\n        this.near = near;\n        this.far = far;\n        var dx = (this.rright - this.left) / (2 * this.zoom);\n        var dy = (this.top - this.bottom) / (2 * this.zoom);\n        var cx = (this.rright + this.left) / 2;\n        var cy = (this.top + this.bottom) / 2;\n        var left = cx - dx;\n        var right = cx + dx;\n        var top = cy + dy;\n        var bottom = cy - dy;\n        if ((_a = this.view) === null || _a === void 0 ? void 0 : _a.enabled) {\n            var scaleW = (this.rright - this.left) / this.view.fullWidth / this.zoom;\n            var scaleH = (this.top - this.bottom) / this.view.fullHeight / this.zoom;\n            left += scaleW * this.view.offsetX;\n            right = left + scaleW * this.view.width;\n            top -= scaleH * this.view.offsetY;\n            bottom = top - scaleH * this.view.height;\n        }\n        if (this.clipSpaceNearZ === ClipSpaceNearZ.NEGATIVE_ONE) {\n            mat4.ortho(this.projectionMatrix, left, right, bottom, top, near, far);\n        }\n        else {\n            mat4.orthoZO(this.projectionMatrix, left, right, bottom, top, near, far);\n        }\n        // flipY since the origin of OpenGL/WebGL is bottom-left compared with top-left in Canvas2D\n        mat4.scale(this.projectionMatrix, this.projectionMatrix, vec3.fromValues(1, -1, 1));\n        mat4.invert(this.projectionMatrixInverse, this.projectionMatrix);\n        this._getOrthoMatrix();\n        this.triggerUpdate();\n        return this;\n    };\n    /**\n     * Move the camera in world coordinates.\n     * It will keep looking at the current focal point.\n     *\n     * support scalars or vectors.\n     * @example\n     * setPosition(1, 2, 3);\n     * setPosition([1, 2, 3]);\n     */\n    Camera.prototype.setPosition = function (x, y, z) {\n        if (y === void 0) { y = this.position[1]; }\n        if (z === void 0) { z = this.position[2]; }\n        var position = createVec3(x, y, z);\n        this._setPosition(position);\n        this.setFocalPoint(this.focalPoint);\n        this.triggerUpdate();\n        return this;\n    };\n    /**\n     * Sets the focal point of this camera in world coordinates.\n     *\n     * support scalars or vectors.\n     * @example\n     * setFocalPoint(1, 2, 3);\n     * setFocalPoint([1, 2, 3]);\n     */\n    Camera.prototype.setFocalPoint = function (x, y, z) {\n        if (y === void 0) { y = this.focalPoint[1]; }\n        if (z === void 0) { z = this.focalPoint[2]; }\n        var up = vec3.fromValues(0, 1, 0);\n        this.focalPoint = createVec3(x, y, z);\n        if (this.trackingMode === CameraTrackingMode.CINEMATIC) {\n            var d = vec3.subtract(vec3.create(), this.focalPoint, this.position);\n            x = d[0];\n            y = d[1];\n            z = d[2];\n            var r = vec3.length(d);\n            var el = rad2deg(Math.asin(y / r));\n            var az = 90 + rad2deg(Math.atan2(z, x));\n            var m = mat4.create();\n            mat4.rotateY(m, m, deg2rad(az));\n            mat4.rotateX(m, m, deg2rad(el));\n            up = vec3.transformMat4(vec3.create(), [0, 1, 0], m);\n        }\n        mat4.invert(this.matrix, mat4.lookAt(mat4.create(), this.position, this.focalPoint, up));\n        this._getAxes();\n        this._getDistance();\n        this._getAngles();\n        this.triggerUpdate();\n        return this;\n    };\n    Camera.prototype.getDistance = function () {\n        return this.distance;\n    };\n    Camera.prototype.getDistanceVector = function () {\n        return this.distanceVector;\n    };\n    /**\n     * Moves the camera towards/from the focal point.\n     */\n    Camera.prototype.setDistance = function (d) {\n        if (this.distance === d || d < 0) {\n            return this;\n        }\n        this.distance = d;\n        if (this.distance < MIN_DISTANCE) {\n            this.distance = MIN_DISTANCE;\n        }\n        this.dollyingStep = this.distance / 100;\n        var pos = vec3.create();\n        d = this.distance;\n        var n = this.forward;\n        var f = this.focalPoint;\n        pos[0] = d * n[0] + f[0];\n        pos[1] = d * n[1] + f[1];\n        pos[2] = d * n[2] + f[2];\n        this._setPosition(pos);\n        this.triggerUpdate();\n        return this;\n    };\n    Camera.prototype.setMaxDistance = function (d) {\n        this.maxDistance = d;\n        return this;\n    };\n    Camera.prototype.setMinDistance = function (d) {\n        this.minDistance = d;\n        return this;\n    };\n    /**\n     * 设置相机方位角，不同相机模式下需要重新计算相机位置或者是视点位置\n     * the azimuth in degrees\n     */\n    Camera.prototype.setAzimuth = function (az) {\n        this.azimuth = getAngle(az);\n        this.computeMatrix();\n        this._getAxes();\n        if (this.type === CameraType.ORBITING ||\n            this.type === CameraType.EXPLORING) {\n            this._getPosition();\n        }\n        else if (this.type === CameraType.TRACKING) {\n            this._getFocalPoint();\n        }\n        this.triggerUpdate();\n        return this;\n    };\n    Camera.prototype.getAzimuth = function () {\n        return this.azimuth;\n    };\n    /**\n     * 设置相机方位角，不同相机模式下需要重新计算相机位置或者是视点位置\n     */\n    Camera.prototype.setElevation = function (el) {\n        this.elevation = getAngle(el);\n        this.computeMatrix();\n        this._getAxes();\n        if (this.type === CameraType.ORBITING ||\n            this.type === CameraType.EXPLORING) {\n            this._getPosition();\n        }\n        else if (this.type === CameraType.TRACKING) {\n            this._getFocalPoint();\n        }\n        this.triggerUpdate();\n        return this;\n    };\n    Camera.prototype.getElevation = function () {\n        return this.elevation;\n    };\n    /**\n     * 设置相机方位角，不同相机模式下需要重新计算相机位置或者是视点位置\n     */\n    Camera.prototype.setRoll = function (angle) {\n        this.roll = getAngle(angle);\n        this.computeMatrix();\n        this._getAxes();\n        if (this.type === CameraType.ORBITING ||\n            this.type === CameraType.EXPLORING) {\n            this._getPosition();\n        }\n        else if (this.type === CameraType.TRACKING) {\n            this._getFocalPoint();\n        }\n        this.triggerUpdate();\n        return this;\n    };\n    Camera.prototype.getRoll = function () {\n        return this.roll;\n    };\n    /**\n     * 根据相机矩阵重新计算各种相机参数\n     */\n    Camera.prototype._update = function () {\n        this._getAxes();\n        this._getPosition();\n        this._getDistance();\n        this._getAngles();\n        this._getOrthoMatrix();\n        this.triggerUpdate();\n    };\n    /**\n     * 计算相机矩阵\n     */\n    Camera.prototype.computeMatrix = function () {\n        // 使用四元数描述 3D 旋转\n        // @see https://xiaoiver.github.io/coding/2018/12/28/Camera-%E8%AE%BE%E8%AE%A1-%E4%B8%80.html\n        var rotZ = quat$1.setAxisAngle(quat$1.create(), [0, 0, 1], deg2rad(this.roll));\n        mat4.identity(this.matrix);\n        // only consider HCS for EXPLORING and ORBITING cameras\n        var rotX = quat$1.setAxisAngle(quat$1.create(), [1, 0, 0], deg2rad(((this.rotateWorld && this.type !== CameraType.TRACKING) ||\n            this.type === CameraType.TRACKING\n            ? 1\n            : -1) * this.elevation));\n        var rotY = quat$1.setAxisAngle(quat$1.create(), [0, 1, 0], deg2rad(((this.rotateWorld && this.type !== CameraType.TRACKING) ||\n            this.type === CameraType.TRACKING\n            ? 1\n            : -1) * this.azimuth));\n        var rotQ = quat$1.multiply(quat$1.create(), rotY, rotX);\n        rotQ = quat$1.multiply(quat$1.create(), rotQ, rotZ);\n        var rotMatrix = mat4.fromQuat(mat4.create(), rotQ);\n        if (this.type === CameraType.ORBITING ||\n            this.type === CameraType.EXPLORING) {\n            mat4.translate(this.matrix, this.matrix, this.focalPoint);\n            mat4.multiply(this.matrix, this.matrix, rotMatrix);\n            mat4.translate(this.matrix, this.matrix, [0, 0, this.distance]);\n        }\n        else if (this.type === CameraType.TRACKING) {\n            mat4.translate(this.matrix, this.matrix, this.position);\n            mat4.multiply(this.matrix, this.matrix, rotMatrix);\n        }\n    };\n    /**\n     * Sets the camera position in the camera matrix\n     */\n    Camera.prototype._setPosition = function (x, y, z) {\n        this.position = createVec3(x, y, z);\n        var m = this.matrix;\n        m[12] = this.position[0];\n        m[13] = this.position[1];\n        m[14] = this.position[2];\n        m[15] = 1;\n        this._getOrthoMatrix();\n    };\n    /**\n     * Recalculates axes based on the current matrix\n     */\n    Camera.prototype._getAxes = function () {\n        vec3.copy(this.right, createVec3(vec4.transformMat4(vec4.create(), [1, 0, 0, 0], this.matrix)));\n        vec3.copy(this.up, createVec3(vec4.transformMat4(vec4.create(), [0, 1, 0, 0], this.matrix)));\n        vec3.copy(this.forward, createVec3(vec4.transformMat4(vec4.create(), [0, 0, 1, 0], this.matrix)));\n        vec3.normalize(this.right, this.right);\n        vec3.normalize(this.up, this.up);\n        vec3.normalize(this.forward, this.forward);\n    };\n    /**\n     * Recalculates euler angles based on the current state\n     */\n    Camera.prototype._getAngles = function () {\n        // Recalculates angles\n        var x = this.distanceVector[0];\n        var y = this.distanceVector[1];\n        var z = this.distanceVector[2];\n        var r = vec3.length(this.distanceVector);\n        // FAST FAIL: If there is no distance we cannot compute angles\n        if (r === 0) {\n            this.elevation = 0;\n            this.azimuth = 0;\n            return;\n        }\n        if (this.type === CameraType.TRACKING) {\n            this.elevation = rad2deg(Math.asin(y / r));\n            this.azimuth = rad2deg(Math.atan2(-x, -z));\n        }\n        else {\n            if (this.rotateWorld) {\n                this.elevation = rad2deg(Math.asin(y / r));\n                this.azimuth = rad2deg(Math.atan2(-x, -z));\n            }\n            else {\n                this.elevation = -rad2deg(Math.asin(y / r));\n                this.azimuth = -rad2deg(Math.atan2(-x, -z));\n            }\n        }\n    };\n    /**\n     * 重新计算相机位置，只有 ORBITING 模式相机位置才会发生变化\n     */\n    Camera.prototype._getPosition = function () {\n        vec3.copy(this.position, createVec3(vec4.transformMat4(vec4.create(), [0, 0, 0, 1], this.matrix)));\n        // 相机位置变化，需要重新计算视距\n        this._getDistance();\n    };\n    /**\n     * 重新计算视点，只有 TRACKING 模式视点才会发生变化\n     */\n    Camera.prototype._getFocalPoint = function () {\n        vec3.transformMat3(this.distanceVector, [0, 0, -this.distance], mat3.fromMat4(mat3.create(), this.matrix));\n        vec3.add(this.focalPoint, this.position, this.distanceVector);\n        // 视点变化，需要重新计算视距\n        this._getDistance();\n    };\n    /**\n     * 重新计算视距\n     */\n    Camera.prototype._getDistance = function () {\n        this.distanceVector = vec3.subtract(vec3.create(), this.focalPoint, this.position);\n        this.distance = vec3.length(this.distanceVector);\n        this.dollyingStep = this.distance / 100;\n    };\n    Camera.prototype._getOrthoMatrix = function () {\n        if (this.projectionMode !== CameraProjectionMode.ORTHOGRAPHIC) {\n            return;\n        }\n        var position = this.position;\n        var rotZ = quat$1.setAxisAngle(quat$1.create(), [0, 0, 1], (-this.roll * Math.PI) / 180);\n        mat4.fromRotationTranslationScaleOrigin(this.orthoMatrix, rotZ, vec3.fromValues((this.rright - this.left) / 2 - position[0], (this.top - this.bottom) / 2 - position[1], 0), vec3.fromValues(this.zoom, this.zoom, 1), position);\n    };\n    Camera.prototype.triggerUpdate = function () {\n        if (this.enableUpdate) {\n            // update frustum\n            var viewMatrix = this.getViewTransform();\n            var vpMatrix = mat4.multiply(mat4.create(), this.getPerspective(), viewMatrix);\n            this.getFrustum().extractFromVPMatrix(vpMatrix);\n            this.eventEmitter.emit(CameraEvent.UPDATED);\n        }\n    };\n    Camera.prototype.rotate = function (azimuth, elevation, roll) {\n        throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED);\n    };\n    Camera.prototype.pan = function (tx, ty) {\n        throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED);\n    };\n    Camera.prototype.dolly = function (value) {\n        throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED);\n    };\n    Camera.prototype.createLandmark = function (name, params) {\n        throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED);\n    };\n    Camera.prototype.gotoLandmark = function (name, options) {\n        throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED);\n    };\n    Camera.prototype.cancelLandmarkAnimation = function () {\n        throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED);\n    };\n    return Camera;\n}());\n\nfunction memoize(func, resolver) {\n    if (typeof func !== 'function' ||\n        (resolver != null && typeof resolver !== 'function')) {\n        throw new TypeError('Expected a function');\n    }\n    var memoized = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var key = resolver ? resolver.apply(this, args) : args[0];\n        var cache = memoized.cache;\n        if (cache.has(key)) {\n            return cache.get(key);\n        }\n        var result = func.apply(this, args);\n        memoized.cache = cache.set(key, result) || cache;\n        return result;\n    };\n    memoized.cache = new (memoize.Cache || Map)();\n    return memoized;\n}\nmemoize.Cache = Map;\n\n// These units are iterated through, so be careful when adding or changing the\n// order.\nvar UnitType;\n(function (UnitType) {\n    UnitType[UnitType[\"kUnknown\"] = 0] = \"kUnknown\";\n    UnitType[UnitType[\"kNumber\"] = 1] = \"kNumber\";\n    UnitType[UnitType[\"kPercentage\"] = 2] = \"kPercentage\";\n    // Length units\n    UnitType[UnitType[\"kEms\"] = 3] = \"kEms\";\n    // kExs,\n    UnitType[UnitType[\"kPixels\"] = 4] = \"kPixels\";\n    // kCentimeters,\n    // kMillimeters,\n    // kInches,\n    // kPoints,\n    // kPicas,\n    // kQuarterMillimeters,\n    // https://drafts.csswg.org/css-values-4/#viewport-relative-lengths\n    //\n    // See also IsViewportPercentageLength.\n    // kViewportWidth,\n    // kViewportHeight,\n    // kViewportInlineSize,\n    // kViewportBlockSize,\n    // kViewportMin,\n    // kViewportMax,\n    // kSmallViewportWidth,\n    // kSmallViewportHeight,\n    // kSmallViewportInlineSize,\n    // kSmallViewportBlockSize,\n    // kSmallViewportMin,\n    // kSmallViewportMax,\n    // kLargeViewportWidth,\n    // kLargeViewportHeight,\n    // kLargeViewportInlineSize,\n    // kLargeViewportBlockSize,\n    // kLargeViewportMin,\n    // kLargeViewportMax,\n    // kDynamicViewportWidth,\n    // kDynamicViewportHeight,\n    // kDynamicViewportInlineSize,\n    // kDynamicViewportBlockSize,\n    // kDynamicViewportMin,\n    // kDynamicViewportMax,\n    // https://drafts.csswg.org/css-contain-3/#container-lengths\n    //\n    // See also IsContainerPercentageLength.\n    // kContainerWidth,\n    // kContainerHeight,\n    // kContainerInlineSize,\n    // kContainerBlockSize,\n    // kContainerMin,\n    // kContainerMax,\n    UnitType[UnitType[\"kRems\"] = 5] = \"kRems\";\n    // kChs,\n    // kUserUnits, // The SVG term for unitless lengths\n    // Angle units\n    UnitType[UnitType[\"kDegrees\"] = 6] = \"kDegrees\";\n    UnitType[UnitType[\"kRadians\"] = 7] = \"kRadians\";\n    UnitType[UnitType[\"kGradians\"] = 8] = \"kGradians\";\n    UnitType[UnitType[\"kTurns\"] = 9] = \"kTurns\";\n    // Time units\n    UnitType[UnitType[\"kMilliseconds\"] = 10] = \"kMilliseconds\";\n    UnitType[UnitType[\"kSeconds\"] = 11] = \"kSeconds\";\n    // kHertz,\n    // kKilohertz,\n    // Resolution\n    // kDotsPerPixel,\n    // kDotsPerInch,\n    // kDotsPerCentimeter,\n    // Other units\n    // kFraction,\n    UnitType[UnitType[\"kInteger\"] = 12] = \"kInteger\";\n    // This value is used to handle quirky margins in reflow roots (body, td,\n    // and th) like WinIE. The basic idea is that a stylesheet can use the value\n    // __qem (for quirky em) instead of em. When the quirky value is used, if\n    // you're in quirks mode, the margin will collapse away inside a table cell.\n    // This quirk is specified in the HTML spec but our impl is different.\n    // TODO: Remove this. crbug.com/443952\n    // kQuirkyEms,\n})(UnitType || (UnitType = {}));\nvar UnitCategory;\n(function (UnitCategory) {\n    UnitCategory[UnitCategory[\"kUNumber\"] = 0] = \"kUNumber\";\n    UnitCategory[UnitCategory[\"kUPercent\"] = 1] = \"kUPercent\";\n    UnitCategory[UnitCategory[\"kULength\"] = 2] = \"kULength\";\n    UnitCategory[UnitCategory[\"kUAngle\"] = 3] = \"kUAngle\";\n    UnitCategory[UnitCategory[\"kUTime\"] = 4] = \"kUTime\";\n    // kUFrequency,\n    // kUResolution,\n    UnitCategory[UnitCategory[\"kUOther\"] = 5] = \"kUOther\";\n})(UnitCategory || (UnitCategory = {}));\nvar ValueRange;\n(function (ValueRange) {\n    ValueRange[ValueRange[\"kAll\"] = 0] = \"kAll\";\n    ValueRange[ValueRange[\"kNonNegative\"] = 1] = \"kNonNegative\";\n    ValueRange[ValueRange[\"kInteger\"] = 2] = \"kInteger\";\n    ValueRange[ValueRange[\"kNonNegativeInteger\"] = 3] = \"kNonNegativeInteger\";\n    ValueRange[ValueRange[\"kPositiveInteger\"] = 4] = \"kPositiveInteger\";\n})(ValueRange || (ValueRange = {}));\nvar Nested;\n(function (Nested) {\n    Nested[Nested[\"kYes\"] = 0] = \"kYes\";\n    Nested[Nested[\"kNo\"] = 1] = \"kNo\";\n})(Nested || (Nested = {}));\nvar ParenLess;\n(function (ParenLess) {\n    ParenLess[ParenLess[\"kYes\"] = 0] = \"kYes\";\n    ParenLess[ParenLess[\"kNo\"] = 1] = \"kNo\";\n})(ParenLess || (ParenLess = {}));\n\n// This file specifies the unit strings used in CSSPrimitiveValues.\nvar data = [\n    {\n        name: 'em',\n        unit_type: UnitType.kEms,\n    },\n    // {\n    //   name: 'ex',\n    //   unit_type: UnitType.kExs,\n    // },\n    {\n        name: 'px',\n        unit_type: UnitType.kPixels,\n    },\n    // {\n    //   name: \"cm\",\n    //   unit_type: UnitType.kCentimeters,\n    // },\n    // {\n    //   name: \"mm\",\n    //   unit_type: UnitType.kMillimeters,\n    // },\n    // {\n    //   name: \"q\",\n    //   unit_type: UnitType.kQuarterMillimeters,\n    // },\n    // {\n    //   name: \"in\",\n    //   unit_type: UnitType.kInches,\n    // },\n    // {\n    //   name: \"pt\",\n    //   unit_type: UnitType.kPoints,\n    // },\n    // {\n    //   name: \"pc\",\n    //   unit_type: UnitType.kPicas,\n    // },\n    {\n        name: 'deg',\n        unit_type: UnitType.kDegrees,\n    },\n    {\n        name: 'rad',\n        unit_type: UnitType.kRadians,\n    },\n    {\n        name: 'grad',\n        unit_type: UnitType.kGradians,\n    },\n    {\n        name: 'ms',\n        unit_type: UnitType.kMilliseconds,\n    },\n    {\n        name: 's',\n        unit_type: UnitType.kSeconds,\n    },\n    // {\n    //   name: \"hz\",\n    //   unit_type: UnitType.kHertz,\n    // },\n    // {\n    //   name: \"khz\",\n    //   unit_type: UnitType.kKilohertz,\n    // },\n    // {\n    //   name: \"dpi\",\n    //   unit_type: \"kDotsPerInch\",\n    // },\n    // {\n    //   name: \"dpcm\",\n    //   unit_type: \"kDotsPerCentimeter\",\n    // },\n    // {\n    //   name: \"dppx\",\n    //   unit_type: \"kDotsPerPixel\",\n    // },\n    // {\n    //   name: \"x\",\n    //   unit_type: \"kDotsPerPixel\",\n    // },\n    // {\n    //   name: \"vw\",\n    //   unit_type: \"kViewportWidth\",\n    // },\n    // {\n    //   name: \"vh\",\n    //   unit_type: \"kViewportHeight\",\n    // },\n    // {\n    //   name: \"vi\",\n    //   unit_type: \"kViewportInlineSize\",\n    // },\n    // {\n    //   name: \"vb\",\n    //   unit_type: \"kViewportBlockSize\",\n    // },\n    // {\n    //   name: \"vmin\",\n    //   unit_type: UnitType.kViewportMin,\n    // },\n    // {\n    //   name: \"vmax\",\n    //   unit_type: UnitType.kViewportMax,\n    // },\n    // {\n    //   name: \"svw\",\n    //   unit_type: \"kSmallViewportWidth\",\n    // },\n    // {\n    //   name: \"svh\",\n    //   unit_type: \"kSmallViewportHeight\",\n    // },\n    // {\n    //   name: \"svi\",\n    //   unit_type: \"kSmallViewportInlineSize\",\n    // },\n    // {\n    //   name: \"svb\",\n    //   unit_type: \"kSmallViewportBlockSize\",\n    // },\n    // {\n    //   name: \"svmin\",\n    //   unit_type: \"kSmallViewportMin\",\n    // },\n    // {\n    //   name: \"svmax\",\n    //   unit_type: \"kSmallViewportMax\",\n    // },\n    // {\n    //   name: \"lvw\",\n    //   unit_type: \"kLargeViewportWidth\",\n    // },\n    // {\n    //   name: \"lvh\",\n    //   unit_type: \"kLargeViewportHeight\",\n    // },\n    // {\n    //   name: \"lvi\",\n    //   unit_type: \"kLargeViewportInlineSize\",\n    // },\n    // {\n    //   name: \"lvb\",\n    //   unit_type: \"kLargeViewportBlockSize\",\n    // },\n    // {\n    //   name: \"lvmin\",\n    //   unit_type: UnitType.kLargeViewportMin,\n    // },\n    // {\n    //   name: \"lvmax\",\n    //   unit_type: UnitType.kLargeViewportMax,\n    // },\n    // {\n    //   name: \"dvw\",\n    //   unit_type: UnitType.kDynamicViewportWidth,\n    // },\n    // {\n    //   name: \"dvh\",\n    //   unit_type: UnitType.kDynamicViewportHeight,\n    // },\n    // {\n    //   name: \"dvi\",\n    //   unit_type: UnitType.kDynamicViewportInlineSize,\n    // },\n    // {\n    //   name: \"dvb\",\n    //   unit_type: UnitType.kDynamicViewportBlockSize,\n    // },\n    // {\n    //   name: \"dvmin\",\n    //   unit_type: UnitType.kDynamicViewportMin,\n    // },\n    // {\n    //   name: \"dvmax\",\n    //   unit_type: UnitType.kDynamicViewportMax,\n    // },\n    // {\n    //   name: \"cqw\",\n    //   unit_type: UnitType.kContainerWidth,\n    // },\n    // {\n    //   name: \"cqh\",\n    //   unit_type: UnitType.kContainerHeight,\n    // },\n    // {\n    //   name: \"cqi\",\n    //   unit_type: UnitType.kContainerInlineSize,\n    // },\n    // {\n    //   name: \"cqb\",\n    //   unit_type: UnitType.kContainerBlockSize,\n    // },\n    // {\n    //   name: \"cqmin\",\n    //   unit_type: UnitType.kContainerMin,\n    // },\n    // {\n    //   name: \"cqmax\",\n    //   unit_type: UnitType.kContainerMax,\n    // },\n    {\n        name: 'rem',\n        unit_type: UnitType.kRems,\n    },\n    // {\n    //   name: 'fr',\n    //   unit_type: UnitType.kFraction,\n    // },\n    {\n        name: 'turn',\n        unit_type: UnitType.kTurns,\n    },\n    // {\n    //   name: 'ch',\n    //   unit_type: UnitType.kChs,\n    // },\n    // {\n    //   name: '__qem',\n    //   unit_type: UnitType.kQuirkyEms,\n    // },\n];\nvar CSSStyleValueType;\n(function (CSSStyleValueType) {\n    CSSStyleValueType[CSSStyleValueType[\"kUnknownType\"] = 0] = \"kUnknownType\";\n    CSSStyleValueType[CSSStyleValueType[\"kUnparsedType\"] = 1] = \"kUnparsedType\";\n    CSSStyleValueType[CSSStyleValueType[\"kKeywordType\"] = 2] = \"kKeywordType\";\n    // Start of CSSNumericValue subclasses\n    CSSStyleValueType[CSSStyleValueType[\"kUnitType\"] = 3] = \"kUnitType\";\n    CSSStyleValueType[CSSStyleValueType[\"kSumType\"] = 4] = \"kSumType\";\n    CSSStyleValueType[CSSStyleValueType[\"kProductType\"] = 5] = \"kProductType\";\n    CSSStyleValueType[CSSStyleValueType[\"kNegateType\"] = 6] = \"kNegateType\";\n    CSSStyleValueType[CSSStyleValueType[\"kInvertType\"] = 7] = \"kInvertType\";\n    CSSStyleValueType[CSSStyleValueType[\"kMinType\"] = 8] = \"kMinType\";\n    CSSStyleValueType[CSSStyleValueType[\"kMaxType\"] = 9] = \"kMaxType\";\n    CSSStyleValueType[CSSStyleValueType[\"kClampType\"] = 10] = \"kClampType\";\n    // End of CSSNumericValue subclasses\n    CSSStyleValueType[CSSStyleValueType[\"kTransformType\"] = 11] = \"kTransformType\";\n    CSSStyleValueType[CSSStyleValueType[\"kPositionType\"] = 12] = \"kPositionType\";\n    CSSStyleValueType[CSSStyleValueType[\"kURLImageType\"] = 13] = \"kURLImageType\";\n    CSSStyleValueType[CSSStyleValueType[\"kColorType\"] = 14] = \"kColorType\";\n    CSSStyleValueType[CSSStyleValueType[\"kUnsupportedColorType\"] = 15] = \"kUnsupportedColorType\";\n})(CSSStyleValueType || (CSSStyleValueType = {}));\n// function parseCSSStyleValue(propertyName: string, value: string): CSSStyleValue[] {\n//   // const propertyId = cssPropertyID(propertyName);\n//   // if (propertyId === CSSPropertyID.kInvalid) {\n//   //   return [];\n//   // }\n//   // const customPropertyName = propertyId === CSSPropertyID.kVariable ? propertyName : null;\n//   // return fromString(propertyId, customPropertyName, value);\n//   return [];\n// }\nvar stringToUnitType = function (name) {\n    return data.find(function (item) { return item.name === name; }).unit_type;\n};\nvar unitFromName = function (name) {\n    if (!name) {\n        return UnitType.kUnknown;\n    }\n    if (name === 'number') {\n        return UnitType.kNumber;\n    }\n    if (name === 'percent' || name === '%') {\n        return UnitType.kPercentage;\n    }\n    return stringToUnitType(name);\n};\nvar unitTypeToUnitCategory = function (type) {\n    switch (type) {\n        case UnitType.kNumber:\n        case UnitType.kInteger:\n            return UnitCategory.kUNumber;\n        case UnitType.kPercentage:\n            return UnitCategory.kUPercent;\n        case UnitType.kPixels:\n            // case UnitType.kCentimeters:\n            // case UnitType.kMillimeters:\n            // case UnitType.kQuarterMillimeters:\n            // case UnitType.kInches:\n            // case UnitType.kPoints:\n            // case UnitType.kPicas:\n            // case UnitType.kUserUnits:\n            return UnitCategory.kULength;\n        case UnitType.kMilliseconds:\n        case UnitType.kSeconds:\n            return UnitCategory.kUTime;\n        case UnitType.kDegrees:\n        case UnitType.kRadians:\n        case UnitType.kGradians:\n        case UnitType.kTurns:\n            return UnitCategory.kUAngle;\n        // case UnitType.kHertz:\n        // case UnitType.kKilohertz:\n        //   return UnitCategory.kUFrequency;\n        // case UnitType.kDotsPerPixel:\n        // case UnitType.kDotsPerInch:\n        // case UnitType.kDotsPerCentimeter:\n        //   return UnitCategory.kUResolution;\n        default:\n            return UnitCategory.kUOther;\n    }\n};\nvar canonicalUnitTypeForCategory = function (category) {\n    // The canonical unit type is chosen according to the way\n    // CSSPropertyParser.ValidUnit() chooses the default unit in each category\n    // (based on unitflags).\n    switch (category) {\n        case UnitCategory.kUNumber:\n            return UnitType.kNumber;\n        case UnitCategory.kULength:\n            return UnitType.kPixels;\n        case UnitCategory.kUPercent:\n            return UnitType.kPercentage;\n        // return UnitType.kUnknown; // Cannot convert between numbers and percent.\n        case UnitCategory.kUTime:\n            return UnitType.kSeconds;\n        case UnitCategory.kUAngle:\n            return UnitType.kDegrees;\n        // case UnitCategory.kUFrequency:\n        //   return UnitType.kHertz;\n        // case UnitCategory.kUResolution:\n        //   return UnitType.kDotsPerPixel;\n        default:\n            return UnitType.kUnknown;\n    }\n};\n/**\n * @see https://chromium.googlesource.com/chromium/src/+/refs/heads/main/third_party/blink/renderer/core/css/css_primitive_value.cc#353\n */\nvar conversionToCanonicalUnitsScaleFactor = function (unit_type) {\n    var factor = 1.0;\n    // FIXME: the switch can be replaced by an array of scale factors.\n    switch (unit_type) {\n        // These are \"canonical\" units in their respective categories.\n        case UnitType.kPixels:\n        // case UnitType.kUserUnits:\n        case UnitType.kDegrees:\n        case UnitType.kSeconds:\n            // case UnitType.kHertz:\n            break;\n        case UnitType.kMilliseconds:\n            factor = 0.001;\n            break;\n        // case UnitType.kCentimeters:\n        //   // factor = kCssPixelsPerCentimeter;\n        //   break;\n        // case UnitType.kDotsPerCentimeter:\n        //   // factor = 1 / kCssPixelsPerCentimeter;\n        //   break;\n        // case UnitType.kMillimeters:\n        //   // factor = kCssPixelsPerMillimeter;\n        //   break;\n        // case UnitType.kQuarterMillimeters:\n        //   // factor = kCssPixelsPerQuarterMillimeter;\n        //   break;\n        // case UnitType.kInches:\n        //   // factor = kCssPixelsPerInch;\n        //   break;\n        // case UnitType.kDotsPerInch:\n        //   // factor = 1 / kCssPixelsPerInch;\n        //   break;\n        // case UnitType.kPoints:\n        //   // factor = kCssPixelsPerPoint;\n        //   break;\n        // case UnitType.kPicas:\n        //   // factor = kCssPixelsPerPica;\n        //   break;\n        case UnitType.kRadians:\n            factor = 180 / Math.PI;\n            break;\n        case UnitType.kGradians:\n            factor = 0.9;\n            break;\n        case UnitType.kTurns:\n            factor = 360;\n            break;\n    }\n    return factor;\n};\nvar unitTypeToString = function (type) {\n    switch (type) {\n        case UnitType.kNumber:\n        case UnitType.kInteger:\n            // case UnitType.kUserUnits:\n            return '';\n        case UnitType.kPercentage:\n            return '%';\n        case UnitType.kEms:\n            // case UnitType.kQuirkyEms:\n            return 'em';\n        // case UnitType.kExs:\n        //   return 'ex';\n        case UnitType.kRems:\n            return 'rem';\n        // case UnitType.kChs:\n        //   return 'ch';\n        case UnitType.kPixels:\n            return 'px';\n        // case UnitType.kCentimeters:\n        //   return 'cm';\n        // case UnitType.kDotsPerPixel:\n        //   return 'dppx';\n        // case UnitType.kDotsPerInch:\n        //   return 'dpi';\n        // case UnitType.kDotsPerCentimeter:\n        //   return 'dpcm';\n        // case UnitType.kMillimeters:\n        //   return 'mm';\n        // case UnitType.kQuarterMillimeters:\n        //   return 'q';\n        // case UnitType.kInches:\n        //   return 'in';\n        // case UnitType.kPoints:\n        //   return 'pt';\n        // case UnitType.kPicas:\n        //   return 'pc';\n        case UnitType.kDegrees:\n            return 'deg';\n        case UnitType.kRadians:\n            return 'rad';\n        case UnitType.kGradians:\n            return 'grad';\n        case UnitType.kMilliseconds:\n            return 'ms';\n        case UnitType.kSeconds:\n            return 's';\n        // case UnitType.kHertz:\n        //   return 'hz';\n        // case UnitType.kKilohertz:\n        //   return 'khz';\n        case UnitType.kTurns:\n            return 'turn';\n    }\n    return '';\n};\n/**\n * CSSStyleValue is the base class for all CSS values accessible from Typed OM.\n * Values that are not yet supported as specific types are also returned as base CSSStyleValues.\n *\n * Spec @see https://drafts.css-houdini.org/css-typed-om/#stylevalue-objects\n * Docs @see https://developer.mozilla.org/en-US/docs/Web/API/CSSStyleValue\n */\nvar CSSStyleValue = /** @class */ (function () {\n    function CSSStyleValue() {\n    }\n    // static parse(propertyName: string, value: string): CSSStyleValue {\n    //   return parseCSSStyleValue(propertyName, value)[0];\n    // }\n    // static parseAll(propertyName: string, value: string): CSSStyleValue[] {\n    //   return parseCSSStyleValue(propertyName, value);\n    // }\n    CSSStyleValue.isAngle = function (unit) {\n        return (unit === UnitType.kDegrees ||\n            unit === UnitType.kRadians ||\n            unit === UnitType.kGradians ||\n            unit === UnitType.kTurns);\n    };\n    // static isViewportPercentageLength(type: UnitType) {\n    //   return type >= UnitType.kViewportWidth && type <= UnitType.kDynamicViewportMax;\n    // }\n    // static isContainerPercentageLength(type: UnitType) {\n    //   return type >= UnitType.kContainerWidth && type <= UnitType.kContainerMax;\n    // }\n    CSSStyleValue.isLength = function (type) {\n        // return (type >= UnitType.kEms && type <= UnitType.kUserUnits) || type == UnitType.kQuirkyEms;\n        return type >= UnitType.kEms && type < UnitType.kDegrees;\n    };\n    CSSStyleValue.isRelativeUnit = function (type) {\n        return (type === UnitType.kPercentage ||\n            type === UnitType.kEms ||\n            // type === UnitType.kExs ||\n            type === UnitType.kRems\n        // type === UnitType.kChs ||\n        // this.isViewportPercentageLength(type) ||\n        // this.isContainerPercentageLength(type)\n        );\n    };\n    CSSStyleValue.isTime = function (unit) {\n        return unit === UnitType.kSeconds || unit === UnitType.kMilliseconds;\n    };\n    // protected abstract toCSSValue(): CSSValue;\n    CSSStyleValue.prototype.toString = function () {\n        return this.buildCSSText(Nested.kNo, ParenLess.kNo, '');\n    };\n    CSSStyleValue.prototype.isNumericValue = function () {\n        return (this.getType() >= CSSStyleValueType.kUnitType &&\n            this.getType() <= CSSStyleValueType.kClampType);\n    };\n    return CSSStyleValue;\n}());\n\n/**\n * CSSColorValue is the base class used for the various CSS color interfaces.\n *\n * @see https://drafts.css-houdini.org/css-typed-om-1/#colorvalue-objects\n */\nvar CSSColorValue = /** @class */ (function (_super) {\n    __extends(CSSColorValue, _super);\n    function CSSColorValue(colorSpace) {\n        var _this = _super.call(this) || this;\n        _this.colorSpace = colorSpace;\n        return _this;\n    }\n    CSSColorValue.prototype.getType = function () {\n        return CSSStyleValueType.kColorType;\n    };\n    // buildCSSText(n: Nested, p: ParenLess, result: string): string {\n    //   let text = '';\n    //   if (this.colorSpace === 'rgb') {\n    //     text = `rgba(${this.channels.join(',')},${this.alpha})`;\n    //   }\n    //   return (result += text);\n    // }\n    /**\n     * @see https://drafts.css-houdini.org/css-typed-om-1/#dom-csscolorvalue-to\n     */\n    CSSColorValue.prototype.to = function (colorSpace) {\n        return this;\n    };\n    return CSSColorValue;\n}(CSSStyleValue));\n\nvar GradientType;\n(function (GradientType) {\n    GradientType[GradientType[\"Constant\"] = 0] = \"Constant\";\n    GradientType[GradientType[\"LinearGradient\"] = 1] = \"LinearGradient\";\n    GradientType[GradientType[\"RadialGradient\"] = 2] = \"RadialGradient\";\n})(GradientType || (GradientType = {}));\nvar CSSGradientValue = /** @class */ (function (_super) {\n    __extends(CSSGradientValue, _super);\n    function CSSGradientValue(type, value) {\n        var _this = _super.call(this) || this;\n        _this.type = type;\n        _this.value = value;\n        return _this;\n    }\n    CSSGradientValue.prototype.clone = function () {\n        return new CSSGradientValue(this.type, this.value);\n    };\n    CSSGradientValue.prototype.buildCSSText = function (n, p, result) {\n        return result;\n    };\n    CSSGradientValue.prototype.getType = function () {\n        return CSSStyleValueType.kColorType;\n    };\n    return CSSGradientValue;\n}(CSSStyleValue));\n\n/**\n * CSSKeywordValue represents CSS Values that are specified as keywords\n * eg. 'initial'\n * @see https://developer.mozilla.org/en-US/docs/Web/API/CSSKeywordValue\n * @see https://chromium.googlesource.com/chromium/src/+/refs/heads/main/third_party/blink/renderer/core/css/cssom/css_keyword_value.idl\n */\nvar CSSKeywordValue = /** @class */ (function (_super) {\n    __extends(CSSKeywordValue, _super);\n    function CSSKeywordValue(value) {\n        var _this = _super.call(this) || this;\n        _this.value = value;\n        return _this;\n    }\n    CSSKeywordValue.prototype.clone = function () {\n        return new CSSKeywordValue(this.value);\n    };\n    CSSKeywordValue.prototype.getType = function () {\n        return CSSStyleValueType.kKeywordType;\n    };\n    CSSKeywordValue.prototype.buildCSSText = function (n, p, result) {\n        return result + this.value;\n    };\n    return CSSKeywordValue;\n}(CSSStyleValue));\n\nvar camelCase = memoize(function (str) {\n    if (str === void 0) { str = ''; }\n    return str.replace(/-([a-z])/g, function (g) { return g[1].toUpperCase(); });\n});\nvar kebabize = function (str) {\n    return str\n        .split('')\n        .map(function (letter, idx) {\n        return letter.toUpperCase() === letter\n            ? \"\".concat(idx !== 0 ? '-' : '').concat(letter.toLowerCase())\n            : letter;\n    })\n        .join('');\n};\n\nfunction DCHECK(bool) {\n    if (!bool) {\n        throw new Error();\n    }\n}\nfunction isFunction(func) {\n    return typeof func === 'function';\n}\nfunction isSymbol(value) {\n    // @see https://github.com/lodash/lodash/blob/master/isSymbol.js\n    return typeof value === 'symbol';\n}\nvar definedProps = function (obj) {\n    return Object.fromEntries(Object.entries(obj).filter(function (_a) {\n        var _b = __read(_a, 2), v = _b[1];\n        return v !== undefined;\n    }));\n};\nvar FORMAT_ATTR_MAP = {\n    d: {\n        alias: 'path',\n    },\n    strokeDasharray: {\n        alias: 'lineDash',\n    },\n    strokeWidth: {\n        alias: 'lineWidth',\n    },\n    textAnchor: {\n        alias: 'textAlign',\n    },\n    src: {\n        alias: 'img',\n    },\n};\nvar formatAttributeName = memoize(function (name) {\n    var attributeName = camelCase(name);\n    var map = FORMAT_ATTR_MAP[attributeName];\n    attributeName = (map === null || map === void 0 ? void 0 : map.alias) || attributeName;\n    return attributeName;\n});\n\n// type CSSNumericBaseType =\n//   | 'length'\n//   | 'angle'\n//   | 'time'\n//   | 'frequency'\n//   | 'resolution'\n//   | 'flex'\n//   | 'percent';\n// https://drafts.css-houdini.org/css-typed-om/#dictdef-cssnumerictype\n// interface CSSNumericType {\n//   length: number;\n//   angle: number;\n//   time: number;\n//   frequency: number;\n//   resolution: number;\n//   flex: number;\n//   percent: number;\n//   percentHint: CSSNumericBaseType;\n// }\nvar formatInfinityOrNaN = function (number, suffix) {\n    if (suffix === void 0) { suffix = ''; }\n    var result = '';\n    if (!Number.isFinite(number)) {\n        if (number > 0)\n            result = 'infinity';\n        else\n            result = '-infinity';\n    }\n    else {\n        DCHECK(Number.isNaN(number));\n        result = 'NaN';\n    }\n    return (result += suffix);\n};\nvar toCanonicalUnit = function (unit) {\n    return canonicalUnitTypeForCategory(unitTypeToUnitCategory(unit));\n};\n/**\n * CSSNumericValue is the base class for numeric and length typed CSS Values.\n * @see https://drafts.css-houdini.org/css-typed-om/#numeric-objects\n * @see https://developer.mozilla.org/en-US/docs/Web/API/CSSNumericValue\n * @see https://chromium.googlesource.com/chromium/src/+/refs/heads/main/third_party/blink/renderer/core/css/cssom/css_numeric_value.idl\n */\n/**\n * Represents numeric values that can be expressed as a single number plus a\n * unit (or a naked number or percentage).\n * @see https://drafts.css-houdini.org/css-typed-om/#cssunitvalue\n */\nvar CSSUnitValue = /** @class */ (function (_super) {\n    __extends(CSSUnitValue, _super);\n    function CSSUnitValue(value, unitOrName) {\n        if (unitOrName === void 0) { unitOrName = UnitType.kNumber; }\n        var _this = _super.call(this) || this;\n        var unit;\n        if (typeof unitOrName === 'string') {\n            unit = unitFromName(unitOrName);\n        }\n        else {\n            unit = unitOrName;\n        }\n        _this.unit = unit;\n        _this.value = value;\n        return _this;\n    }\n    CSSUnitValue.prototype.clone = function () {\n        return new CSSUnitValue(this.value, this.unit);\n    };\n    CSSUnitValue.prototype.equals = function (other) {\n        var other_unit_value = other;\n        return (this.value === other_unit_value.value &&\n            this.unit === other_unit_value.unit);\n    };\n    CSSUnitValue.prototype.getType = function () {\n        return CSSStyleValueType.kUnitType;\n    };\n    CSSUnitValue.prototype.convertTo = function (target_unit) {\n        if (this.unit === target_unit) {\n            return new CSSUnitValue(this.value, this.unit);\n        }\n        // Instead of defining the scale factors for every unit to every other unit,\n        // we simply convert to the canonical unit and back since we already have\n        // the scale factors for canonical units.\n        var canonical_unit = toCanonicalUnit(this.unit);\n        if (canonical_unit !== toCanonicalUnit(target_unit) ||\n            canonical_unit === UnitType.kUnknown) {\n            return null;\n        }\n        var scale_factor = conversionToCanonicalUnitsScaleFactor(this.unit) /\n            conversionToCanonicalUnitsScaleFactor(target_unit);\n        return new CSSUnitValue(this.value * scale_factor, target_unit);\n    };\n    CSSUnitValue.prototype.buildCSSText = function (n, p, result) {\n        var text;\n        switch (this.unit) {\n            case UnitType.kUnknown:\n                // FIXME\n                break;\n            case UnitType.kInteger:\n                text = Number(this.value).toFixed(0);\n                break;\n            case UnitType.kNumber:\n            case UnitType.kPercentage:\n            case UnitType.kEms:\n            // case UnitType.kQuirkyEms:\n            // case UnitType.kExs:\n            case UnitType.kRems:\n            // case UnitType.kChs:\n            case UnitType.kPixels:\n            // case UnitType.kCentimeters:\n            // case UnitType.kDotsPerPixel:\n            // case UnitType.kDotsPerInch:\n            // case UnitType.kDotsPerCentimeter:\n            // case UnitType.kMillimeters:\n            // case UnitType.kQuarterMillimeters:\n            // case UnitType.kInches:\n            // case UnitType.kPoints:\n            // case UnitType.kPicas:\n            // case UnitType.kUserUnits:\n            case UnitType.kDegrees:\n            case UnitType.kRadians:\n            case UnitType.kGradians:\n            case UnitType.kMilliseconds:\n            case UnitType.kSeconds:\n            // case UnitType.kHertz:\n            // case UnitType.kKilohertz:\n            case UnitType.kTurns: // case UnitType.kContainerMax: { // case UnitType.kContainerMin: // case UnitType.kContainerBlockSize: // case UnitType.kContainerInlineSize: // case UnitType.kContainerHeight: // case UnitType.kContainerWidth: // case UnitType.kDynamicViewportMax: // case UnitType.kDynamicViewportMin: // case UnitType.kDynamicViewportBlockSize: // case UnitType.kDynamicViewportInlineSize: // case UnitType.kDynamicViewportHeight: // case UnitType.kDynamicViewportWidth: // case UnitType.kLargeViewportMax: // case UnitType.kLargeViewportMin: // case UnitType.kLargeViewportBlockSize: // case UnitType.kLargeViewportInlineSize: // case UnitType.kLargeViewportHeight: // case UnitType.kLargeViewportWidth: // case UnitType.kSmallViewportMax: // case UnitType.kSmallViewportMin: // case UnitType.kSmallViewportBlockSize: // case UnitType.kSmallViewportInlineSize: // case UnitType.kSmallViewportHeight: // case UnitType.kSmallViewportWidth: // case UnitType.kViewportMax: // case UnitType.kViewportMin: // case UnitType.kViewportBlockSize: // case UnitType.kViewportInlineSize: // case UnitType.kViewportHeight: // case UnitType.kViewportWidth: // case UnitType.kFraction:\n                {\n                    var kMinInteger = -999999;\n                    var kMaxInteger = 999999;\n                    var value = this.value;\n                    var unit = unitTypeToString(this.unit);\n                    if (value < kMinInteger || value > kMaxInteger) {\n                        var unit_1 = unitTypeToString(this.unit);\n                        if (!Number.isFinite(value) || Number.isNaN(value)) {\n                            text = formatInfinityOrNaN(value, unit_1);\n                        }\n                        else {\n                            text = value + (unit_1 || '');\n                        }\n                    }\n                    else {\n                        text = \"\".concat(value).concat(unit);\n                    }\n                }\n        }\n        result += text;\n        return result;\n    };\n    return CSSUnitValue;\n}(CSSStyleValue));\nvar Opx = new CSSUnitValue(0, 'px');\nnew CSSUnitValue(1, 'px');\nvar Odeg = new CSSUnitValue(0, 'deg');\n\n/**\n * The CSSRGB class represents the CSS rgb()/rgba() functions.\n *\n * @see https://drafts.css-houdini.org/css-typed-om-1/#cssrgb\n */\nvar CSSRGB = /** @class */ (function (_super) {\n    __extends(CSSRGB, _super);\n    function CSSRGB(r, g, b, alpha, \n    /**\n     * 'transparent' & 'none' has the same rgba data\n     */\n    isNone) {\n        if (alpha === void 0) { alpha = 1; }\n        if (isNone === void 0) { isNone = false; }\n        var _this = _super.call(this, 'rgb') || this;\n        _this.r = r;\n        _this.g = g;\n        _this.b = b;\n        _this.alpha = alpha;\n        _this.isNone = isNone;\n        return _this;\n    }\n    CSSRGB.prototype.clone = function () {\n        return new CSSRGB(this.r, this.g, this.b, this.alpha);\n    };\n    CSSRGB.prototype.buildCSSText = function (n, p, result) {\n        return result + \"rgba(\".concat(this.r, \",\").concat(this.g, \",\").concat(this.b, \",\").concat(this.alpha, \")\");\n    };\n    return CSSRGB;\n}(CSSColorValue));\n\n/**\n * CSSKeywordValue\n */\nvar unsetKeywordValue = new CSSKeywordValue('unset');\nvar initialKeywordValue = new CSSKeywordValue('initial');\nvar inheritKeywordValue = new CSSKeywordValue('inherit');\nvar keywordCache = {\n    '': unsetKeywordValue,\n    unset: unsetKeywordValue,\n    initial: initialKeywordValue,\n    inherit: inheritKeywordValue,\n};\nvar getOrCreateKeyword = function (name) {\n    if (!keywordCache[name]) {\n        keywordCache[name] = new CSSKeywordValue(name);\n    }\n    return keywordCache[name];\n};\n/**\n * CSSColor\n */\nvar noneColor = new CSSRGB(0, 0, 0, 0, true);\nvar transparentColor = new CSSRGB(0, 0, 0, 0);\nvar getOrCreateRGBA = memoize(function (r, g, b, a) {\n    return new CSSRGB(r, g, b, a);\n}, function (r, g, b, a) {\n    return \"rgba(\".concat(r, \",\").concat(g, \",\").concat(b, \",\").concat(a, \")\");\n});\n// export const getOrCreateUnitValue = memoize(\n//   (value: number, unitOrName: UnitType | string = UnitType.kNumber) => {\n//     return new CSSUnitValue(value, unitOrName);\n//   },\n//   (value: number, unitOrName: UnitType | string = UnitType.kNumber) => {\n//     return `${value}${unitOrName}`;\n//   },\n// );\nvar getOrCreateUnitValue = function (value, unitOrName) {\n    if (unitOrName === void 0) { unitOrName = UnitType.kNumber; }\n    return new CSSUnitValue(value, unitOrName);\n};\nnew CSSUnitValue(50, '%');\n\n/**\n * @see https://doc.babylonjs.com/how_to/optimizing_your_scene#changing-mesh-culling-strategy\n */\nvar Strategy;\n(function (Strategy) {\n    Strategy[Strategy[\"Standard\"] = 0] = \"Standard\";\n})(Strategy || (Strategy = {}));\n\nvar SortReason;\n(function (SortReason) {\n    SortReason[SortReason[\"ADDED\"] = 0] = \"ADDED\";\n    SortReason[SortReason[\"REMOVED\"] = 1] = \"REMOVED\";\n    SortReason[SortReason[\"Z_INDEX_CHANGED\"] = 2] = \"Z_INDEX_CHANGED\";\n})(SortReason || (SortReason = {}));\n\nvar EMPTY_PARSED_PATH = {\n    absolutePath: [],\n    hasArc: false,\n    segments: [],\n    polygons: [],\n    polylines: [],\n    curve: null,\n    totalLength: 0,\n    rect: new Rectangle(0, 0, 0, 0),\n};\n\n/**\n * @see https://developer.mozilla.org/en-US/docs/Web/SVG/Content_type\n */\nvar PropertySyntax;\n(function (PropertySyntax) {\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/SVG/Content_type#coordinate\n     */\n    PropertySyntax[\"COORDINATE\"] = \"<coordinate>\";\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/SVG/Content_type#color\n     */\n    PropertySyntax[\"COLOR\"] = \"<color>\";\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/SVG/Content_type#paint\n     */\n    PropertySyntax[\"PAINT\"] = \"<paint>\";\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/SVG/Content_type#number\n     */\n    PropertySyntax[\"NUMBER\"] = \"<number>\";\n    /**\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/CSS/angle\n     */\n    PropertySyntax[\"ANGLE\"] = \"<angle>\";\n    /**\n     * <number> with range 0..1\n     * @see https://developer.mozilla.org/en-US/docs/Web/SVG/Content_type#opacity_value\n     */\n    PropertySyntax[\"OPACITY_VALUE\"] = \"<opacity-value>\";\n    /**\n     * <number> with range 0..Infinity\n     */\n    PropertySyntax[\"SHADOW_BLUR\"] = \"<shadow-blur>\";\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/SVG/Content_type#length\n     */\n    PropertySyntax[\"LENGTH\"] = \"<length>\";\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/SVG/Content_type#percentage\n     */\n    PropertySyntax[\"PERCENTAGE\"] = \"<percentage>\";\n    PropertySyntax[\"LENGTH_PERCENTAGE\"] = \"<length> | <percentage>\";\n    PropertySyntax[\"LENGTH_PERCENTAGE_12\"] = \"[<length> | <percentage>]{1,2}\";\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/CSS/margin#formal_syntax\n     */\n    PropertySyntax[\"LENGTH_PERCENTAGE_14\"] = \"[<length> | <percentage>]{1,4}\";\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/SVG/Content_type#list-of-ts\n     */\n    PropertySyntax[\"LIST_OF_POINTS\"] = \"<list-of-points>\";\n    PropertySyntax[\"PATH\"] = \"<path>\";\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/CSS/filter#formal_syntax\n     */\n    PropertySyntax[\"FILTER\"] = \"<filter>\";\n    PropertySyntax[\"Z_INDEX\"] = \"<z-index>\";\n    PropertySyntax[\"OFFSET_DISTANCE\"] = \"<offset-distance>\";\n    PropertySyntax[\"DEFINED_PATH\"] = \"<defined-path>\";\n    PropertySyntax[\"MARKER\"] = \"<marker>\";\n    PropertySyntax[\"TRANSFORM\"] = \"<transform>\";\n    PropertySyntax[\"TRANSFORM_ORIGIN\"] = \"<transform-origin>\";\n    PropertySyntax[\"TEXT\"] = \"<text>\";\n    PropertySyntax[\"TEXT_TRANSFORM\"] = \"<text-transform>\";\n})(PropertySyntax || (PropertySyntax = {}));\n\n/**\n * borrow from gradient-parser, but we delete some browser compatible prefix such as `-webkit-`\n * @see https://github.com/rafaelcaricio/gradient-parser\n */\nfunction colorStopToString(colorStop) {\n    var type = colorStop.type, value = colorStop.value;\n    if (type === 'hex') {\n        return \"#\".concat(value);\n    }\n    else if (type === 'literal') {\n        return value;\n    }\n    else if (type === 'rgb') {\n        return \"rgb(\".concat(value.join(','), \")\");\n    }\n    else {\n        return \"rgba(\".concat(value.join(','), \")\");\n    }\n}\nvar parseGradient$1 = (function () {\n    var tokens = {\n        linearGradient: /^(linear\\-gradient)/i,\n        repeatingLinearGradient: /^(repeating\\-linear\\-gradient)/i,\n        radialGradient: /^(radial\\-gradient)/i,\n        repeatingRadialGradient: /^(repeating\\-radial\\-gradient)/i,\n        /**\n         * @see https://projects.verou.me/conic-gradient/\n         */\n        conicGradient: /^(conic\\-gradient)/i,\n        sideOrCorner: /^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,\n        extentKeywords: /^(closest\\-side|closest\\-corner|farthest\\-side|farthest\\-corner|contain|cover)/,\n        positionKeywords: /^(left|center|right|top|bottom)/i,\n        pixelValue: /^(-?(([0-9]*\\.[0-9]+)|([0-9]+\\.?)))px/,\n        percentageValue: /^(-?(([0-9]*\\.[0-9]+)|([0-9]+\\.?)))\\%/,\n        emValue: /^(-?(([0-9]*\\.[0-9]+)|([0-9]+\\.?)))em/,\n        angleValue: /^(-?(([0-9]*\\.[0-9]+)|([0-9]+\\.?)))deg/,\n        startCall: /^\\(/,\n        endCall: /^\\)/,\n        comma: /^,/,\n        hexColor: /^\\#([0-9a-fA-F]+)/,\n        literalColor: /^([a-zA-Z]+)/,\n        rgbColor: /^rgb/i,\n        rgbaColor: /^rgba/i,\n        number: /^(([0-9]*\\.[0-9]+)|([0-9]+\\.?))/,\n    };\n    var input = '';\n    function error(msg) {\n        throw new Error(input + ': ' + msg);\n    }\n    function getAST() {\n        var ast = matchListDefinitions();\n        if (input.length > 0) {\n            error('Invalid input not EOF');\n        }\n        return ast;\n    }\n    function matchListDefinitions() {\n        return matchListing(matchDefinition);\n    }\n    function matchDefinition() {\n        return (matchGradient('linear-gradient', tokens.linearGradient, matchLinearOrientation) ||\n            matchGradient('repeating-linear-gradient', tokens.repeatingLinearGradient, matchLinearOrientation) ||\n            matchGradient('radial-gradient', tokens.radialGradient, matchListRadialOrientations) ||\n            matchGradient('repeating-radial-gradient', tokens.repeatingRadialGradient, matchListRadialOrientations) ||\n            matchGradient('conic-gradient', tokens.conicGradient, matchListRadialOrientations));\n    }\n    function matchGradient(gradientType, pattern, orientationMatcher) {\n        return matchCall(pattern, function (captures) {\n            var orientation = orientationMatcher();\n            if (orientation) {\n                if (!scan(tokens.comma)) {\n                    error('Missing comma before color stops');\n                }\n            }\n            return {\n                type: gradientType,\n                orientation: orientation,\n                colorStops: matchListing(matchColorStop),\n            };\n        });\n    }\n    function matchCall(pattern, callback) {\n        var captures = scan(pattern);\n        if (captures) {\n            if (!scan(tokens.startCall)) {\n                error('Missing (');\n            }\n            var result = callback(captures);\n            if (!scan(tokens.endCall)) {\n                error('Missing )');\n            }\n            return result;\n        }\n    }\n    function matchLinearOrientation() {\n        return matchSideOrCorner() || matchAngle();\n    }\n    function matchSideOrCorner() {\n        return match('directional', tokens.sideOrCorner, 1);\n    }\n    function matchAngle() {\n        return match('angular', tokens.angleValue, 1);\n    }\n    function matchListRadialOrientations() {\n        var radialOrientations, radialOrientation = matchRadialOrientation(), lookaheadCache;\n        if (radialOrientation) {\n            radialOrientations = [];\n            radialOrientations.push(radialOrientation);\n            lookaheadCache = input;\n            if (scan(tokens.comma)) {\n                radialOrientation = matchRadialOrientation();\n                if (radialOrientation) {\n                    radialOrientations.push(radialOrientation);\n                }\n                else {\n                    input = lookaheadCache;\n                }\n            }\n        }\n        return radialOrientations;\n    }\n    function matchRadialOrientation() {\n        var radialType = matchCircle() || matchEllipse();\n        if (radialType) {\n            // @ts-ignore\n            radialType.at = matchAtPosition();\n        }\n        else {\n            var extent = matchExtentKeyword();\n            if (extent) {\n                radialType = extent;\n                var positionAt = matchAtPosition();\n                if (positionAt) {\n                    // @ts-ignore\n                    radialType.at = positionAt;\n                }\n            }\n            else {\n                var defaultPosition = matchPositioning();\n                if (defaultPosition) {\n                    radialType = {\n                        type: 'default-radial',\n                        // @ts-ignore\n                        at: defaultPosition,\n                    };\n                }\n            }\n        }\n        return radialType;\n    }\n    function matchCircle() {\n        var circle = match('shape', /^(circle)/i, 0);\n        if (circle) {\n            // @ts-ignore\n            circle.style = matchLength() || matchExtentKeyword();\n        }\n        return circle;\n    }\n    function matchEllipse() {\n        var ellipse = match('shape', /^(ellipse)/i, 0);\n        if (ellipse) {\n            // @ts-ignore\n            ellipse.style = matchDistance() || matchExtentKeyword();\n        }\n        return ellipse;\n    }\n    function matchExtentKeyword() {\n        return match('extent-keyword', tokens.extentKeywords, 1);\n    }\n    function matchAtPosition() {\n        if (match('position', /^at/, 0)) {\n            var positioning = matchPositioning();\n            if (!positioning) {\n                error('Missing positioning value');\n            }\n            return positioning;\n        }\n    }\n    function matchPositioning() {\n        var location = matchCoordinates();\n        if (location.x || location.y) {\n            return {\n                type: 'position',\n                value: location,\n            };\n        }\n    }\n    function matchCoordinates() {\n        return {\n            x: matchDistance(),\n            y: matchDistance(),\n        };\n    }\n    function matchListing(matcher) {\n        var captures = matcher();\n        var result = [];\n        if (captures) {\n            result.push(captures);\n            while (scan(tokens.comma)) {\n                captures = matcher();\n                if (captures) {\n                    result.push(captures);\n                }\n                else {\n                    error('One extra comma');\n                }\n            }\n        }\n        return result;\n    }\n    function matchColorStop() {\n        var color = matchColor();\n        if (!color) {\n            error('Expected color definition');\n        }\n        color.length = matchDistance();\n        return color;\n    }\n    function matchColor() {\n        return (matchHexColor() ||\n            matchRGBAColor() ||\n            matchRGBColor() ||\n            matchLiteralColor());\n    }\n    function matchLiteralColor() {\n        return match('literal', tokens.literalColor, 0);\n    }\n    function matchHexColor() {\n        return match('hex', tokens.hexColor, 1);\n    }\n    function matchRGBColor() {\n        return matchCall(tokens.rgbColor, function () {\n            return {\n                type: 'rgb',\n                value: matchListing(matchNumber),\n            };\n        });\n    }\n    function matchRGBAColor() {\n        return matchCall(tokens.rgbaColor, function () {\n            return {\n                type: 'rgba',\n                value: matchListing(matchNumber),\n            };\n        });\n    }\n    function matchNumber() {\n        return scan(tokens.number)[1];\n    }\n    function matchDistance() {\n        return (match('%', tokens.percentageValue, 1) ||\n            matchPositionKeyword() ||\n            matchLength());\n    }\n    function matchPositionKeyword() {\n        return match('position-keyword', tokens.positionKeywords, 1);\n    }\n    function matchLength() {\n        return match('px', tokens.pixelValue, 1) || match('em', tokens.emValue, 1);\n    }\n    function match(type, pattern, captureIndex) {\n        var captures = scan(pattern);\n        if (captures) {\n            return {\n                type: type,\n                value: captures[captureIndex],\n            };\n        }\n    }\n    function scan(regexp) {\n        var blankCaptures = /^[\\n\\r\\t\\s]+/.exec(input);\n        if (blankCaptures) {\n            consume(blankCaptures[0].length);\n        }\n        var captures = regexp.exec(input);\n        if (captures) {\n            consume(captures[0].length);\n        }\n        return captures;\n    }\n    function consume(size) {\n        input = input.substring(size);\n    }\n    return function (code) {\n        input = code;\n        return getAST();\n    };\n})();\nfunction computeLinearGradient(min, width, height, angle) {\n    var rad = deg2rad(angle.value);\n    var rx = 0;\n    var ry = 0;\n    var rcx = rx + width / 2;\n    var rcy = ry + height / 2;\n    // get the length of gradient line\n    // @see https://observablehq.com/@danburzo/css-gradient-line\n    var length = Math.abs(width * Math.cos(rad)) + Math.abs(height * Math.sin(rad));\n    var x1 = min[0] + rcx - (Math.cos(rad) * length) / 2;\n    var y1 = min[1] + rcy - (Math.sin(rad) * length) / 2;\n    var x2 = min[0] + rcx + (Math.cos(rad) * length) / 2;\n    var y2 = min[1] + rcy + (Math.sin(rad) * length) / 2;\n    return { x1: x1, y1: y1, x2: x2, y2: y2 };\n}\nfunction computeRadialGradient(min, width, height, cx, cy, size) {\n    // 'px'\n    var x = cx.value;\n    var y = cy.value;\n    // TODO: 'em'\n    // '%'\n    if (cx.unit === UnitType.kPercentage) {\n        x = (cx.value / 100) * width;\n    }\n    if (cy.unit === UnitType.kPercentage) {\n        y = (cy.value / 100) * height;\n    }\n    // default to farthest-side\n    var r = Math.max(distanceSquareRoot([0, 0], [x, y]), distanceSquareRoot([0, height], [x, y]), distanceSquareRoot([width, height], [x, y]), distanceSquareRoot([width, 0], [x, y]));\n    if (size) {\n        if (size instanceof CSSUnitValue) {\n            r = size.value;\n        }\n        else if (size instanceof CSSKeywordValue) {\n            // @see https://developer.mozilla.org/zh-CN/docs/Web/CSS/CSS_Images/Using_CSS_gradients#example_closest-side_for_circles\n            if (size.value === 'closest-side') {\n                r = Math.min(x, width - x, y, height - y);\n            }\n            else if (size.value === 'farthest-side') {\n                r = Math.max(x, width - x, y, height - y);\n            }\n            else if (size.value === 'closest-corner') {\n                r = Math.min(distanceSquareRoot([0, 0], [x, y]), distanceSquareRoot([0, height], [x, y]), distanceSquareRoot([width, height], [x, y]), distanceSquareRoot([width, 0], [x, y]));\n            }\n        }\n    }\n    return { x: x + min[0], y: y + min[1], r: r };\n}\n\nvar regexLG = /^l\\s*\\(\\s*([\\d.]+)\\s*\\)\\s*(.*)/i;\nvar regexRG = /^r\\s*\\(\\s*([\\d.]+)\\s*,\\s*([\\d.]+)\\s*,\\s*([\\d.]+)\\s*\\)\\s*(.*)/i;\nvar regexPR = /^p\\s*\\(\\s*([axyn])\\s*\\)\\s*(.*)/i;\nvar regexColorStop = /[\\d.]+:(#[^\\s]+|[^\\)]+\\))/gi;\nfunction spaceColorStops(colorStops) {\n    var _a, _b, _c;\n    var length = colorStops.length;\n    colorStops[length - 1].length = (_a = colorStops[length - 1].length) !== null && _a !== void 0 ? _a : {\n        type: '%',\n        value: '100',\n    };\n    if (length > 1) {\n        colorStops[0].length = (_b = colorStops[0].length) !== null && _b !== void 0 ? _b : {\n            type: '%',\n            value: '0',\n        };\n    }\n    var previousIndex = 0;\n    var previousOffset = Number(colorStops[0].length.value);\n    for (var i = 1; i < length; i++) {\n        // support '%' & 'px'\n        var offset = (_c = colorStops[i].length) === null || _c === void 0 ? void 0 : _c.value;\n        if (!isNil(offset) && !isNil(previousOffset)) {\n            for (var j = 1; j < i - previousIndex; j++)\n                colorStops[previousIndex + j].length = {\n                    type: '%',\n                    value: \"\".concat(previousOffset +\n                        ((Number(offset) - previousOffset) * j) / (i - previousIndex)),\n                };\n            previousIndex = i;\n            previousOffset = Number(offset);\n        }\n    }\n}\n// The position of the gradient line's starting point.\n// different from CSS side(to top) @see https://developer.mozilla.org/en-US/docs/Web/CSS/gradient/linear-gradient#values\nvar SideOrCornerToDegMap = {\n    left: 270 - 90,\n    top: 0 - 90,\n    bottom: 180 - 90,\n    right: 90 - 90,\n    'left top': 315 - 90,\n    'top left': 315 - 90,\n    'left bottom': 225 - 90,\n    'bottom left': 225 - 90,\n    'right top': 45 - 90,\n    'top right': 45 - 90,\n    'right bottom': 135 - 90,\n    'bottom right': 135 - 90,\n};\nvar angleToDeg = memoize(function (orientation) {\n    var angle;\n    if (orientation.type === 'angular') {\n        angle = Number(orientation.value);\n    }\n    else {\n        angle = SideOrCornerToDegMap[orientation.value] || 0;\n    }\n    return getOrCreateUnitValue(angle, 'deg');\n});\nvar positonToCSSUnitValue = memoize(function (position) {\n    var cx = 50;\n    var cy = 50;\n    var unitX = '%';\n    var unitY = '%';\n    if ((position === null || position === void 0 ? void 0 : position.type) === 'position') {\n        var _a = position.value, x = _a.x, y = _a.y;\n        if ((x === null || x === void 0 ? void 0 : x.type) === 'position-keyword') {\n            if (x.value === 'left') {\n                cx = 0;\n            }\n            else if (x.value === 'center') {\n                cx = 50;\n            }\n            else if (x.value === 'right') {\n                cx = 100;\n            }\n            else if (x.value === 'top') {\n                cy = 0;\n            }\n            else if (x.value === 'bottom') {\n                cy = 100;\n            }\n        }\n        if ((y === null || y === void 0 ? void 0 : y.type) === 'position-keyword') {\n            if (y.value === 'left') {\n                cx = 0;\n            }\n            else if (y.value === 'center') {\n                cy = 50;\n            }\n            else if (y.value === 'right') {\n                cx = 100;\n            }\n            else if (y.value === 'top') {\n                cy = 0;\n            }\n            else if (y.value === 'bottom') {\n                cy = 100;\n            }\n        }\n        if ((x === null || x === void 0 ? void 0 : x.type) === 'px' || (x === null || x === void 0 ? void 0 : x.type) === '%' || (x === null || x === void 0 ? void 0 : x.type) === 'em') {\n            unitX = x === null || x === void 0 ? void 0 : x.type;\n            cx = Number(x.value);\n        }\n        if ((y === null || y === void 0 ? void 0 : y.type) === 'px' || (y === null || y === void 0 ? void 0 : y.type) === '%' || (y === null || y === void 0 ? void 0 : y.type) === 'em') {\n            unitY = y === null || y === void 0 ? void 0 : y.type;\n            cy = Number(y.value);\n        }\n    }\n    return {\n        cx: getOrCreateUnitValue(cx, unitX),\n        cy: getOrCreateUnitValue(cy, unitY),\n    };\n});\nvar parseGradient = memoize(function (colorStr) {\n    var _a;\n    if (colorStr.indexOf('linear') > -1 || colorStr.indexOf('radial') > -1) {\n        var ast = parseGradient$1(colorStr);\n        return ast.map(function (_a) {\n            var type = _a.type, orientation = _a.orientation, colorStops = _a.colorStops;\n            spaceColorStops(colorStops);\n            var steps = colorStops.map(function (colorStop) {\n                // TODO: only support % for now, should calc percentage of axis length when using px/em\n                return {\n                    offset: getOrCreateUnitValue(Number(colorStop.length.value), '%'),\n                    color: colorStopToString(colorStop),\n                };\n            });\n            if (type === 'linear-gradient') {\n                return new CSSGradientValue(GradientType.LinearGradient, {\n                    angle: orientation\n                        ? angleToDeg(orientation)\n                        : Odeg,\n                    steps: steps,\n                });\n            }\n            else if (type === 'radial-gradient') {\n                if (!orientation) {\n                    orientation = [\n                        {\n                            type: 'shape',\n                            value: 'circle',\n                        },\n                    ];\n                }\n                if (orientation[0].type === 'shape' &&\n                    orientation[0].value === 'circle') {\n                    var _b = positonToCSSUnitValue(orientation[0].at), cx = _b.cx, cy = _b.cy;\n                    var size = void 0;\n                    if (orientation[0].style) {\n                        var _c = orientation[0].style, type_1 = _c.type, value = _c.value;\n                        if (type_1 === 'extent-keyword') {\n                            size = getOrCreateKeyword(value);\n                        }\n                        else {\n                            size = getOrCreateUnitValue(value, type_1);\n                        }\n                    }\n                    return new CSSGradientValue(GradientType.RadialGradient, {\n                        cx: cx,\n                        cy: cy,\n                        size: size,\n                        steps: steps,\n                    });\n                }\n                // TODO: support ellipse shape\n                // TODO: repeating-linear-gradient & repeating-radial-gradient\n                // } else if (type === 'repeating-linear-gradient') {\n                // } else if (type === 'repeating-radial-gradient') {\n            }\n        });\n    }\n    // legacy format, should be deprecated later\n    var type = colorStr[0];\n    if (colorStr[1] === '(' || colorStr[2] === '(') {\n        if (type === 'l') {\n            var arr = regexLG.exec(colorStr);\n            if (arr) {\n                var steps = ((_a = arr[2].match(regexColorStop)) === null || _a === void 0 ? void 0 : _a.map(function (stop) { return stop.split(':'); })) || [];\n                return [\n                    new CSSGradientValue(GradientType.LinearGradient, {\n                        angle: getOrCreateUnitValue(parseFloat(arr[1]), 'deg'),\n                        steps: steps.map(function (_a) {\n                            var _b = __read(_a, 2), offset = _b[0], color = _b[1];\n                            return ({\n                                offset: getOrCreateUnitValue(Number(offset) * 100, '%'),\n                                color: color,\n                            });\n                        }),\n                    }),\n                ];\n            }\n        }\n        else if (type === 'r') {\n            var parsedRadialGradient = parseRadialGradient(colorStr);\n            if (parsedRadialGradient) {\n                if (isString(parsedRadialGradient)) {\n                    colorStr = parsedRadialGradient;\n                }\n                else {\n                    return [\n                        new CSSGradientValue(GradientType.RadialGradient, parsedRadialGradient),\n                    ];\n                }\n            }\n        }\n        else if (type === 'p') {\n            return parsePattern(colorStr);\n        }\n    }\n});\nfunction parseRadialGradient(gradientStr) {\n    var _a;\n    var arr = regexRG.exec(gradientStr);\n    if (arr) {\n        var steps = ((_a = arr[4].match(regexColorStop)) === null || _a === void 0 ? void 0 : _a.map(function (stop) { return stop.split(':'); })) || [];\n        return {\n            cx: getOrCreateUnitValue(50, '%'),\n            cy: getOrCreateUnitValue(50, '%'),\n            steps: steps.map(function (_a) {\n                var _b = __read(_a, 2), offset = _b[0], color = _b[1];\n                return ({\n                    offset: getOrCreateUnitValue(Number(offset) * 100, '%'),\n                    color: color,\n                });\n            }),\n        };\n    }\n    return null;\n}\nfunction parsePattern(patternStr) {\n    var arr = regexPR.exec(patternStr);\n    if (arr) {\n        var repetition = arr[1];\n        var src = arr[2];\n        switch (repetition) {\n            case 'a':\n                repetition = 'repeat';\n                break;\n            case 'x':\n                repetition = 'repeat-x';\n                break;\n            case 'y':\n                repetition = 'repeat-y';\n                break;\n            case 'n':\n                repetition = 'no-repeat';\n                break;\n            default:\n                repetition = 'no-repeat';\n        }\n        return {\n            image: src,\n            // @ts-ignore\n            repetition: repetition,\n        };\n    }\n    return null;\n}\n\nfunction isCSSGradientValue(object) {\n    return (!!object.type && !!object.value);\n}\nfunction isPattern(object) {\n    return object && !!object.image;\n}\nfunction isCSSRGB(object) {\n    return (object &&\n        !isNil(object.r) &&\n        !isNil(object.g) &&\n        !isNil(object.b));\n}\n/**\n * @see https://github.com/WebKit/WebKit/blob/main/Source/WebCore/css/parser/CSSParser.cpp#L97\n */\nvar parseColor = memoize(function (colorStr) {\n    if (isPattern(colorStr)) {\n        return __assign({ repetition: 'repeat' }, colorStr);\n    }\n    if (isNil(colorStr)) {\n        colorStr = '';\n    }\n    if (colorStr === 'transparent') {\n        // transparent black\n        return transparentColor;\n    }\n    else if (colorStr === 'currentColor') {\n        // @see https://github.com/adobe-webplatform/Snap.svg/issues/526\n        colorStr = 'black';\n    }\n    else if (colorStr === 'none') {\n        return noneColor;\n    }\n    // support CSS gradient syntax\n    var g = parseGradient(colorStr);\n    if (g) {\n        return g;\n    }\n    // constants\n    var color = d3.color(colorStr);\n    var rgba = [0, 0, 0, 0];\n    if (color !== null) {\n        rgba[0] = color.r || 0;\n        rgba[1] = color.g || 0;\n        rgba[2] = color.b || 0;\n        rgba[3] = color.opacity;\n    }\n    // return new CSSRGB(...rgba);\n    return getOrCreateRGBA.apply(void 0, __spreadArray([], __read(rgba), false));\n});\nfunction mergeColors(left, right) {\n    // only support constant value, exclude gradient & pattern\n    if (!isCSSRGB(left) || !isCSSRGB(right)) {\n        return;\n    }\n    return [\n        [Number(left.r), Number(left.g), Number(left.b), Number(left.alpha)],\n        [Number(right.r), Number(right.g), Number(right.b), Number(right.alpha)],\n        function (color) {\n            var rgba = color.slice();\n            if (rgba[3]) {\n                for (var i = 0; i < 3; i++)\n                    rgba[i] = Math.round(clamp(rgba[i], 0, 255));\n            }\n            rgba[3] = clamp(rgba[3], 0, 1);\n            return \"rgba(\".concat(rgba.join(','), \")\");\n        },\n    ];\n}\n\nfunction parseDimension(unitRegExp, string) {\n    if (isNil(string)) {\n        return getOrCreateUnitValue(0, 'px');\n    }\n    string = \"\".concat(string).trim().toLowerCase();\n    if (isFinite(Number(string))) {\n        if ('px'.search(unitRegExp) >= 0) {\n            return getOrCreateUnitValue(Number(string), 'px');\n        }\n        else if ('deg'.search(unitRegExp) >= 0) {\n            return getOrCreateUnitValue(Number(string), 'deg');\n        }\n    }\n    var matchedUnits = [];\n    string = string.replace(unitRegExp, function (match) {\n        matchedUnits.push(match);\n        return 'U' + match;\n    });\n    var taggedUnitRegExp = 'U(' + unitRegExp.source + ')';\n    return matchedUnits.map(function (unit) {\n        return getOrCreateUnitValue(Number(string\n            .replace(new RegExp('U' + unit, 'g'), '')\n            .replace(new RegExp(taggedUnitRegExp, 'g'), '*0')), unit);\n    })[0];\n}\n/**\n * <length>\n * @see https://developer.mozilla.org/zh-CN/docs/Web/CSS/length\n * length with only absolute unit, eg. 1px\n */\nvar parseLengthUnmemoize = function (css) {\n    return parseDimension(new RegExp('px', 'g'), css);\n};\nvar parseLength = memoize(parseLengthUnmemoize);\n/**\n * <percentage>\n * @see https://developer.mozilla.org/zh-CN/docs/Web/CSS/percentage\n */\nvar parserPercentageUnmemoize = function (css) {\n    return parseDimension(new RegExp('%', 'g'), css);\n};\nmemoize(parserPercentageUnmemoize);\n/**\n * length with absolute or relative unit,\n * eg. 1px, 0.7em, 50%, calc(100% - 200px);\n *\n * @see https://developer.mozilla.org/zh-CN/docs/Web/CSS/length-percentage\n */\nvar parseLengthOrPercentageUnmemoize = function (css) {\n    if (isNumber(css) || isFinite(Number(css))) {\n        // Number(css) is NaN\n        return getOrCreateUnitValue(Number(css) || 0, 'px');\n        // return Number(css);\n    }\n    return parseDimension(new RegExp('px|%|em|rem', 'g'), css);\n};\nvar parseLengthOrPercentage = memoize(parseLengthOrPercentageUnmemoize);\nvar parseAngleUnmemoize = function (css) {\n    return parseDimension(new RegExp('deg|rad|grad|turn', 'g'), css);\n};\nvar parseAngle = memoize(parseAngleUnmemoize);\n/**\n * merge CSSUnitValue\n *\n * @example\n * 10px + 20px = 30px\n * 10deg + 10rad\n * 10% + 20% = 30%\n */\nfunction mergeDimensions(left, right, target, nonNegative, index) {\n    if (index === void 0) { index = 0; }\n    var unit = '';\n    var leftValue = left.value || 0;\n    var rightValue = right.value || 0;\n    var canonicalUnit = toCanonicalUnit(left.unit);\n    var leftCanonicalUnitValue = left.convertTo(canonicalUnit);\n    var rightCanonicalUnitValue = right.convertTo(canonicalUnit);\n    if (leftCanonicalUnitValue && rightCanonicalUnitValue) {\n        leftValue = leftCanonicalUnitValue.value;\n        rightValue = rightCanonicalUnitValue.value;\n        unit = unitTypeToString(left.unit);\n    }\n    else {\n        // format '%' to 'px'\n        if (CSSUnitValue.isLength(left.unit) || CSSUnitValue.isLength(right.unit)) {\n            leftValue = convertPercentUnit(left, index, target);\n            rightValue = convertPercentUnit(right, index, target);\n            unit = 'px';\n        }\n    }\n    // // format 'rad' 'turn' to 'deg'\n    // if (CSSUnitValue.isAngle(left.unit) || CSSUnitValue.isAngle(right.unit)) {\n    //   leftValue = convertAngleUnit(left);\n    //   rightValue = convertAngleUnit(right);\n    //   unit = 'deg';\n    // }\n    return [\n        leftValue,\n        rightValue,\n        function (value) {\n            if (nonNegative) {\n                value = Math.max(value, 0);\n            }\n            return value + unit;\n        },\n    ];\n}\nfunction convertAngleUnit(value) {\n    var deg = 0;\n    if (value.unit === UnitType.kDegrees) {\n        deg = value.value;\n    }\n    else if (value.unit === UnitType.kRadians) {\n        deg = rad2deg(Number(value.value));\n    }\n    else if (value.unit === UnitType.kTurns) {\n        deg = turn2deg(Number(value.value));\n    }\n    return deg;\n}\nfunction parseDimensionArrayFormat(string, size) {\n    var parsed;\n    if (Array.isArray(string)) {\n        // [1, '2px', 3]\n        parsed = string.map(function (segment) { return Number(segment); });\n    }\n    else if (isString(string)) {\n        parsed = string.split(' ').map(function (segment) { return Number(segment); });\n    }\n    else if (isNumber(string)) {\n        parsed = [string];\n    }\n    if (size === 2) {\n        if (parsed.length === 1) {\n            return [parsed[0], parsed[0]];\n        }\n        else {\n            return [parsed[0], parsed[1]];\n        }\n    }\n    else {\n        if (parsed.length === 1) {\n            return [parsed[0], parsed[0], parsed[0], parsed[0]];\n        }\n        else if (parsed.length === 2) {\n            return [parsed[0], parsed[1], parsed[0], parsed[1]];\n        }\n        else if (parsed.length === 3) {\n            return [parsed[0], parsed[1], parsed[2], parsed[1]];\n        }\n        else {\n            return [parsed[0], parsed[1], parsed[2], parsed[3]];\n        }\n    }\n}\nfunction parseDimensionArray(string) {\n    if (isString(string)) {\n        // \"1px 2px 3px\"\n        return string.split(' ').map(function (segment) { return parseLengthOrPercentage(segment); });\n    }\n    else {\n        // [1, '2px', 3]\n        return string.map(function (segment) { return parseLengthOrPercentage(segment.toString()); });\n    }\n}\n// export function mergeDimensionList(\n//   left: CSSUnitValue[],\n//   right: CSSUnitValue[],\n//   target: IElement | null,\n// ): [number[], number[], (list: number[]) => string] | undefined {\n//   if (left.length !== right.length) {\n//     return;\n//   }\n//   const unit = left[0].unit;\n//   return [\n//     left.map((l) => l.value),\n//     right.map((l) => l.value),\n//     (values: number[]) => {\n//       return values.map((n) => new CSSUnitValue(n, unit)).join(' ');\n//     },\n//   ];\n// }\nfunction convertPercentUnit(valueWithUnit, vec3Index, target, useMin) {\n    if (useMin === void 0) { useMin = false; }\n    if (valueWithUnit.unit === UnitType.kPixels) {\n        return Number(valueWithUnit.value);\n    }\n    else if (valueWithUnit.unit === UnitType.kPercentage && target) {\n        var bounds = target.nodeName === Shape.GROUP\n            ? target.getLocalBounds()\n            : target.getGeometryBounds();\n        return ((useMin ? bounds.min[vec3Index] : 0) +\n            (valueWithUnit.value / 100) * bounds.halfExtents[vec3Index] * 2);\n    }\n    return 0;\n}\n\nvar parseParam = function (css) {\n    return parseDimension(/deg|rad|grad|turn|px|%/g, css);\n};\nvar supportedFilters = [\n    'blur',\n    'brightness',\n    'drop-shadow',\n    'contrast',\n    'grayscale',\n    'sepia',\n    'saturate',\n    'hue-rotate',\n    'invert',\n];\nfunction parseFilter(filterStr) {\n    if (filterStr === void 0) { filterStr = ''; }\n    filterStr = filterStr.toLowerCase().trim();\n    if (filterStr === 'none') {\n        return [];\n    }\n    var filterRegExp = /\\s*([\\w-]+)\\(([^)]*)\\)/g;\n    var result = [];\n    var match;\n    var prevLastIndex = 0;\n    while ((match = filterRegExp.exec(filterStr))) {\n        if (match.index !== prevLastIndex) {\n            return [];\n        }\n        prevLastIndex = match.index + match[0].length;\n        if (supportedFilters.indexOf(match[1]) > -1) {\n            result.push({\n                name: match[1],\n                params: match[2].split(' ').map(function (p) { return parseParam(p) || parseColor(p); }),\n            });\n        }\n        if (filterRegExp.lastIndex === filterStr.length) {\n            return result;\n        }\n    }\n    return [];\n}\n\nfunction numberToString(x) {\n    // scale(0.00000001) -> scale(0)\n    // return x.toFixed(6).replace(/0+$/, '').replace(/\\.$/, '');\n    return x.toString();\n}\n/**\n * parse string or number to CSSUnitValue(numeric)\n *\n * eg.\n * * 0 -> CSSUnitValue(0)\n * * '2' -> CSSUnitValue(2)\n */\nvar parseNumberUnmemoize = function (string) {\n    if (typeof string === 'number') {\n        return getOrCreateUnitValue(string);\n    }\n    if (/^\\s*[-+]?(\\d*\\.)?\\d+\\s*$/.test(string)) {\n        return getOrCreateUnitValue(Number(string));\n    }\n    else {\n        return getOrCreateUnitValue(0);\n    }\n};\nvar parseNumber = memoize(parseNumberUnmemoize);\nmemoize(function (string) {\n    if (isString(string)) {\n        return string.split(' ').map(parseNumber);\n    }\n    else {\n        return string.map(parseNumber);\n    }\n});\nfunction mergeNumbers(left, right) {\n    return [left, right, numberToString];\n}\nfunction clampedMergeNumbers(min, max) {\n    return function (left, right) { return [\n        left,\n        right,\n        function (x) { return numberToString(clamp(x, min, max)); },\n    ]; };\n}\nfunction mergeNumberLists(left, right) {\n    if (left.length !== right.length) {\n        return;\n    }\n    return [\n        left,\n        right,\n        function (numberList) {\n            return numberList;\n        },\n    ];\n}\n\nfunction getOrCalculatePathTotalLength(path) {\n    if (path.parsedStyle.d.totalLength === 0) {\n        path.parsedStyle.d.totalLength = getTotalLength(path.parsedStyle.d.absolutePath);\n    }\n    return path.parsedStyle.d.totalLength;\n}\nfunction getOrCalculatePolylineTotalLength(polyline) {\n    if (polyline.parsedStyle.points.totalLength === 0) {\n        polyline.parsedStyle.points.totalLength = polylineLength(polyline.parsedStyle.points.points);\n    }\n    return polyline.parsedStyle.points.totalLength;\n}\nfunction removeRedundantMCommand(path) {\n    for (var i = 0; i < path.length; i++) {\n        var prevSegment = path[i - 1];\n        var segment = path[i];\n        var cmd = segment[0];\n        if (cmd === 'M') {\n            if (prevSegment) {\n                var prevCmd = prevSegment[0];\n                var srcPoint = [segment[1], segment[2]];\n                var destPoint = void 0;\n                if (prevCmd === 'L' || prevCmd === 'M') {\n                    destPoint = [prevSegment[1], prevSegment[2]];\n                }\n                else if (prevCmd === 'C' || prevCmd === 'A' || prevCmd === 'Q') {\n                    destPoint = [\n                        prevSegment[prevSegment.length - 2],\n                        prevSegment[prevSegment.length - 1],\n                    ];\n                }\n                if (destPoint && isSamePoint(srcPoint, destPoint)) {\n                    path.splice(i, 1);\n                    i--;\n                }\n            }\n        }\n    }\n}\nfunction hasArcOrBezier(path) {\n    var hasArc = false;\n    var count = path.length;\n    for (var i = 0; i < count; i++) {\n        var params = path[i];\n        var cmd = params[0];\n        if (cmd === 'C' || cmd === 'A' || cmd === 'Q') {\n            hasArc = true;\n            break;\n        }\n    }\n    return hasArc;\n}\nfunction extractPolygons(pathArray) {\n    var polygons = [];\n    var polylines = [];\n    var points = []; // 防止第一个命令不是 'M'\n    for (var i = 0; i < pathArray.length; i++) {\n        var params = pathArray[i];\n        var cmd = params[0];\n        if (cmd === 'M') {\n            // 遇到 'M' 判定是否是新数组，新数组中没有点\n            if (points.length) {\n                // 如果存在点，则说明没有遇到 'Z'，开始了一个新的多边形\n                polylines.push(points);\n                points = []; // 创建新的点\n            }\n            points.push([params[1], params[2]]);\n        }\n        else if (cmd === 'Z') {\n            if (points.length) {\n                // 存在点\n                polygons.push(points);\n                points = []; // 开始新的点集合\n            }\n            // 如果不存在点，同时 'Z'，则说明是错误，不处理\n        }\n        else {\n            points.push([params[1], params[2]]);\n        }\n    }\n    // 说明 points 未放入 polygons 或者 polyline\n    // 仅当只有一个 M，没有 Z 时会发生这种情况\n    if (points.length > 0) {\n        polylines.push(points);\n    }\n    return {\n        polygons: polygons,\n        polylines: polylines,\n    };\n}\nfunction isSamePoint(point1, point2) {\n    return point1[0] === point2[0] && point1[1] === point2[1];\n}\nfunction getPathBBox(segments, lineWidth) {\n    var xArr = [];\n    var yArr = [];\n    var segmentsWithAngle = [];\n    for (var i = 0; i < segments.length; i++) {\n        var segment = segments[i];\n        var currentPoint = segment.currentPoint, params = segment.params, prePoint = segment.prePoint;\n        var box = void 0;\n        switch (segment.command) {\n            case 'Q':\n                box = quadBox(prePoint[0], prePoint[1], params[1], params[2], params[3], params[4]);\n                break;\n            case 'C':\n                box = cubicBox(prePoint[0], prePoint[1], params[1], params[2], params[3], params[4], params[5], params[6]);\n                break;\n            case 'A':\n                var arcParams = segment.arcParams;\n                box = arcBox(arcParams.cx, arcParams.cy, arcParams.rx, arcParams.ry, arcParams.xRotation, arcParams.startAngle, arcParams.endAngle);\n                break;\n            default:\n                xArr.push(currentPoint[0]);\n                yArr.push(currentPoint[1]);\n                break;\n        }\n        if (box) {\n            segment.box = box;\n            xArr.push(box.x, box.x + box.width);\n            yArr.push(box.y, box.y + box.height);\n        }\n        if (lineWidth &&\n            (segment.command === 'L' || segment.command === 'M') &&\n            segment.prePoint &&\n            segment.nextPoint) {\n            segmentsWithAngle.push(segment);\n        }\n    }\n    // bbox calculation should ignore NaN for path attribute\n    // ref: https://github.com/antvis/g/issues/210\n    // ref: https://github.com/antvis/G2/issues/3109\n    xArr = xArr.filter(function (item) { return !Number.isNaN(item) && item !== Infinity && item !== -Infinity; });\n    yArr = yArr.filter(function (item) { return !Number.isNaN(item) && item !== Infinity && item !== -Infinity; });\n    var minX = min(xArr);\n    var minY = min(yArr);\n    var maxX = max(xArr);\n    var maxY = max(yArr);\n    if (segmentsWithAngle.length === 0) {\n        return {\n            x: minX,\n            y: minY,\n            width: maxX - minX,\n            height: maxY - minY,\n        };\n    }\n    for (var i = 0; i < segmentsWithAngle.length; i++) {\n        var segment = segmentsWithAngle[i];\n        var currentPoint = segment.currentPoint;\n        var extra = void 0;\n        if (currentPoint[0] === minX) {\n            extra = getExtraFromSegmentWithAngle(segment, lineWidth);\n            minX = minX - extra.xExtra;\n        }\n        else if (currentPoint[0] === maxX) {\n            extra = getExtraFromSegmentWithAngle(segment, lineWidth);\n            maxX = maxX + extra.xExtra;\n        }\n        if (currentPoint[1] === minY) {\n            extra = getExtraFromSegmentWithAngle(segment, lineWidth);\n            minY = minY - extra.yExtra;\n        }\n        else if (currentPoint[1] === maxY) {\n            extra = getExtraFromSegmentWithAngle(segment, lineWidth);\n            maxY = maxY + extra.yExtra;\n        }\n    }\n    return {\n        x: minX,\n        y: minY,\n        width: maxX - minX,\n        height: maxY - minY,\n    };\n}\nfunction getExtraFromSegmentWithAngle(segment, lineWidth) {\n    var prePoint = segment.prePoint, currentPoint = segment.currentPoint, nextPoint = segment.nextPoint;\n    var currentAndPre = Math.pow(currentPoint[0] - prePoint[0], 2) +\n        Math.pow(currentPoint[1] - prePoint[1], 2);\n    var currentAndNext = Math.pow(currentPoint[0] - nextPoint[0], 2) +\n        Math.pow(currentPoint[1] - nextPoint[1], 2);\n    var preAndNext = Math.pow(prePoint[0] - nextPoint[0], 2) +\n        Math.pow(prePoint[1] - nextPoint[1], 2);\n    // 以 currentPoint 为顶点的夹角\n    var currentAngle = Math.acos((currentAndPre + currentAndNext - preAndNext) /\n        (2 * Math.sqrt(currentAndPre) * Math.sqrt(currentAndNext)));\n    // 夹角为空、 0 或 PI 时，不需要计算夹角处的额外宽度\n    // 注意: 由于计算精度问题，夹角为 0 的情况计算出来的角度可能是一个很小的值，还需要判断其与 0 是否近似相等\n    if (!currentAngle ||\n        Math.sin(currentAngle) === 0 ||\n        isNumberEqual(currentAngle, 0)) {\n        return {\n            xExtra: 0,\n            yExtra: 0,\n        };\n    }\n    var xAngle = Math.abs(Math.atan2(nextPoint[1] - currentPoint[1], nextPoint[0] - currentPoint[0]));\n    var yAngle = Math.abs(Math.atan2(nextPoint[0] - currentPoint[0], nextPoint[1] - currentPoint[1]));\n    // 将夹角转为锐角\n    xAngle = xAngle > Math.PI / 2 ? Math.PI - xAngle : xAngle;\n    yAngle = yAngle > Math.PI / 2 ? Math.PI - yAngle : yAngle;\n    // 这里不考虑在水平和垂直方向的投影，直接使用最大差值\n    // 由于上层统一加减了二分之一线宽，这里需要进行弥补\n    var extra = {\n        // 水平方向投影\n        xExtra: Math.cos(currentAngle / 2 - xAngle) *\n            ((lineWidth / 2) * (1 / Math.sin(currentAngle / 2))) -\n            lineWidth / 2 || 0,\n        // 垂直方向投影\n        yExtra: Math.cos(yAngle - currentAngle / 2) *\n            ((lineWidth / 2) * (1 / Math.sin(currentAngle / 2))) -\n            lineWidth / 2 || 0,\n    };\n    return extra;\n}\n// 点对称\nfunction toSymmetry(point, center) {\n    return [\n        center[0] + (center[0] - point[0]),\n        center[1] + (center[1] - point[1]),\n    ];\n}\nvar angleBetween = function (v0, v1) {\n    var p = v0.x * v1.x + v0.y * v1.y;\n    var n = Math.sqrt((Math.pow(v0.x, 2) + Math.pow(v0.y, 2)) *\n        (Math.pow(v1.x, 2) + Math.pow(v1.y, 2)));\n    var sign = v0.x * v1.y - v0.y * v1.x < 0 ? -1 : 1;\n    var angle = sign * Math.acos(p / n);\n    return angle;\n};\n/**\n * @see https://github.com/rveciana/svg-path-properties/blob/b6bd9a322966f6ef7a311872d80c56e3718de861/src/arc.ts#L121\n */\nvar pointOnEllipticalArc = function (p0, rx, ry, xAxisRotation, largeArcFlag, sweepFlag, p1, t) {\n    // In accordance to: http://www.w3.org/TR/SVG/implnote.html#ArcOutOfRangeParameters\n    rx = Math.abs(rx);\n    ry = Math.abs(ry);\n    xAxisRotation = mod(xAxisRotation, 360);\n    var xAxisRotationRadians = deg2rad(xAxisRotation);\n    // If the endpoints are identical, then this is equivalent to omitting the elliptical arc segment entirely.\n    if (p0.x === p1.x && p0.y === p1.y) {\n        return { x: p0.x, y: p0.y, ellipticalArcAngle: 0 }; // Check if angle is correct\n    }\n    // If rx = 0 or ry = 0 then this arc is treated as a straight line segment joining the endpoints.\n    if (rx === 0 || ry === 0) {\n        //return this.pointOnLine(p0, p1, t);\n        return { x: 0, y: 0, ellipticalArcAngle: 0 }; // Check if angle is correct\n    }\n    // Following \"Conversion from endpoint to center parameterization\"\n    // http://www.w3.org/TR/SVG/implnote.html#ArcConversionEndpointToCenter\n    // Step #1: Compute transformedPoint\n    var dx = (p0.x - p1.x) / 2;\n    var dy = (p0.y - p1.y) / 2;\n    var transformedPoint = {\n        x: Math.cos(xAxisRotationRadians) * dx + Math.sin(xAxisRotationRadians) * dy,\n        y: -Math.sin(xAxisRotationRadians) * dx +\n            Math.cos(xAxisRotationRadians) * dy,\n    };\n    // Ensure radii are large enough\n    var radiiCheck = Math.pow(transformedPoint.x, 2) / Math.pow(rx, 2) +\n        Math.pow(transformedPoint.y, 2) / Math.pow(ry, 2);\n    if (radiiCheck > 1) {\n        rx = Math.sqrt(radiiCheck) * rx;\n        ry = Math.sqrt(radiiCheck) * ry;\n    }\n    // Step #2: Compute transformedCenter\n    var cSquareNumerator = Math.pow(rx, 2) * Math.pow(ry, 2) -\n        Math.pow(rx, 2) * Math.pow(transformedPoint.y, 2) -\n        Math.pow(ry, 2) * Math.pow(transformedPoint.x, 2);\n    var cSquareRootDenom = Math.pow(rx, 2) * Math.pow(transformedPoint.y, 2) +\n        Math.pow(ry, 2) * Math.pow(transformedPoint.x, 2);\n    var cRadicand = cSquareNumerator / cSquareRootDenom;\n    // Make sure this never drops below zero because of precision\n    cRadicand = cRadicand < 0 ? 0 : cRadicand;\n    var cCoef = (largeArcFlag !== sweepFlag ? 1 : -1) * Math.sqrt(cRadicand);\n    var transformedCenter = {\n        x: cCoef * ((rx * transformedPoint.y) / ry),\n        y: cCoef * (-(ry * transformedPoint.x) / rx),\n    };\n    // Step #3: Compute center\n    var center = {\n        x: Math.cos(xAxisRotationRadians) * transformedCenter.x -\n            Math.sin(xAxisRotationRadians) * transformedCenter.y +\n            (p0.x + p1.x) / 2,\n        y: Math.sin(xAxisRotationRadians) * transformedCenter.x +\n            Math.cos(xAxisRotationRadians) * transformedCenter.y +\n            (p0.y + p1.y) / 2,\n    };\n    // Step #4: Compute start/sweep angles\n    // Start angle of the elliptical arc prior to the stretch and rotate operations.\n    // Difference between the start and end angles\n    var startVector = {\n        x: (transformedPoint.x - transformedCenter.x) / rx,\n        y: (transformedPoint.y - transformedCenter.y) / ry,\n    };\n    var startAngle = angleBetween({\n        x: 1,\n        y: 0,\n    }, startVector);\n    var endVector = {\n        x: (-transformedPoint.x - transformedCenter.x) / rx,\n        y: (-transformedPoint.y - transformedCenter.y) / ry,\n    };\n    var sweepAngle = angleBetween(startVector, endVector);\n    if (!sweepFlag && sweepAngle > 0) {\n        sweepAngle -= 2 * Math.PI;\n    }\n    else if (sweepFlag && sweepAngle < 0) {\n        sweepAngle += 2 * Math.PI;\n    }\n    // We use % instead of `mod(..)` because we want it to be -360deg to 360deg(but actually in radians)\n    sweepAngle %= 2 * Math.PI;\n    // From http://www.w3.org/TR/SVG/implnote.html#ArcParameterizationAlternatives\n    var angle = startAngle + sweepAngle * t;\n    var ellipseComponentX = rx * Math.cos(angle);\n    var ellipseComponentY = ry * Math.sin(angle);\n    var point = {\n        x: Math.cos(xAxisRotationRadians) * ellipseComponentX -\n            Math.sin(xAxisRotationRadians) * ellipseComponentY +\n            center.x,\n        y: Math.sin(xAxisRotationRadians) * ellipseComponentX +\n            Math.cos(xAxisRotationRadians) * ellipseComponentY +\n            center.y,\n        ellipticalArcStartAngle: startAngle,\n        ellipticalArcEndAngle: startAngle + sweepAngle,\n        ellipticalArcAngle: angle,\n        ellipticalArcCenter: center,\n        resultantRx: rx,\n        resultantRy: ry,\n    };\n    return point;\n};\nfunction path2Segments(path) {\n    var segments = [];\n    var currentPoint = null; // 当前图形\n    var nextParams = null; // 下一节点的 path 参数\n    var startMovePoint = null; // 开始 M 的点，可能会有多个\n    var lastStartMovePointIndex = 0; // 最近一个开始点 M 的索引\n    var count = path.length;\n    for (var i = 0; i < count; i++) {\n        var params = path[i];\n        nextParams = path[i + 1];\n        var command = params[0];\n        // 数学定义上的参数，便于后面的计算\n        var segment = {\n            command: command,\n            prePoint: currentPoint,\n            params: params,\n            startTangent: null,\n            endTangent: null,\n            currentPoint: null,\n            nextPoint: null,\n            arcParams: null,\n            box: null,\n            cubicParams: null,\n        };\n        switch (command) {\n            case 'M':\n                startMovePoint = [params[1], params[2]];\n                lastStartMovePointIndex = i;\n                break;\n            case 'A':\n                var arcParams = getArcParams(currentPoint, params);\n                segment.arcParams = arcParams;\n                break;\n        }\n        if (command === 'Z') {\n            // 有了 Z 后，当前节点从开始 M 的点开始\n            currentPoint = startMovePoint;\n            // 如果当前点的命令为 Z，相当于当前点为最近一个 M 点，则下一个点直接指向最近一个 M 点的下一个点\n            nextParams = path[lastStartMovePointIndex + 1];\n        }\n        else {\n            var len = params.length;\n            currentPoint = [params[len - 2], params[len - 1]];\n        }\n        if (nextParams && nextParams[0] === 'Z') {\n            // 如果下一个点的命令为 Z，则下一个点直接指向最近一个 M 点\n            nextParams = path[lastStartMovePointIndex];\n            if (segments[lastStartMovePointIndex]) {\n                // 如果下一个点的命令为 Z，则最近一个 M 点的前一个点为当前点\n                segments[lastStartMovePointIndex].prePoint = currentPoint;\n            }\n        }\n        segment.currentPoint = currentPoint;\n        // 如果当前点与最近一个 M 点相同，则最近一个 M 点的前一个点为当前点的前一个点\n        if (segments[lastStartMovePointIndex] &&\n            isSamePoint(currentPoint, segments[lastStartMovePointIndex].currentPoint)) {\n            segments[lastStartMovePointIndex].prePoint = segment.prePoint;\n        }\n        var nextPoint = nextParams\n            ? [nextParams[nextParams.length - 2], nextParams[nextParams.length - 1]]\n            : null;\n        segment.nextPoint = nextPoint;\n        // Add startTangent and endTangent\n        var prePoint = segment.prePoint;\n        if (['L', 'H', 'V'].includes(command)) {\n            segment.startTangent = [\n                prePoint[0] - currentPoint[0],\n                prePoint[1] - currentPoint[1],\n            ];\n            segment.endTangent = [\n                currentPoint[0] - prePoint[0],\n                currentPoint[1] - prePoint[1],\n            ];\n        }\n        else if (command === 'Q') {\n            // 二次贝塞尔曲线只有一个控制点\n            var cp = [params[1], params[2]];\n            // 二次贝塞尔曲线的终点为 currentPoint\n            segment.startTangent = [prePoint[0] - cp[0], prePoint[1] - cp[1]];\n            segment.endTangent = [currentPoint[0] - cp[0], currentPoint[1] - cp[1]];\n        }\n        else if (command === 'T') {\n            var preSegment = segments[i - 1];\n            var cp = toSymmetry(preSegment.currentPoint, prePoint);\n            if (preSegment.command === 'Q') {\n                segment.command = 'Q';\n                segment.startTangent = [prePoint[0] - cp[0], prePoint[1] - cp[1]];\n                segment.endTangent = [currentPoint[0] - cp[0], currentPoint[1] - cp[1]];\n            }\n            else {\n                // @ts-ignore\n                segment.command = 'TL';\n                segment.startTangent = [\n                    prePoint[0] - currentPoint[0],\n                    prePoint[1] - currentPoint[1],\n                ];\n                segment.endTangent = [\n                    currentPoint[0] - prePoint[0],\n                    currentPoint[1] - prePoint[1],\n                ];\n            }\n        }\n        else if (command === 'C') {\n            // 三次贝塞尔曲线有两个控制点\n            var cp1 = [params[1], params[2]];\n            var cp2 = [params[3], params[4]];\n            segment.startTangent = [prePoint[0] - cp1[0], prePoint[1] - cp1[1]];\n            segment.endTangent = [currentPoint[0] - cp2[0], currentPoint[1] - cp2[1]];\n            // horizontal line, eg. ['C', 100, 100, 100, 100, 200, 200]\n            if (segment.startTangent[0] === 0 && segment.startTangent[1] === 0) {\n                segment.startTangent = [cp1[0] - cp2[0], cp1[1] - cp2[1]];\n            }\n            if (segment.endTangent[0] === 0 && segment.endTangent[1] === 0) {\n                segment.endTangent = [cp2[0] - cp1[0], cp2[1] - cp1[1]];\n            }\n        }\n        else if (command === 'S') {\n            var preSegment = segments[i - 1];\n            var cp1 = toSymmetry(preSegment.currentPoint, prePoint);\n            var cp2 = [params[1], params[2]];\n            if (preSegment.command === 'C') {\n                segment.command = 'C'; // 将 S 命令变换为 C 命令\n                segment.startTangent = [prePoint[0] - cp1[0], prePoint[1] - cp1[1]];\n                segment.endTangent = [\n                    currentPoint[0] - cp2[0],\n                    currentPoint[1] - cp2[1],\n                ];\n            }\n            else {\n                // @ts-ignore\n                segment.command = 'SQ'; // 将 S 命令变换为 SQ 命令\n                segment.startTangent = [prePoint[0] - cp2[0], prePoint[1] - cp2[1]];\n                segment.endTangent = [\n                    currentPoint[0] - cp2[0],\n                    currentPoint[1] - cp2[1],\n                ];\n            }\n        }\n        else if (command === 'A') {\n            var _a = getTangentAtRatio(segment, 0), dx1 = _a.x, dy1 = _a.y;\n            var _b = getTangentAtRatio(segment, 1, false), dx2 = _b.x, dy2 = _b.y;\n            segment.startTangent = [dx1, dy1];\n            segment.endTangent = [dx2, dy2];\n        }\n        segments.push(segment);\n    }\n    return segments;\n}\n/**\n * Use length instead of ratio\n */\nfunction getTangentAtRatio(segment, ratio, sign) {\n    if (sign === void 0) { sign = true; }\n    var _a = segment.arcParams, _b = _a.rx, rx = _b === void 0 ? 0 : _b, _c = _a.ry, ry = _c === void 0 ? 0 : _c, xRotation = _a.xRotation, arcFlag = _a.arcFlag, sweepFlag = _a.sweepFlag;\n    var p1 = pointOnEllipticalArc({ x: segment.prePoint[0], y: segment.prePoint[1] }, rx, ry, xRotation, !!arcFlag, !!sweepFlag, { x: segment.currentPoint[0], y: segment.currentPoint[1] }, ratio);\n    var p2 = pointOnEllipticalArc({ x: segment.prePoint[0], y: segment.prePoint[1] }, rx, ry, xRotation, !!arcFlag, !!sweepFlag, { x: segment.currentPoint[0], y: segment.currentPoint[1] }, sign ? ratio + 0.005 : ratio - 0.005);\n    var xDist = p2.x - p1.x;\n    var yDist = p2.y - p1.y;\n    var dist = Math.sqrt(xDist * xDist + yDist * yDist);\n    return { x: -xDist / dist, y: -yDist / dist };\n}\n// 向量长度\nfunction vMag(v) {\n    return Math.sqrt(v[0] * v[0] + v[1] * v[1]);\n}\n// u.v/|u||v|，计算夹角的余弦值\nfunction vRatio(u, v) {\n    // 当存在一个向量的长度为 0 时，夹角也为 0，即夹角的余弦值为 1\n    return vMag(u) * vMag(v)\n        ? (u[0] * v[0] + u[1] * v[1]) / (vMag(u) * vMag(v))\n        : 1;\n}\n// 向量角度\nfunction vAngle(u, v) {\n    return (u[0] * v[1] < u[1] * v[0] ? -1 : 1) * Math.acos(vRatio(u, v));\n}\nfunction getArcParams(startPoint, params) {\n    var rx = params[1];\n    var ry = params[2];\n    var xRotation = mod(deg2rad(params[3]), Math.PI * 2);\n    var arcFlag = params[4];\n    var sweepFlag = params[5];\n    // 弧形起点坐标\n    var x1 = startPoint[0];\n    var y1 = startPoint[1];\n    // 弧形终点坐标\n    var x2 = params[6];\n    var y2 = params[7];\n    var xp = (Math.cos(xRotation) * (x1 - x2)) / 2.0 +\n        (Math.sin(xRotation) * (y1 - y2)) / 2.0;\n    var yp = (-1 * Math.sin(xRotation) * (x1 - x2)) / 2.0 +\n        (Math.cos(xRotation) * (y1 - y2)) / 2.0;\n    var lambda = (xp * xp) / (rx * rx) + (yp * yp) / (ry * ry);\n    if (lambda > 1) {\n        rx *= Math.sqrt(lambda);\n        ry *= Math.sqrt(lambda);\n    }\n    var diff = rx * rx * (yp * yp) + ry * ry * (xp * xp);\n    var f = diff ? Math.sqrt((rx * rx * (ry * ry) - diff) / diff) : 1;\n    if (arcFlag === sweepFlag) {\n        f *= -1;\n    }\n    if (isNaN(f)) {\n        f = 0;\n    }\n    // 旋转前的起点坐标，且当长半轴和短半轴的长度为 0 时，坐标按 (0, 0) 处理\n    var cxp = ry ? (f * rx * yp) / ry : 0;\n    var cyp = rx ? (f * -ry * xp) / rx : 0;\n    // 椭圆圆心坐标\n    var cx = (x1 + x2) / 2.0 + Math.cos(xRotation) * cxp - Math.sin(xRotation) * cyp;\n    var cy = (y1 + y2) / 2.0 + Math.sin(xRotation) * cxp + Math.cos(xRotation) * cyp;\n    // 起始点的单位向量\n    var u = [(xp - cxp) / rx, (yp - cyp) / ry];\n    // 终止点的单位向量\n    var v = [(-1 * xp - cxp) / rx, (-1 * yp - cyp) / ry];\n    // 计算起始点和圆心的连线，与 x 轴正方向的夹角\n    var theta = vAngle([1, 0], u);\n    // 计算圆弧起始点和终止点与椭圆圆心连线的夹角\n    var dTheta = vAngle(u, v);\n    if (vRatio(u, v) <= -1) {\n        dTheta = Math.PI;\n    }\n    if (vRatio(u, v) >= 1) {\n        dTheta = 0;\n    }\n    if (sweepFlag === 0 && dTheta > 0) {\n        dTheta = dTheta - 2 * Math.PI;\n    }\n    if (sweepFlag === 1 && dTheta < 0) {\n        dTheta = dTheta + 2 * Math.PI;\n    }\n    return {\n        cx: cx,\n        cy: cy,\n        // 弧形的起点和终点相同时，长轴和短轴的长度按 0 处理\n        rx: isSamePoint(startPoint, [x2, y2]) ? 0 : rx,\n        ry: isSamePoint(startPoint, [x2, y2]) ? 0 : ry,\n        startAngle: theta,\n        endAngle: theta + dTheta,\n        xRotation: xRotation,\n        arcFlag: arcFlag,\n        sweepFlag: sweepFlag,\n    };\n}\nfunction commandsToPathString(commands, object, transform) {\n    return commands.reduce(function (prev, cur) {\n        var path = '';\n        if (cur[0] === 'M' || cur[0] === 'L') {\n            var p = vec3.fromValues(cur[1], cur[2], 0);\n            if (transform) {\n                vec3.transformMat4(p, p, transform);\n            }\n            path = \"\".concat(cur[0]).concat(p[0], \",\").concat(p[1]);\n        }\n        else if (cur[0] === 'Z') {\n            path = cur[0];\n        }\n        else if (cur[0] === 'C') {\n            var p1 = vec3.fromValues(cur[1], cur[2], 0);\n            var p2 = vec3.fromValues(cur[3], cur[4], 0);\n            var p3 = vec3.fromValues(cur[5], cur[6], 0);\n            if (transform) {\n                vec3.transformMat4(p1, p1, transform);\n                vec3.transformMat4(p2, p2, transform);\n                vec3.transformMat4(p3, p3, transform);\n            }\n            path = \"\".concat(cur[0]).concat(p1[0], \",\").concat(p1[1], \",\").concat(p2[0], \",\").concat(p2[1], \",\").concat(p3[0], \",\").concat(p3[1]);\n        }\n        else if (cur[0] === 'A') {\n            var c = vec3.fromValues(cur[6], cur[7], 0);\n            if (transform) {\n                vec3.transformMat4(c, c, transform);\n            }\n            path = \"\".concat(cur[0]).concat(cur[1], \",\").concat(cur[2], \",\").concat(cur[3], \",\").concat(cur[4], \",\").concat(cur[5], \",\").concat(c[0], \",\").concat(c[1]);\n        }\n        else if (cur[0] === 'Q') {\n            var p1 = vec3.fromValues(cur[1], cur[2], 0);\n            var p2 = vec3.fromValues(cur[3], cur[4], 0);\n            if (transform) {\n                vec3.transformMat4(p1, p1, transform);\n                vec3.transformMat4(p2, p2, transform);\n            }\n            path = \"\".concat(cur[0]).concat(cur[1], \",\").concat(cur[2], \",\").concat(cur[3], \",\").concat(cur[4], \"}\");\n        }\n        return (prev += path);\n    }, '');\n}\nfunction lineToCommands(x1, y1, x2, y2) {\n    return [\n        ['M', x1, y1],\n        ['L', x2, y2],\n    ];\n}\nfunction ellipseToCommands(rx, ry, cx, cy) {\n    var factor = ((-1 + Math.sqrt(2)) / 3) * 4;\n    var dx = rx * factor;\n    var dy = ry * factor;\n    var left = cx - rx;\n    var right = cx + rx;\n    var top = cy - ry;\n    var bottom = cy + ry;\n    return [\n        ['M', left, cy],\n        ['C', left, cy - dy, cx - dx, top, cx, top],\n        ['C', cx + dx, top, right, cy - dy, right, cy],\n        ['C', right, cy + dy, cx + dx, bottom, cx, bottom],\n        ['C', cx - dx, bottom, left, cy + dy, left, cy],\n        ['Z'],\n    ];\n}\nfunction polygonToCommands(points, closed) {\n    var result = points.map(function (point, i) {\n        return [i === 0 ? 'M' : 'L', point[0], point[1]];\n    });\n    if (closed) {\n        result.push(['Z']);\n    }\n    return result;\n}\nfunction rectToCommands(width, height, x, y, radius) {\n    // @see https://gist.github.com/danielpquinn/dd966af424030d47e476\n    if (radius) {\n        var _a = __read(radius, 4), tlr = _a[0], trr = _a[1], brr = _a[2], blr = _a[3];\n        var signX = width > 0 ? 1 : -1;\n        var signY = height > 0 ? 1 : -1;\n        // sweep-flag @see https://developer.mozilla.org/zh-CN/docs/Web/SVG/Tutorial/Paths#arcs\n        var sweepFlag = signX + signY !== 0 ? 1 : 0;\n        return [\n            ['M', signX * tlr + x, y],\n            ['L', width - signX * trr + x, y],\n            trr ? ['A', trr, trr, 0, 0, sweepFlag, width + x, signY * trr + y] : null,\n            ['L', width + x, height - signY * brr + y],\n            brr\n                ? ['A', brr, brr, 0, 0, sweepFlag, width + x - signX * brr, height + y]\n                : null,\n            ['L', x + signX * blr, height + y],\n            blr\n                ? ['A', blr, blr, 0, 0, sweepFlag, x, height + y - signY * blr]\n                : null,\n            ['L', x, signY * tlr + y],\n            tlr ? ['A', tlr, tlr, 0, 0, sweepFlag, signX * tlr + x, y] : null,\n            ['Z'],\n        ].filter(function (command) { return command; });\n    }\n    return [\n        ['M', x, y],\n        ['L', x + width, y],\n        ['L', x + width, y + height],\n        ['L', x, y + height],\n        ['Z'],\n    ];\n}\n/**\n * convert object to path, should account for:\n * * transform & origin\n * * lineWidth\n */\nfunction convertToPath(object, transform) {\n    if (transform === void 0) { transform = object.getLocalTransform(); }\n    var commands = [];\n    switch (object.nodeName) {\n        case Shape.LINE:\n            var _a = object.parsedStyle, _b = _a.x1, x1 = _b === void 0 ? 0 : _b, _c = _a.y1, y1 = _c === void 0 ? 0 : _c, _d = _a.x2, x2 = _d === void 0 ? 0 : _d, _e = _a.y2, y2 = _e === void 0 ? 0 : _e;\n            commands = lineToCommands(x1, y1, x2, y2);\n            break;\n        case Shape.CIRCLE: {\n            var _f = object.parsedStyle, _g = _f.r, r = _g === void 0 ? 0 : _g, _h = _f.cx, cx = _h === void 0 ? 0 : _h, _j = _f.cy, cy = _j === void 0 ? 0 : _j;\n            commands = ellipseToCommands(r, r, cx, cy);\n            break;\n        }\n        case Shape.ELLIPSE: {\n            var _k = object.parsedStyle, _l = _k.rx, rx = _l === void 0 ? 0 : _l, _m = _k.ry, ry = _m === void 0 ? 0 : _m, _o = _k.cx, cx = _o === void 0 ? 0 : _o, _p = _k.cy, cy = _p === void 0 ? 0 : _p;\n            commands = ellipseToCommands(rx, ry, cx, cy);\n            break;\n        }\n        case Shape.POLYLINE:\n        case Shape.POLYGON:\n            var points = object.parsedStyle.points;\n            commands = polygonToCommands(points.points, object.nodeName === Shape.POLYGON);\n            break;\n        case Shape.RECT:\n            var _q = object.parsedStyle, _r = _q.width, width_1 = _r === void 0 ? 0 : _r, _s = _q.height, height_1 = _s === void 0 ? 0 : _s, _t = _q.x, x = _t === void 0 ? 0 : _t, _u = _q.y, y = _u === void 0 ? 0 : _u, radius = _q.radius;\n            var hasRadius = radius && radius.some(function (r) { return r !== 0; });\n            commands = rectToCommands(width_1, height_1, x, y, hasRadius &&\n                radius.map(function (r) {\n                    return clamp(r, 0, Math.min(Math.abs(width_1) / 2, Math.abs(height_1) / 2));\n                }));\n            break;\n        case Shape.PATH:\n            var absolutePath = object.parsedStyle.d.absolutePath;\n            commands = __spreadArray([], __read(absolutePath), false);\n            break;\n    }\n    if (commands.length) {\n        return commandsToPathString(commands, object, transform);\n    }\n}\nfunction translatePathToString(absolutePath, startOffsetX, startOffsetY, endOffsetX, endOffsetY) {\n    if (startOffsetX === void 0) { startOffsetX = 0; }\n    if (startOffsetY === void 0) { startOffsetY = 0; }\n    if (endOffsetX === void 0) { endOffsetX = 0; }\n    if (endOffsetY === void 0) { endOffsetY = 0; }\n    var newValue = absolutePath\n        .map(function (params, i) {\n        var command = params[0];\n        var nextSegment = absolutePath[i + 1];\n        var useStartOffset = i === 0 && (startOffsetX !== 0 || startOffsetY !== 0);\n        var useEndOffset = (i === absolutePath.length - 1 ||\n            (nextSegment &&\n                (nextSegment[0] === 'M' || nextSegment[0] === 'Z'))) &&\n            endOffsetX !== 0 &&\n            endOffsetY !== 0;\n        switch (command) {\n            case 'M':\n                // Use start marker offset\n                if (useStartOffset) {\n                    return \"M \".concat(params[1] + startOffsetX, \",\").concat(params[2] + startOffsetY, \" L \").concat(params[1], \",\").concat(params[2]);\n                }\n                else {\n                    return \"M \".concat(params[1], \",\").concat(params[2]);\n                }\n            case 'L':\n                return \"L \".concat(params[1] + (useEndOffset ? endOffsetX : 0), \",\").concat(params[2] + (useEndOffset ? endOffsetY : 0));\n            case 'Q':\n                return (\"Q \".concat(params[1], \" \").concat(params[2], \",\").concat(params[3], \" \").concat(params[4]) +\n                    (useEndOffset\n                        ? \" L \".concat(params[3] + endOffsetX, \",\").concat(params[4] + endOffsetY)\n                        : ''));\n            case 'C':\n                return (\"C \".concat(params[1], \" \").concat(params[2], \",\").concat(params[3], \" \").concat(params[4], \",\").concat(params[5], \" \").concat(params[6]) +\n                    (useEndOffset\n                        ? \" L \".concat(params[5] + endOffsetX, \",\").concat(params[6] + endOffsetY)\n                        : ''));\n            case 'A':\n                return (\"A \".concat(params[1], \" \").concat(params[2], \" \").concat(params[3], \" \").concat(params[4], \" \").concat(params[5], \" \").concat(params[6], \" \").concat(params[7]) +\n                    (useEndOffset\n                        ? \" L \".concat(params[6] + endOffsetX, \",\").concat(params[7] + endOffsetY)\n                        : ''));\n            case 'Z':\n                return 'Z';\n        }\n    })\n        .join(' ');\n    if (~newValue.indexOf('NaN')) {\n        return '';\n    }\n    return newValue;\n}\n\nvar internalParsePath = function (path) {\n    // empty path\n    if (path === '' || (Array.isArray(path) && path.length === 0)) {\n        return {\n            absolutePath: [],\n            hasArc: false,\n            segments: [],\n            polygons: [],\n            polylines: [],\n            curve: null,\n            totalLength: 0,\n            rect: {\n                x: 0,\n                y: 0,\n                width: 0,\n                height: 0,\n            },\n        };\n    }\n    var absolutePath;\n    try {\n        absolutePath = normalizePath(path);\n    }\n    catch (e) {\n        absolutePath = normalizePath('');\n        console.error(\"[g]: Invalid SVG Path definition: \".concat(path));\n    }\n    removeRedundantMCommand(absolutePath);\n    var hasArc = hasArcOrBezier(absolutePath);\n    var _a = extractPolygons(absolutePath), polygons = _a.polygons, polylines = _a.polylines;\n    // for later use\n    var segments = path2Segments(absolutePath);\n    // Only calculate bbox here since we don't need length now.\n    var _b = getPathBBox(segments, 0), x = _b.x, y = _b.y, width = _b.width, height = _b.height;\n    return {\n        absolutePath: absolutePath,\n        hasArc: hasArc,\n        segments: segments,\n        polygons: polygons,\n        polylines: polylines,\n        // curve,\n        // Delay the calculation of length.\n        totalLength: 0,\n        rect: {\n            x: Number.isFinite(x) ? x : 0,\n            y: Number.isFinite(y) ? y : 0,\n            width: Number.isFinite(width) ? width : 0,\n            height: Number.isFinite(height) ? height : 0,\n        },\n    };\n};\nvar memoizedParsePath = memoize(internalParsePath);\nfunction parsePath(path) {\n    return (isString(path) ? memoizedParsePath(path) : internalParsePath(path));\n}\nfunction mergePaths(left, right, object) {\n    var curve1 = left.curve;\n    var curve2 = right.curve;\n    if (!curve1 || curve1.length === 0) {\n        // convert to curves to do morphing & picking later\n        // @see http://thednp.github.io/kute.js/svgCubicMorph.html\n        curve1 = path2Curve(left.absolutePath, false);\n        left.curve = curve1;\n    }\n    if (!curve2 || curve2.length === 0) {\n        curve2 = path2Curve(right.absolutePath, false);\n        right.curve = curve2;\n    }\n    var curves = [curve1, curve2];\n    if (curve1.length !== curve2.length) {\n        curves = equalizeSegments(curve1, curve2);\n    }\n    var curve0 = getDrawDirection(curves[0]) !== getDrawDirection(curves[1])\n        ? reverseCurve(curves[0])\n        : clonePath(curves[0]);\n    return [\n        curve0,\n        getRotatedCurve(curves[1], curve0),\n        function (pathArray) {\n            // need converting to path string?\n            return pathArray;\n        },\n    ];\n}\n\n/**\n * @see https://developer.mozilla.org/zh-CN/docs/Web/SVG/Attribute/points\n *\n * @example\n * points=\"100,10 250,150 200,110\"\n */\nfunction parsePoints(pointsOrStr, object) {\n    var points;\n    if (isString(pointsOrStr)) {\n        points = pointsOrStr.split(' ').map(function (pointStr) {\n            var _a = __read(pointStr.split(','), 2), x = _a[0], y = _a[1];\n            return [Number(x), Number(y)];\n        });\n    }\n    else {\n        points = pointsOrStr;\n    }\n    return {\n        points: points,\n        totalLength: 0,\n        segments: [],\n    };\n}\nfunction mergePoints(left, right) {\n    return [\n        left.points,\n        right.points,\n        function (points) {\n            return points;\n        },\n    ];\n}\n\nvar _ = null;\nfunction cast(pattern) {\n    return function (contents) {\n        var i = 0;\n        return pattern.map(function (x) {\n            return x === _ ? contents[i++] : x;\n        });\n    };\n}\nfunction id(x) {\n    return x;\n}\n// type: [argTypes, convertTo3D, convertTo2D]\n// In the argument types string, lowercase characters represent optional arguments\nvar transformFunctions = {\n    // @ts-ignore\n    matrix: ['NNNNNN', [_, _, 0, 0, _, _, 0, 0, 0, 0, 1, 0, _, _, 0, 1], id],\n    matrix3d: ['NNNNNNNNNNNNNNNN', id],\n    rotate: ['A'],\n    rotatex: ['A'],\n    rotatey: ['A'],\n    rotatez: ['A'],\n    rotate3d: ['NNNA'],\n    perspective: ['L'],\n    scale: ['Nn', cast([_, _, new CSSUnitValue(1)]), id],\n    scalex: [\n        'N',\n        cast([_, new CSSUnitValue(1), new CSSUnitValue(1)]),\n        cast([_, new CSSUnitValue(1)]),\n    ],\n    scaley: [\n        'N',\n        cast([new CSSUnitValue(1), _, new CSSUnitValue(1)]),\n        cast([new CSSUnitValue(1), _]),\n    ],\n    scalez: ['N', cast([new CSSUnitValue(1), new CSSUnitValue(1), _])],\n    scale3d: ['NNN', id],\n    skew: ['Aa', null, id],\n    skewx: ['A', null, cast([_, Odeg])],\n    skewy: ['A', null, cast([Odeg, _])],\n    translate: ['Tt', cast([_, _, Opx]), id],\n    translatex: ['T', cast([_, Opx, Opx]), cast([_, Opx])],\n    translatey: ['T', cast([Opx, _, Opx]), cast([Opx, _])],\n    translatez: ['L', cast([Opx, Opx, _])],\n    translate3d: ['TTL', id],\n};\n/**\n * none\n * scale(1) scale(1, 2)\n * scaleX(1)\n */\nfunction parseTransform(string) {\n    string = (string || 'none').toLowerCase().trim();\n    if (string === 'none') {\n        return [];\n    }\n    var transformRegExp = /\\s*(\\w+)\\(([^)]*)\\)/g;\n    var result = [];\n    var match;\n    var prevLastIndex = 0;\n    while ((match = transformRegExp.exec(string))) {\n        if (match.index !== prevLastIndex) {\n            return [];\n        }\n        prevLastIndex = match.index + match[0].length;\n        var functionName = match[1]; // scale\n        var functionData = transformFunctions[functionName]; // scale(1, 2)\n        if (!functionData) {\n            // invalid, eg. scale()\n            return [];\n        }\n        var args = match[2].split(','); // 1,2\n        var argTypes = functionData[0]; // Nn\n        if (argTypes.length < args.length) {\n            // scale(N, n)\n            return [];\n        }\n        var parsedArgs = [];\n        for (var i = 0; i < argTypes.length; i++) {\n            var arg = args[i];\n            var type = argTypes[i];\n            var parsedArg = void 0;\n            if (!arg) {\n                // @ts-ignore\n                parsedArg = {\n                    a: Odeg,\n                    n: parsedArgs[0],\n                    t: Opx,\n                }[type];\n            }\n            else {\n                // @ts-ignore\n                parsedArg = {\n                    A: function (s) {\n                        return s.trim() === '0' ? Odeg : parseAngle(s);\n                    },\n                    N: parseNumber,\n                    T: parseLengthOrPercentage,\n                    L: parseLength,\n                }[type.toUpperCase()](arg);\n            }\n            if (parsedArg === undefined) {\n                return [];\n            }\n            parsedArgs.push(parsedArg);\n        }\n        result.push({ t: functionName, d: parsedArgs }); // { t: scale, d: [1, 2] }\n        if (transformRegExp.lastIndex === string.length) {\n            return result;\n        }\n    }\n    return [];\n}\nfunction parseTransformUnmemoize(string) {\n    string = (string || 'none').toLowerCase().trim();\n    if (string === 'none') {\n        return [];\n    }\n    var transformRegExp = /\\s*(\\w+)\\(([^)]*)\\)/g;\n    var result = [];\n    var match;\n    var prevLastIndex = 0;\n    while ((match = transformRegExp.exec(string))) {\n        if (match.index !== prevLastIndex) {\n            return [];\n        }\n        prevLastIndex = match.index + match[0].length;\n        var functionName = match[1]; // scale\n        var functionData = transformFunctions[functionName]; // scale(1, 2)\n        if (!functionData) {\n            // invalid, eg. scale()\n            return [];\n        }\n        var args = match[2].split(','); // 1,2\n        var argTypes = functionData[0]; // Nn\n        if (argTypes.length < args.length) {\n            // scale(N, n)\n            return [];\n        }\n        var parsedArgs = [];\n        for (var i = 0; i < argTypes.length; i++) {\n            var arg = args[i];\n            var type = argTypes[i];\n            var parsedArg = void 0;\n            if (!arg) {\n                // @ts-ignore\n                parsedArg = {\n                    a: Odeg,\n                    n: parsedArgs[0],\n                    t: Opx,\n                }[type];\n            }\n            else {\n                // @ts-ignore\n                parsedArg = {\n                    A: function (s) {\n                        return s.trim() === '0' ? Odeg : parseAngleUnmemoize(s);\n                    },\n                    N: parseNumberUnmemoize,\n                    T: parseLengthOrPercentageUnmemoize,\n                    L: parseLengthUnmemoize,\n                }[type.toUpperCase()](arg);\n            }\n            if (parsedArg === undefined) {\n                return [];\n            }\n            parsedArgs.push(parsedArg);\n        }\n        result.push({ t: functionName, d: parsedArgs }); // { t: scale, d: [1, 2] }\n        if (transformRegExp.lastIndex === string.length) {\n            return result;\n        }\n    }\n    return [];\n}\nfunction convertItemToMatrix(item) {\n    var x;\n    var y;\n    var z;\n    var angle;\n    switch (item.t) {\n        case 'rotatex':\n            angle = deg2rad(convertAngleUnit(item.d[0]));\n            return [\n                1,\n                0,\n                0,\n                0,\n                0,\n                Math.cos(angle),\n                Math.sin(angle),\n                0,\n                0,\n                -Math.sin(angle),\n                Math.cos(angle),\n                0,\n                0,\n                0,\n                0,\n                1,\n            ];\n        case 'rotatey':\n            angle = deg2rad(convertAngleUnit(item.d[0]));\n            return [\n                Math.cos(angle),\n                0,\n                -Math.sin(angle),\n                0,\n                0,\n                1,\n                0,\n                0,\n                Math.sin(angle),\n                0,\n                Math.cos(angle),\n                0,\n                0,\n                0,\n                0,\n                1,\n            ];\n        case 'rotate':\n        case 'rotatez':\n            angle = deg2rad(convertAngleUnit(item.d[0]));\n            return [\n                Math.cos(angle),\n                Math.sin(angle),\n                0,\n                0,\n                -Math.sin(angle),\n                Math.cos(angle),\n                0,\n                0,\n                0,\n                0,\n                1,\n                0,\n                0,\n                0,\n                0,\n                1,\n            ];\n        case 'rotate3d':\n            x = item.d[0].value;\n            y = item.d[1].value;\n            z = item.d[2].value;\n            angle = deg2rad(convertAngleUnit(item.d[3]));\n            var sqrLength = x * x + y * y + z * z;\n            if (sqrLength === 0) {\n                x = 1;\n                y = 0;\n                z = 0;\n            }\n            else if (sqrLength !== 1) {\n                var length_1 = Math.sqrt(sqrLength);\n                x /= length_1;\n                y /= length_1;\n                z /= length_1;\n            }\n            var s = Math.sin(angle / 2);\n            var sc = s * Math.cos(angle / 2);\n            var sq = s * s;\n            return [\n                1 - 2 * (y * y + z * z) * sq,\n                2 * (x * y * sq + z * sc),\n                2 * (x * z * sq - y * sc),\n                0,\n                2 * (x * y * sq - z * sc),\n                1 - 2 * (x * x + z * z) * sq,\n                2 * (y * z * sq + x * sc),\n                0,\n                2 * (x * z * sq + y * sc),\n                2 * (y * z * sq - x * sc),\n                1 - 2 * (x * x + y * y) * sq,\n                0,\n                0,\n                0,\n                0,\n                1,\n            ];\n        case 'scale':\n            return [\n                item.d[0].value,\n                0,\n                0,\n                0,\n                0,\n                item.d[1].value,\n                0,\n                0,\n                0,\n                0,\n                1,\n                0,\n                0,\n                0,\n                0,\n                1,\n            ];\n        case 'scalex':\n            return [item.d[0].value, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\n        case 'scaley':\n            return [1, 0, 0, 0, 0, item.d[0].value, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\n        case 'scalez':\n            return [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, item.d[0].value, 0, 0, 0, 0, 1];\n        case 'scale3d':\n            return [\n                item.d[0].value,\n                0,\n                0,\n                0,\n                0,\n                item.d[1].value,\n                0,\n                0,\n                0,\n                0,\n                item.d[2].value,\n                0,\n                0,\n                0,\n                0,\n                1,\n            ];\n        case 'skew':\n            var xAngle = deg2rad(convertAngleUnit(item.d[0]));\n            var yAngle = deg2rad(convertAngleUnit(item.d[1]));\n            return [\n                1,\n                Math.tan(yAngle),\n                0,\n                0,\n                Math.tan(xAngle),\n                1,\n                0,\n                0,\n                0,\n                0,\n                1,\n                0,\n                0,\n                0,\n                0,\n                1,\n            ];\n        case 'skewx':\n            angle = deg2rad(convertAngleUnit(item.d[0]));\n            return [1, 0, 0, 0, Math.tan(angle), 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\n        case 'skewy':\n            angle = deg2rad(convertAngleUnit(item.d[0]));\n            return [1, Math.tan(angle), 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\n        case 'translate':\n            // TODO: pass target\n            x = convertPercentUnit(item.d[0], 0, null) || 0;\n            y = convertPercentUnit(item.d[1], 0, null) || 0;\n            return [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, x, y, 0, 1];\n        case 'translatex':\n            x = convertPercentUnit(item.d[0], 0, null) || 0;\n            return [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, x, 0, 0, 1];\n        case 'translatey':\n            y = convertPercentUnit(item.d[0], 0, null) || 0;\n            return [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, y, 0, 1];\n        case 'translatez':\n            z = convertPercentUnit(item.d[0], 0, null) || 0;\n            return [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, z, 1];\n        case 'translate3d':\n            x = convertPercentUnit(item.d[0], 0, null) || 0;\n            y = convertPercentUnit(item.d[1], 0, null) || 0;\n            z = convertPercentUnit(item.d[2], 0, null) || 0;\n            return [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, x, y, z, 1];\n        case 'perspective':\n            var t = convertPercentUnit(item.d[0], 0, null) || 0;\n            var p = t ? -1 / t : 0;\n            return [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, p, 0, 0, 0, 1];\n        case 'matrix':\n            return [\n                item.d[0].value,\n                item.d[1].value,\n                0,\n                0,\n                item.d[2].value,\n                item.d[3].value,\n                0,\n                0,\n                0,\n                0,\n                1,\n                0,\n                item.d[4].value,\n                item.d[5].value,\n                0,\n                1,\n            ];\n        case 'matrix3d':\n            return item.d.map(function (d) { return d.value; });\n    }\n}\nfunction multiplyMatrices(a, b) {\n    return [\n        a[0] * b[0] + a[4] * b[1] + a[8] * b[2] + a[12] * b[3],\n        a[1] * b[0] + a[5] * b[1] + a[9] * b[2] + a[13] * b[3],\n        a[2] * b[0] + a[6] * b[1] + a[10] * b[2] + a[14] * b[3],\n        a[3] * b[0] + a[7] * b[1] + a[11] * b[2] + a[15] * b[3],\n        a[0] * b[4] + a[4] * b[5] + a[8] * b[6] + a[12] * b[7],\n        a[1] * b[4] + a[5] * b[5] + a[9] * b[6] + a[13] * b[7],\n        a[2] * b[4] + a[6] * b[5] + a[10] * b[6] + a[14] * b[7],\n        a[3] * b[4] + a[7] * b[5] + a[11] * b[6] + a[15] * b[7],\n        a[0] * b[8] + a[4] * b[9] + a[8] * b[10] + a[12] * b[11],\n        a[1] * b[8] + a[5] * b[9] + a[9] * b[10] + a[13] * b[11],\n        a[2] * b[8] + a[6] * b[9] + a[10] * b[10] + a[14] * b[11],\n        a[3] * b[8] + a[7] * b[9] + a[11] * b[10] + a[15] * b[11],\n        a[0] * b[12] + a[4] * b[13] + a[8] * b[14] + a[12] * b[15],\n        a[1] * b[12] + a[5] * b[13] + a[9] * b[14] + a[13] * b[15],\n        a[2] * b[12] + a[6] * b[13] + a[10] * b[14] + a[14] * b[15],\n        a[3] * b[12] + a[7] * b[13] + a[11] * b[14] + a[15] * b[15],\n    ];\n}\nfunction convertToMatrix(transformList) {\n    if (transformList.length === 0) {\n        return [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1];\n    }\n    return transformList.map(convertItemToMatrix).reduce(multiplyMatrices);\n}\nfunction makeMatrixDecomposition(transformList) {\n    var translate = [0, 0, 0];\n    var scale = [1, 1, 1];\n    var skew = [0, 0, 0];\n    var perspective = [0, 0, 0, 1];\n    var quaternion = [0, 0, 0, 1];\n    decomposeMat4(\n    // @ts-ignore\n    convertToMatrix(transformList), translate, scale, skew, perspective, quaternion);\n    return [[translate, scale, skew, quaternion, perspective]];\n}\nvar composeMatrix = (function () {\n    function multiply(a, b) {\n        var result = [\n            [0, 0, 0, 0],\n            [0, 0, 0, 0],\n            [0, 0, 0, 0],\n            [0, 0, 0, 0],\n        ];\n        for (var i = 0; i < 4; i++) {\n            for (var j = 0; j < 4; j++) {\n                for (var k = 0; k < 4; k++) {\n                    result[i][j] += b[i][k] * a[k][j];\n                }\n            }\n        }\n        return result;\n    }\n    function is2D(m) {\n        return (m[0][2] == 0 &&\n            m[0][3] == 0 &&\n            m[1][2] == 0 &&\n            m[1][3] == 0 &&\n            m[2][0] == 0 &&\n            m[2][1] == 0 &&\n            m[2][2] == 1 &&\n            m[2][3] == 0 &&\n            m[3][2] == 0 &&\n            m[3][3] == 1);\n    }\n    function composeMatrix(translate, scale, skew, quat, perspective) {\n        var matrix = [\n            [1, 0, 0, 0],\n            [0, 1, 0, 0],\n            [0, 0, 1, 0],\n            [0, 0, 0, 1],\n        ];\n        for (var i = 0; i < 4; i++) {\n            matrix[i][3] = perspective[i];\n        }\n        for (var i = 0; i < 3; i++) {\n            for (var j = 0; j < 3; j++) {\n                matrix[3][i] += translate[j] * matrix[j][i];\n            }\n        }\n        var x = quat[0], y = quat[1], z = quat[2], w = quat[3];\n        var rotMatrix = [\n            [1, 0, 0, 0],\n            [0, 1, 0, 0],\n            [0, 0, 1, 0],\n            [0, 0, 0, 1],\n        ];\n        rotMatrix[0][0] = 1 - 2 * (y * y + z * z);\n        rotMatrix[0][1] = 2 * (x * y - z * w);\n        rotMatrix[0][2] = 2 * (x * z + y * w);\n        rotMatrix[1][0] = 2 * (x * y + z * w);\n        rotMatrix[1][1] = 1 - 2 * (x * x + z * z);\n        rotMatrix[1][2] = 2 * (y * z - x * w);\n        rotMatrix[2][0] = 2 * (x * z - y * w);\n        rotMatrix[2][1] = 2 * (y * z + x * w);\n        rotMatrix[2][2] = 1 - 2 * (x * x + y * y);\n        matrix = multiply(matrix, rotMatrix);\n        var temp = [\n            [1, 0, 0, 0],\n            [0, 1, 0, 0],\n            [0, 0, 1, 0],\n            [0, 0, 0, 1],\n        ];\n        if (skew[2]) {\n            temp[2][1] = skew[2];\n            matrix = multiply(matrix, temp);\n        }\n        if (skew[1]) {\n            temp[2][1] = 0;\n            temp[2][0] = skew[0];\n            matrix = multiply(matrix, temp);\n        }\n        if (skew[0]) {\n            temp[2][0] = 0;\n            temp[1][0] = skew[0];\n            matrix = multiply(matrix, temp);\n        }\n        for (var i = 0; i < 3; i++) {\n            for (var j = 0; j < 3; j++) {\n                matrix[i][j] *= scale[i];\n            }\n        }\n        if (is2D(matrix)) {\n            return [\n                matrix[0][0],\n                matrix[0][1],\n                matrix[1][0],\n                matrix[1][1],\n                matrix[3][0],\n                matrix[3][1],\n            ];\n        }\n        return matrix[0].concat(matrix[1], matrix[2], matrix[3]);\n    }\n    return composeMatrix;\n})();\nfunction numberToLongString(x) {\n    return x.toFixed(6).replace('.000000', '');\n}\nfunction mergeMatrices(left, right) {\n    var leftArgs;\n    var rightArgs;\n    // @ts-ignore\n    if (left.decompositionPair !== right) {\n        // @ts-ignore\n        left.decompositionPair = right;\n        // @ts-ignore\n        leftArgs = makeMatrixDecomposition(left);\n    }\n    // @ts-ignore\n    if (right.decompositionPair !== left) {\n        // @ts-ignore\n        right.decompositionPair = left;\n        // @ts-ignore\n        rightArgs = makeMatrixDecomposition(right);\n    }\n    if (leftArgs[0] === null || rightArgs[0] === null)\n        return [\n            // @ts-ignore\n            [false],\n            // @ts-ignore\n            [true],\n            // @ts-ignore\n            function (x) {\n                return x ? right[0].d : left[0].d;\n            },\n        ];\n    leftArgs[0].push(0);\n    rightArgs[0].push(1);\n    return [\n        leftArgs,\n        rightArgs,\n        // @ts-ignore\n        function (list) {\n            // @ts-ignore\n            var q = quat(leftArgs[0][3], rightArgs[0][3], list[5]);\n            var mat = composeMatrix(list[0], list[1], list[2], q, list[4]);\n            var stringifiedArgs = mat.map(numberToLongString).join(',');\n            return stringifiedArgs;\n        },\n    ];\n}\nfunction dot(v1, v2) {\n    var result = 0;\n    for (var i = 0; i < v1.length; i++) {\n        result += v1[i] * v2[i];\n    }\n    return result;\n}\nfunction quat(fromQ, toQ, f) {\n    var product = dot(fromQ, toQ);\n    product = clamp(product, -1.0, 1.0);\n    var quat = [];\n    if (product === 1.0) {\n        quat = fromQ;\n    }\n    else {\n        var theta = Math.acos(product);\n        var w = (Math.sin(f * theta) * 1) / Math.sqrt(1 - product * product);\n        for (var i = 0; i < 4; i++) {\n            quat.push(fromQ[i] * (Math.cos(f * theta) - product * w) + toQ[i] * w);\n        }\n    }\n    return quat;\n}\n// scalex/y/z -> scale\nfunction typeTo2D(type) {\n    return type.replace(/[xy]/, '');\n}\n// scalex/y/z -> scale3d\nfunction typeTo3D(type) {\n    return type.replace(/(x|y|z|3d)?$/, '3d');\n}\nvar isMatrixOrPerspective = function (lt, rt) {\n    return ((lt === 'perspective' && rt === 'perspective') ||\n        ((lt === 'matrix' || lt === 'matrix3d') &&\n            (rt === 'matrix' || rt === 'matrix3d')));\n};\nfunction mergeTransforms(left, right, target) {\n    var flipResults = false;\n    // padding empty transform, eg. merge 'scale(10)' with 'none' -> scale(1)\n    if (!left.length || !right.length) {\n        if (!left.length) {\n            flipResults = true;\n            left = right;\n            right = [];\n        }\n        var _loop_1 = function (i) {\n            var _a = left[i], type = _a.t, args = _a.d;\n            // none -> scale(1)/translateX(0)\n            var defaultValue = type.substring(0, 5) === 'scale' ? 1 : 0;\n            right.push({\n                t: type,\n                d: args.map(function (arg) {\n                    if (typeof arg === 'number') {\n                        return getOrCreateUnitValue(defaultValue);\n                    }\n                    return getOrCreateUnitValue(defaultValue, arg.unit);\n                    //   {\n                    //     unit: arg.unit,\n                    //     value: defaultValue,\n                    //   };\n                }),\n            });\n        };\n        for (var i = 0; i < left.length; i++) {\n            _loop_1(i);\n        }\n    }\n    var leftResult = [];\n    var rightResult = [];\n    var types = [];\n    // merge matrix() with matrix3d()\n    if (left.length !== right.length) {\n        var merged = mergeMatrices(left, right);\n        // @ts-ignore\n        leftResult = [merged[0]];\n        // @ts-ignore\n        rightResult = [merged[1]];\n        types = [['matrix', [merged[2]]]];\n    }\n    else {\n        for (var i = 0; i < left.length; i++) {\n            var leftType = left[i].t;\n            var rightType = right[i].t;\n            var leftArgs = left[i].d;\n            var rightArgs = right[i].d;\n            var leftFunctionData = transformFunctions[leftType];\n            var rightFunctionData = transformFunctions[rightType];\n            var type = void 0;\n            if (isMatrixOrPerspective(leftType, rightType)) {\n                var merged = mergeMatrices([left[i]], [right[i]]);\n                // @ts-ignore\n                leftResult.push(merged[0]);\n                // @ts-ignore\n                rightResult.push(merged[1]);\n                types.push(['matrix', [merged[2]]]);\n                continue;\n            }\n            else if (leftType === rightType) {\n                type = leftType;\n            }\n            else if (leftFunctionData[2] &&\n                rightFunctionData[2] &&\n                typeTo2D(leftType) === typeTo2D(rightType)) {\n                type = typeTo2D(leftType);\n                // @ts-ignore\n                leftArgs = leftFunctionData[2](leftArgs);\n                // @ts-ignore\n                rightArgs = rightFunctionData[2](rightArgs);\n            }\n            else if (leftFunctionData[1] &&\n                rightFunctionData[1] &&\n                typeTo3D(leftType) === typeTo3D(rightType)) {\n                type = typeTo3D(leftType);\n                // @ts-ignore\n                leftArgs = leftFunctionData[1](leftArgs);\n                // @ts-ignore\n                rightArgs = rightFunctionData[1](rightArgs);\n            }\n            else {\n                var merged = mergeMatrices(left, right);\n                // @ts-ignore\n                leftResult = [merged[0]];\n                // @ts-ignore\n                rightResult = [merged[1]];\n                types = [['matrix', [merged[2]]]];\n                break;\n            }\n            var leftArgsCopy = [];\n            var rightArgsCopy = [];\n            var stringConversions = [];\n            for (var j = 0; j < leftArgs.length; j++) {\n                // const merge = leftArgs[j].unit === UnitType.kNumber ? mergeDimensions : mergeDimensions;\n                var merged = mergeDimensions(leftArgs[j], rightArgs[j], target, false, j);\n                leftArgsCopy[j] = merged[0];\n                rightArgsCopy[j] = merged[1];\n                stringConversions.push(merged[2]);\n            }\n            leftResult.push(leftArgsCopy);\n            rightResult.push(rightArgsCopy);\n            types.push([type, stringConversions]);\n        }\n    }\n    if (flipResults) {\n        var tmp = leftResult;\n        leftResult = rightResult;\n        rightResult = tmp;\n    }\n    return [\n        leftResult,\n        rightResult,\n        function (list) {\n            return list\n                .map(function (args, i) {\n                var stringifiedArgs = args\n                    .map(function (arg, j) {\n                    return types[i][1][j](arg);\n                })\n                    .join(',');\n                if (types[i][0] === 'matrix' &&\n                    stringifiedArgs.split(',').length === 16) {\n                    types[i][0] = 'matrix3d';\n                }\n                if (types[i][0] === 'matrix3d' &&\n                    stringifiedArgs.split(',').length === 6) {\n                    types[i][0] = 'matrix';\n                }\n                return types[i][0] + '(' + stringifiedArgs + ')';\n            })\n                .join(' ');\n        },\n    ];\n}\n\n/**\n * @see https://developer.mozilla.org/zh-CN/docs/Web/CSS/transform-origin\n * eg. 'center' 'top left' '50px 50px'\n */\nvar parseTransformOrigin = memoize(function (value) {\n    if (isString(value)) {\n        if (value === 'text-anchor') {\n            return [getOrCreateUnitValue(0, 'px'), getOrCreateUnitValue(0, 'px')];\n        }\n        var values = value.split(' ');\n        if (values.length === 1) {\n            if (values[0] === 'top' || values[0] === 'bottom') {\n                // 'top' -> 'center top'\n                values[1] = values[0];\n                values[0] = 'center';\n            }\n            else {\n                // '50px' -> '50px center'\n                values[1] = 'center';\n            }\n        }\n        if (values.length !== 2) {\n            return null;\n        }\n        // eg. center bottom\n        return [\n            parseLengthOrPercentage(convertKeyword2Percent(values[0])),\n            parseLengthOrPercentage(convertKeyword2Percent(values[1])),\n        ];\n    }\n    else {\n        return [\n            getOrCreateUnitValue(value[0] || 0, 'px'),\n            getOrCreateUnitValue(value[1] || 0, 'px'),\n        ];\n    }\n});\nvar parseTransformOriginUnmemoize = function (value) {\n    if (isString(value)) {\n        if (value === 'text-anchor') {\n            return [getOrCreateUnitValue(0, 'px'), getOrCreateUnitValue(0, 'px')];\n        }\n        var values = value.split(' ');\n        if (values.length === 1) {\n            if (values[0] === 'top' || values[0] === 'bottom') {\n                // 'top' -> 'center top'\n                values[1] = values[0];\n                values[0] = 'center';\n            }\n            else {\n                // '50px' -> '50px center'\n                values[1] = 'center';\n            }\n        }\n        if (values.length !== 2) {\n            return null;\n        }\n        // eg. center bottom\n        return [\n            parseLengthOrPercentageUnmemoize(convertKeyword2Percent(values[0])),\n            parseLengthOrPercentageUnmemoize(convertKeyword2Percent(values[1])),\n        ];\n    }\n    else {\n        return [\n            getOrCreateUnitValue(value[0] || 0, 'px'),\n            getOrCreateUnitValue(value[1] || 0, 'px'),\n        ];\n    }\n};\nfunction convertKeyword2Percent(keyword) {\n    if (keyword === 'center') {\n        return '50%';\n    }\n    else if (keyword === 'left' || keyword === 'top') {\n        return '0%';\n    }\n    else if (keyword === 'right' || keyword === 'bottom') {\n        return '100%';\n    }\n    return keyword;\n}\n\n/**\n * Blink used them in code generation(css_properties.json5)\n */\nvar BUILT_IN_PROPERTIES = [\n    {\n        /**\n         * used in CSS Layout API\n         * eg. `display: 'flex'`\n         */\n        n: 'display',\n        k: ['none'],\n    },\n    {\n        /**\n         * range [0.0, 1.0]\n         * @see https://developer.mozilla.org/en-US/docs/Web/CSS/opacity\n         */\n        n: 'opacity',\n        int: true,\n        inh: true,\n        d: '1',\n        syntax: PropertySyntax.OPACITY_VALUE,\n    },\n    {\n        /**\n         * inheritable, range [0.0, 1.0]\n         * @see https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/fill-opacity\n         * @see https://svgwg.org/svg2-draft/painting.html#FillOpacity\n         */\n        n: 'fillOpacity',\n        int: true,\n        inh: true,\n        d: '1',\n        syntax: PropertySyntax.OPACITY_VALUE,\n    },\n    {\n        /**\n         * inheritable, range [0.0, 1.0]\n         * @see https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/stroke-opacity\n         * @see https://svgwg.org/svg2-draft/painting.html#StrokeOpacity\n         */\n        n: 'strokeOpacity',\n        int: true,\n        inh: true,\n        d: '1',\n        syntax: PropertySyntax.OPACITY_VALUE,\n    },\n    {\n        /**\n         * background-color is not inheritable\n         * @see https://developer.mozilla.org/en-US/docs/Web/SVG/Tutorial/Fills_and_Strokes\n         */\n        n: 'fill',\n        int: true,\n        k: ['none'],\n        d: 'none',\n        syntax: PropertySyntax.PAINT,\n    },\n    {\n        n: 'fillRule',\n        k: ['nonzero', 'evenodd'],\n        d: 'nonzero',\n    },\n    /**\n     * default to none\n     * @see https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/stroke#usage_notes\n     */\n    {\n        n: 'stroke',\n        int: true,\n        k: ['none'],\n        d: 'none',\n        syntax: PropertySyntax.PAINT,\n        /**\n         * Stroke 'none' won't affect geometry but others will.\n         */\n        l: true,\n    },\n    {\n        n: 'shadowType',\n        k: ['inner', 'outer', 'both'],\n        d: 'outer',\n        l: true,\n    },\n    {\n        n: 'shadowColor',\n        int: true,\n        syntax: PropertySyntax.COLOR,\n    },\n    {\n        n: 'shadowOffsetX',\n        int: true,\n        l: true,\n        d: '0',\n        syntax: PropertySyntax.LENGTH_PERCENTAGE,\n    },\n    {\n        n: 'shadowOffsetY',\n        int: true,\n        l: true,\n        d: '0',\n        syntax: PropertySyntax.LENGTH_PERCENTAGE,\n    },\n    {\n        n: 'shadowBlur',\n        int: true,\n        l: true,\n        d: '0',\n        syntax: PropertySyntax.SHADOW_BLUR,\n    },\n    {\n        /**\n         * @see https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/stroke-width\n         */\n        n: 'lineWidth',\n        int: true,\n        inh: true,\n        d: '1',\n        l: true,\n        a: ['strokeWidth'],\n        syntax: PropertySyntax.LENGTH_PERCENTAGE,\n    },\n    {\n        n: 'increasedLineWidthForHitTesting',\n        inh: true,\n        d: '0',\n        l: true,\n        syntax: PropertySyntax.LENGTH_PERCENTAGE,\n    },\n    {\n        n: 'lineJoin',\n        inh: true,\n        l: true,\n        a: ['strokeLinejoin'],\n        k: ['miter', 'bevel', 'round'],\n        d: 'miter',\n    },\n    {\n        n: 'lineCap',\n        inh: true,\n        l: true,\n        a: ['strokeLinecap'],\n        k: ['butt', 'round', 'square'],\n        d: 'butt',\n    },\n    {\n        n: 'lineDash',\n        int: true,\n        inh: true,\n        k: ['none'],\n        a: ['strokeDasharray'],\n        syntax: PropertySyntax.LENGTH_PERCENTAGE_12,\n    },\n    {\n        n: 'lineDashOffset',\n        int: true,\n        inh: true,\n        d: '0',\n        a: ['strokeDashoffset'],\n        syntax: PropertySyntax.LENGTH_PERCENTAGE,\n    },\n    {\n        n: 'offsetPath',\n        syntax: PropertySyntax.DEFINED_PATH,\n    },\n    {\n        n: 'offsetDistance',\n        int: true,\n        syntax: PropertySyntax.OFFSET_DISTANCE,\n    },\n    {\n        n: 'dx',\n        int: true,\n        l: true,\n        d: '0',\n        syntax: PropertySyntax.LENGTH_PERCENTAGE,\n    },\n    {\n        n: 'dy',\n        int: true,\n        l: true,\n        d: '0',\n        syntax: PropertySyntax.LENGTH_PERCENTAGE,\n    },\n    {\n        n: 'zIndex',\n        ind: true,\n        int: true,\n        d: '0',\n        k: ['auto'],\n        syntax: PropertySyntax.Z_INDEX,\n    },\n    {\n        n: 'visibility',\n        k: ['visible', 'hidden'],\n        ind: true,\n        inh: true,\n        /**\n         * support interpolation\n         * @see https://developer.mozilla.org/en-US/docs/Web/CSS/visibility#interpolation\n         */\n        int: true,\n        d: 'visible',\n    },\n    {\n        n: 'pointerEvents',\n        inh: true,\n        k: [\n            'none',\n            'auto',\n            'stroke',\n            'fill',\n            'painted',\n            'visible',\n            'visiblestroke',\n            'visiblefill',\n            'visiblepainted',\n            // 'bounding-box',\n            'all',\n        ],\n        d: 'auto',\n    },\n    {\n        n: 'filter',\n        ind: true,\n        l: true,\n        k: ['none'],\n        d: 'none',\n        syntax: PropertySyntax.FILTER,\n    },\n    {\n        n: 'clipPath',\n        syntax: PropertySyntax.DEFINED_PATH,\n    },\n    {\n        n: 'textPath',\n        syntax: PropertySyntax.DEFINED_PATH,\n    },\n    {\n        n: 'textPathSide',\n        k: ['left', 'right'],\n        d: 'left',\n    },\n    {\n        n: 'textPathStartOffset',\n        l: true,\n        d: '0',\n        syntax: PropertySyntax.LENGTH_PERCENTAGE,\n    },\n    {\n        n: 'transform',\n        p: 100,\n        int: true,\n        k: ['none'],\n        d: 'none',\n        syntax: PropertySyntax.TRANSFORM,\n    },\n    {\n        n: 'transformOrigin',\n        p: 100,\n        d: '0 0',\n        // // int: true,\n        // d: (nodeName: string) => {\n        //   if (nodeName === Shape.CIRCLE || nodeName === Shape.ELLIPSE) {\n        //     return 'center';\n        //   }\n        //   if (nodeName === Shape.TEXT) {\n        //     return 'text-anchor';\n        //   }\n        //   return 'left top';\n        // },\n        l: true,\n        syntax: PropertySyntax.TRANSFORM_ORIGIN,\n    },\n    {\n        n: 'cx',\n        int: true,\n        l: true,\n        d: '0',\n        syntax: PropertySyntax.COORDINATE,\n    },\n    {\n        n: 'cy',\n        int: true,\n        l: true,\n        d: '0',\n        syntax: PropertySyntax.COORDINATE,\n    },\n    {\n        n: 'cz',\n        int: true,\n        l: true,\n        d: '0',\n        syntax: PropertySyntax.COORDINATE,\n    },\n    {\n        n: 'r',\n        int: true,\n        l: true,\n        d: '0',\n        syntax: PropertySyntax.LENGTH_PERCENTAGE,\n    },\n    {\n        n: 'rx',\n        int: true,\n        l: true,\n        d: '0',\n        syntax: PropertySyntax.LENGTH_PERCENTAGE,\n    },\n    {\n        n: 'ry',\n        int: true,\n        l: true,\n        d: '0',\n        syntax: PropertySyntax.LENGTH_PERCENTAGE,\n    },\n    // Rect Image Group\n    {\n        // x in local space\n        n: 'x',\n        int: true,\n        l: true,\n        d: '0',\n        syntax: PropertySyntax.COORDINATE,\n    },\n    {\n        // y in local space\n        n: 'y',\n        int: true,\n        l: true,\n        d: '0',\n        syntax: PropertySyntax.COORDINATE,\n    },\n    {\n        // z in local space\n        n: 'z',\n        int: true,\n        l: true,\n        d: '0',\n        syntax: PropertySyntax.COORDINATE,\n    },\n    {\n        n: 'width',\n        int: true,\n        l: true,\n        /**\n         * @see https://developer.mozilla.org/zh-CN/docs/Web/CSS/width\n         */\n        k: ['auto', 'fit-content', 'min-content', 'max-content'],\n        d: '0',\n        syntax: PropertySyntax.LENGTH_PERCENTAGE,\n    },\n    {\n        n: 'height',\n        int: true,\n        l: true,\n        /**\n         * @see https://developer.mozilla.org/zh-CN/docs/Web/CSS/height\n         */\n        k: ['auto', 'fit-content', 'min-content', 'max-content'],\n        d: '0',\n        syntax: PropertySyntax.LENGTH_PERCENTAGE,\n    },\n    {\n        n: 'radius',\n        int: true,\n        l: true,\n        d: '0',\n        syntax: PropertySyntax.LENGTH_PERCENTAGE_14,\n    },\n    // Line\n    {\n        n: 'x1',\n        int: true,\n        l: true,\n        syntax: PropertySyntax.COORDINATE,\n    },\n    {\n        n: 'y1',\n        int: true,\n        l: true,\n        syntax: PropertySyntax.COORDINATE,\n    },\n    {\n        n: 'z1',\n        int: true,\n        l: true,\n        syntax: PropertySyntax.COORDINATE,\n    },\n    {\n        n: 'x2',\n        int: true,\n        l: true,\n        syntax: PropertySyntax.COORDINATE,\n    },\n    {\n        n: 'y2',\n        int: true,\n        l: true,\n        syntax: PropertySyntax.COORDINATE,\n    },\n    {\n        n: 'z2',\n        int: true,\n        l: true,\n        syntax: PropertySyntax.COORDINATE,\n    },\n    // Path\n    {\n        n: 'd',\n        int: true,\n        l: true,\n        d: '',\n        syntax: PropertySyntax.PATH,\n        p: 50,\n    },\n    // Polyline & Polygon\n    {\n        n: 'points',\n        /**\n         * support interpolation\n         */\n        int: true,\n        l: true,\n        syntax: PropertySyntax.LIST_OF_POINTS,\n        p: 50,\n    },\n    // Text\n    {\n        n: 'text',\n        l: true,\n        d: '',\n        syntax: PropertySyntax.TEXT,\n        p: 50,\n    },\n    {\n        n: 'textTransform',\n        l: true,\n        inh: true,\n        k: ['capitalize', 'uppercase', 'lowercase', 'none'],\n        d: 'none',\n        syntax: PropertySyntax.TEXT_TRANSFORM,\n        p: 51, // it must get parsed after text\n    },\n    {\n        n: 'font',\n        l: true,\n    },\n    {\n        n: 'fontSize',\n        int: true,\n        inh: true,\n        /**\n         * @see https://www.w3schools.com/css/css_font_size.asp\n         */\n        d: '16px',\n        l: true,\n        syntax: PropertySyntax.LENGTH_PERCENTAGE,\n    },\n    {\n        n: 'fontFamily',\n        l: true,\n        inh: true,\n        d: 'sans-serif',\n    },\n    {\n        n: 'fontStyle',\n        l: true,\n        inh: true,\n        k: ['normal', 'italic', 'oblique'],\n        d: 'normal',\n    },\n    {\n        n: 'fontWeight',\n        l: true,\n        inh: true,\n        k: ['normal', 'bold', 'bolder', 'lighter'],\n        d: 'normal',\n    },\n    {\n        n: 'fontVariant',\n        l: true,\n        inh: true,\n        k: ['normal', 'small-caps'],\n        d: 'normal',\n    },\n    {\n        n: 'lineHeight',\n        l: true,\n        syntax: PropertySyntax.LENGTH,\n        int: true,\n        d: '0',\n    },\n    {\n        n: 'letterSpacing',\n        l: true,\n        syntax: PropertySyntax.LENGTH,\n        int: true,\n        d: '0',\n    },\n    {\n        n: 'miterLimit',\n        l: true,\n        syntax: PropertySyntax.NUMBER,\n        d: function (nodeName) {\n            if (nodeName === Shape.PATH ||\n                nodeName === Shape.POLYGON ||\n                nodeName === Shape.POLYLINE) {\n                return '4';\n            }\n            return '10';\n        },\n    },\n    {\n        n: 'wordWrap',\n        l: true,\n    },\n    {\n        n: 'wordWrapWidth',\n        l: true,\n    },\n    {\n        n: 'maxLines',\n        l: true,\n    },\n    {\n        n: 'textOverflow',\n        l: true,\n        d: 'clip',\n    },\n    {\n        n: 'leading',\n        l: true,\n    },\n    {\n        n: 'textBaseline',\n        l: true,\n        inh: true,\n        k: ['top', 'hanging', 'middle', 'alphabetic', 'ideographic', 'bottom'],\n        d: 'alphabetic',\n    },\n    {\n        n: 'textAlign',\n        l: true,\n        inh: true,\n        k: ['start', 'center', 'middle', 'end', 'left', 'right'],\n        d: 'start',\n    },\n    // {\n    //   n: 'whiteSpace',\n    //   l: true,\n    // },\n    {\n        n: 'markerStart',\n        syntax: PropertySyntax.MARKER,\n    },\n    {\n        n: 'markerEnd',\n        syntax: PropertySyntax.MARKER,\n    },\n    {\n        n: 'markerMid',\n        syntax: PropertySyntax.MARKER,\n    },\n    {\n        n: 'markerStartOffset',\n        syntax: PropertySyntax.LENGTH,\n        l: true,\n        int: true,\n        d: '0',\n    },\n    {\n        n: 'markerEndOffset',\n        syntax: PropertySyntax.LENGTH,\n        l: true,\n        int: true,\n        d: '0',\n    },\n];\nvar GEOMETRY_ATTRIBUTE_NAMES = BUILT_IN_PROPERTIES.filter(function (n) { return !!n.l; }).map(function (n) { return n.n; });\nvar propertyMetadataCache = {};\nvar unresolvedProperties = new WeakMap();\n// const uniqueAttributeSet = new Set<string>();\n// const tmpVec3a = vec3.create();\n// const tmpVec3b = vec3.create();\n// const tmpVec3c = vec3.create();\nvar isPropertyResolved = function (object, name) {\n    var properties = unresolvedProperties.get(object);\n    if (!properties || properties.length === 0) {\n        return true;\n    }\n    return properties.includes(name);\n};\nvar DefaultStyleValueRegistry = /** @class */ (function () {\n    /**\n     * need recalc later\n     */\n    // dirty = false;\n    function DefaultStyleValueRegistry(runtime) {\n        var _this = this;\n        this.runtime = runtime;\n        BUILT_IN_PROPERTIES.forEach(function (property) {\n            _this.registerMetadata(property);\n        });\n    }\n    DefaultStyleValueRegistry.prototype.registerMetadata = function (metadata) {\n        __spreadArray([metadata.n], __read((metadata.a || [])), false).forEach(function (name) {\n            propertyMetadataCache[name] = metadata;\n        });\n    };\n    DefaultStyleValueRegistry.prototype.unregisterMetadata = function (name) {\n        delete propertyMetadataCache[name];\n    };\n    DefaultStyleValueRegistry.prototype.getPropertySyntax = function (syntax) {\n        return this.runtime.CSSPropertySyntaxFactory[syntax];\n    };\n    /**\n     * * parse value, eg.\n     * fill: 'red' => CSSRGB\n     * translateX: '10px' => CSSUnitValue { unit: 'px', value: 10 }\n     * fontSize: '2em' => { unit: 'px', value: 32 }\n     *\n     * * calculate used value\n     * * post process\n     */\n    DefaultStyleValueRegistry.prototype.processProperties = function (object, attributes, options) {\n        var _this = this;\n        if (options === void 0) { options = {\n            skipUpdateAttribute: false,\n            skipParse: false,\n            forceUpdateGeometry: false,\n            usedAttributes: [],\n            memoize: true,\n        }; }\n        if (!this.runtime.enableCSSParsing) {\n            Object.assign(object.attributes, attributes);\n            var attributeNames = Object.keys(attributes);\n            // clipPath\n            var oldClipPath = object.parsedStyle.clipPath;\n            var oldOffsetPath = object.parsedStyle.offsetPath;\n            object.parsedStyle = Object.assign(object.parsedStyle, attributes);\n            var needUpdateGeometry = !!options.forceUpdateGeometry;\n            if (!needUpdateGeometry) {\n                for (var i = 0; i < GEOMETRY_ATTRIBUTE_NAMES.length; i++) {\n                    if (GEOMETRY_ATTRIBUTE_NAMES[i] in attributes) {\n                        needUpdateGeometry = true;\n                        break;\n                    }\n                }\n            }\n            if (attributes.fill) {\n                object.parsedStyle.fill = parseColor(attributes.fill);\n            }\n            if (attributes.stroke) {\n                object.parsedStyle.stroke = parseColor(attributes.stroke);\n            }\n            if (attributes.shadowColor) {\n                object.parsedStyle.shadowColor = parseColor(attributes.shadowColor);\n            }\n            if (attributes.filter) {\n                object.parsedStyle.filter = parseFilter(attributes.filter);\n            }\n            // Rect\n            // @ts-ignore\n            if (!isNil(attributes.radius)) {\n                // @ts-ignore\n                object.parsedStyle.radius = parseDimensionArrayFormat(\n                // @ts-ignore\n                attributes.radius, 4);\n            }\n            // Polyline\n            if (!isNil(attributes.lineDash)) {\n                object.parsedStyle.lineDash = parseDimensionArrayFormat(attributes.lineDash, 2);\n            }\n            // @ts-ignore\n            if (attributes.points) {\n                // @ts-ignore\n                object.parsedStyle.points = parsePoints(attributes.points);\n            }\n            // Path\n            // @ts-ignore\n            if (attributes.d === '') {\n                object.parsedStyle.d = __assign({}, EMPTY_PARSED_PATH);\n            }\n            // @ts-ignore\n            if (attributes.d) {\n                object.parsedStyle.d = parsePath(\n                // @ts-ignore\n                attributes.d);\n            }\n            // Text\n            if (attributes.textTransform) {\n                this.runtime.CSSPropertySyntaxFactory['<text-transform>'].calculator(null, null, { value: attributes.textTransform }, object, null);\n            }\n            if (!isUndefined(attributes.clipPath)) {\n                this.runtime.CSSPropertySyntaxFactory['<defined-path>'].calculator('clipPath', oldClipPath, attributes.clipPath, object, this.runtime);\n            }\n            if (attributes.offsetPath) {\n                this.runtime.CSSPropertySyntaxFactory['<defined-path>'].calculator('offsetPath', oldOffsetPath, attributes.offsetPath, object, this.runtime);\n            }\n            if (attributes.transform) {\n                object.parsedStyle.transform = parseTransform(attributes.transform);\n            }\n            if (attributes.transformOrigin) {\n                object.parsedStyle.transformOrigin = parseTransformOrigin(attributes.transformOrigin);\n            }\n            // Marker\n            // @ts-ignore\n            if (attributes.markerStart) {\n                object.parsedStyle.markerStart = this.runtime.CSSPropertySyntaxFactory['<marker>'].calculator(null, \n                // @ts-ignore\n                attributes.markerStart, \n                // @ts-ignore\n                attributes.markerStart, null, null);\n            }\n            // @ts-ignore\n            if (attributes.markerEnd) {\n                object.parsedStyle.markerEnd = this.runtime.CSSPropertySyntaxFactory['<marker>'].calculator(null, \n                // @ts-ignore\n                attributes.markerEnd, \n                // @ts-ignore\n                attributes.markerEnd, null, null);\n            }\n            // @ts-ignore\n            if (attributes.markerMid) {\n                object.parsedStyle.markerMid = this.runtime.CSSPropertySyntaxFactory['<marker>'].calculator('', \n                // @ts-ignore\n                attributes.markerMid, \n                // @ts-ignore\n                attributes.markerMid, null, null);\n            }\n            if (!isNil(attributes.zIndex)) {\n                this.runtime.CSSPropertySyntaxFactory['<z-index>'].postProcessor(object, attributeNames);\n            }\n            if (!isNil(attributes.offsetDistance)) {\n                this.runtime.CSSPropertySyntaxFactory['<offset-distance>'].postProcessor(object, attributeNames);\n            }\n            if (attributes.transform) {\n                this.runtime.CSSPropertySyntaxFactory['<transform>'].postProcessor(object, attributeNames);\n            }\n            if (attributes.transformOrigin) {\n                this.runtime.CSSPropertySyntaxFactory['<transform-origin>'].postProcessor(object, attributeNames);\n            }\n            if (needUpdateGeometry) {\n                object.geometry.dirty = true;\n                object.renderable.boundsDirty = true;\n                object.renderable.renderBoundsDirty = true;\n                if (!options.forceUpdateGeometry) {\n                    this.runtime.sceneGraphService.dirtifyToRoot(object);\n                }\n            }\n        }\n        else {\n            var skipUpdateAttribute_1 = options.skipUpdateAttribute, skipParse = options.skipParse, forceUpdateGeometry = options.forceUpdateGeometry, usedAttributes = options.usedAttributes, memoize_1 = options.memoize;\n            var needUpdateGeometry_1 = forceUpdateGeometry;\n            var attributeNames_1 = Object.keys(attributes);\n            attributeNames_1.forEach(function (attributeName) {\n                var _a;\n                if (!skipUpdateAttribute_1) {\n                    object.attributes[attributeName] = attributes[attributeName];\n                }\n                if (!needUpdateGeometry_1 && ((_a = propertyMetadataCache[attributeName]) === null || _a === void 0 ? void 0 : _a.l)) {\n                    needUpdateGeometry_1 = true;\n                }\n            });\n            if (!skipParse) {\n                attributeNames_1.forEach(function (name) {\n                    object.computedStyle[name] = _this.parseProperty(name, object.attributes[name], object, memoize_1);\n                });\n            }\n            // let hasUnresolvedProperties = false;\n            // parse according to priority\n            // path 50\n            // points 50\n            // text 50\n            // textTransform 51\n            // transform 100\n            // transformOrigin 100\n            if (usedAttributes === null || usedAttributes === void 0 ? void 0 : usedAttributes.length) {\n                // uniqueAttributeSet.clear();\n                attributeNames_1 = Array.from(new Set(attributeNames_1.concat(usedAttributes)));\n            }\n            // [\n            //   'path',\n            //   'points',\n            //   'text',\n            //   'textTransform',\n            //   'transform',\n            //   'transformOrigin',\n            // ].forEach((name) => {\n            //   const index = attributeNames.indexOf(name);\n            //   if (index > -1) {\n            //     attributeNames.splice(index, 1);\n            //     attributeNames.push(name);\n            //   }\n            // });\n            attributeNames_1.forEach(function (name) {\n                // some style props maybe deleted after parsing such as `anchor` in Text\n                if (name in object.computedStyle) {\n                    object.parsedStyle[name] = _this.computeProperty(name, object.computedStyle[name], object, memoize_1);\n                }\n            });\n            // if (hasUnresolvedProperties) {\n            //   this.dirty = true;\n            //   return;\n            // }\n            // update geometry\n            if (needUpdateGeometry_1) {\n                object.geometry.dirty = true;\n                object.renderable.boundsDirty = true;\n                object.renderable.renderBoundsDirty = true;\n                if (!options.forceUpdateGeometry) {\n                    this.runtime.sceneGraphService.dirtifyToRoot(object);\n                }\n            }\n            attributeNames_1.forEach(function (name) {\n                if (name in object.parsedStyle) {\n                    _this.postProcessProperty(name, object, attributeNames_1);\n                }\n            });\n            if (this.runtime.enableCSSParsing && object.children.length) {\n                attributeNames_1.forEach(function (name) {\n                    if (name in object.parsedStyle && _this.isPropertyInheritable(name)) {\n                        // update children's inheritable\n                        object.children.forEach(function (child) {\n                            child.internalSetAttribute(name, null, {\n                                skipUpdateAttribute: true,\n                                skipParse: true,\n                            });\n                        });\n                    }\n                });\n            }\n        }\n    };\n    /**\n     * string -> parsed value\n     */\n    DefaultStyleValueRegistry.prototype.parseProperty = function (name, value, object, memoized) {\n        var metadata = propertyMetadataCache[name];\n        var computed = value;\n        if (value === '' || isNil(value)) {\n            value = 'unset';\n        }\n        if (value === 'unset' || value === 'initial' || value === 'inherit') {\n            // computed = new CSSKeywordValue(value);\n            computed = getOrCreateKeyword(value);\n        }\n        else {\n            if (metadata) {\n                var keywords = metadata.k, syntax = metadata.syntax;\n                var handler = syntax && this.getPropertySyntax(syntax);\n                // use keywords\n                if (keywords && keywords.indexOf(value) > -1) {\n                    // computed = new CSSKeywordValue(value);\n                    computed = getOrCreateKeyword(value);\n                }\n                else if (handler) {\n                    if (!memoized && handler.parserUnmemoize) {\n                        computed = handler.parserUnmemoize(value, object);\n                    }\n                    else if (handler.parser) {\n                        // try to parse it to CSSStyleValue, eg. '10px' -> CSS.px(10)\n                        computed = handler.parser(value, object);\n                    }\n                }\n            }\n        }\n        return computed;\n    };\n    /**\n     * computed value -> used value\n     */\n    DefaultStyleValueRegistry.prototype.computeProperty = function (name, computed, object, memoized) {\n        var metadata = propertyMetadataCache[name];\n        var isDocumentElement = object.id === 'g-root';\n        // let used: CSSStyleValue = computed instanceof CSSStyleValue ? computed.clone() : computed;\n        var used = computed;\n        if (metadata) {\n            var syntax = metadata.syntax, inherited = metadata.inh, defaultValue = metadata.d;\n            if (computed instanceof CSSKeywordValue) {\n                var value = computed.value;\n                /**\n                 * @see https://developer.mozilla.org/zh-CN/docs/Web/CSS/unset\n                 */\n                if (value === 'unset') {\n                    if (inherited && !isDocumentElement) {\n                        value = 'inherit';\n                    }\n                    else {\n                        value = 'initial';\n                    }\n                }\n                if (value === 'initial') {\n                    // @see https://developer.mozilla.org/en-US/docs/Web/CSS/initial\n                    if (!isNil(defaultValue)) {\n                        computed = this.parseProperty(name, isFunction(defaultValue)\n                            ? defaultValue(object.nodeName)\n                            : defaultValue, object, memoized);\n                    }\n                }\n                else if (value === 'inherit') {\n                    // @see https://developer.mozilla.org/en-US/docs/Web/CSS/inherit\n                    // behave like `inherit`\n                    var resolved = this.tryToResolveProperty(object, name, {\n                        inherited: true,\n                    });\n                    if (!isNil(resolved)) {\n                        // object.parsedStyle[name] = resolved;\n                        // return false;\n                        return resolved;\n                    }\n                    else {\n                        this.addUnresolveProperty(object, name);\n                        return;\n                    }\n                }\n            }\n            var handler = syntax && this.getPropertySyntax(syntax);\n            if (handler && handler.calculator) {\n                // convert computed value to used value\n                var oldParsedValue = object.parsedStyle[name];\n                used = handler.calculator(name, oldParsedValue, computed, object, this.runtime);\n            }\n            else if (computed instanceof CSSKeywordValue) {\n                used = computed.value;\n            }\n            else {\n                used = computed;\n            }\n        }\n        // object.parsedStyle[name] = used;\n        // return false;\n        return used;\n    };\n    DefaultStyleValueRegistry.prototype.postProcessProperty = function (name, object, attributes) {\n        var metadata = propertyMetadataCache[name];\n        if (metadata && metadata.syntax) {\n            var handler = metadata.syntax && this.getPropertySyntax(metadata.syntax);\n            var propertyHandler = handler;\n            if (propertyHandler && propertyHandler.postProcessor) {\n                propertyHandler.postProcessor(object, attributes);\n            }\n        }\n    };\n    /**\n     * resolve later\n     */\n    DefaultStyleValueRegistry.prototype.addUnresolveProperty = function (object, name) {\n        var properties = unresolvedProperties.get(object);\n        if (!properties) {\n            unresolvedProperties.set(object, []);\n            properties = unresolvedProperties.get(object);\n        }\n        if (properties.indexOf(name) === -1) {\n            properties.push(name);\n        }\n    };\n    DefaultStyleValueRegistry.prototype.tryToResolveProperty = function (object, name, options) {\n        if (options === void 0) { options = {}; }\n        var inherited = options.inherited;\n        if (inherited) {\n            if (object.parentElement &&\n                isPropertyResolved(object.parentElement, name)) {\n                // const computedValue = object.parentElement.computedStyle[name];\n                var usedValue = object.parentElement.parsedStyle[name];\n                if (\n                // usedValue instanceof CSSKeywordValue &&\n                usedValue === 'unset' ||\n                    usedValue === 'initial' ||\n                    usedValue === 'inherit') {\n                    return;\n                }\n                // else if (\n                //   usedValue instanceof CSSUnitValue &&\n                //   CSSUnitValue.isRelativeUnit(usedValue.unit)\n                // ) {\n                //   return false;\n                // }\n                return usedValue;\n            }\n        }\n        return;\n    };\n    DefaultStyleValueRegistry.prototype.recalc = function (object) {\n        var properties = unresolvedProperties.get(object);\n        if (properties && properties.length) {\n            var attributes_1 = {};\n            properties.forEach(function (property) {\n                attributes_1[property] = object.attributes[property];\n            });\n            this.processProperties(object, attributes_1);\n            unresolvedProperties.delete(object);\n        }\n    };\n    /**\n     * update geometry when relative props changed,\n     * eg. r of Circle, width/height of Rect\n     */\n    DefaultStyleValueRegistry.prototype.updateGeometry = function (object) {\n        var nodeName = object.nodeName;\n        var geometryUpdater = this.runtime.geometryUpdaterFactory[nodeName];\n        if (geometryUpdater) {\n            var geometry_1 = object.geometry;\n            if (!geometry_1.contentBounds) {\n                geometry_1.contentBounds = new AABB();\n            }\n            if (!geometry_1.renderBounds) {\n                geometry_1.renderBounds = new AABB();\n            }\n            var parsedStyle = object.parsedStyle;\n            var _a = geometryUpdater.update(parsedStyle, object), _b = _a.cx, cx = _b === void 0 ? 0 : _b, _c = _a.cy, cy = _c === void 0 ? 0 : _c, _d = _a.cz, cz = _d === void 0 ? 0 : _d, _e = _a.hwidth, hwidth = _e === void 0 ? 0 : _e, _f = _a.hheight, hheight = _f === void 0 ? 0 : _f, _g = _a.hdepth, hdepth = _g === void 0 ? 0 : _g;\n            // init with content box\n            var halfExtents = [\n                Math.abs(hwidth),\n                Math.abs(hheight),\n                hdepth,\n            ];\n            // const halfExtents = vec3.set(\n            //   tmpVec3a,\n            //   Math.abs(width) / 2,\n            //   Math.abs(height) / 2,\n            //   depth / 2,\n            // );\n            // anchor is center by default, don't account for lineWidth here\n            var _h = parsedStyle, stroke = _h.stroke, _j = _h.lineWidth, lineWidth = _j === void 0 ? 1 : _j, \n            // lineCap,\n            // lineJoin,\n            // miterLimit,\n            _k = _h.increasedLineWidthForHitTesting, \n            // lineCap,\n            // lineJoin,\n            // miterLimit,\n            increasedLineWidthForHitTesting = _k === void 0 ? 0 : _k, _l = _h.shadowType, shadowType = _l === void 0 ? 'outer' : _l, shadowColor = _h.shadowColor, _m = _h.filter, filter = _m === void 0 ? [] : _m, transformOrigin = _h.transformOrigin;\n            var center = [cx, cy, cz];\n            // update geometry's AABB\n            geometry_1.contentBounds.update(center, halfExtents);\n            // @see https://github.molgen.mpg.de/git-mirror/cairo/blob/master/src/cairo-stroke-style.c#L97..L128\n            var expansion = nodeName === Shape.POLYLINE ||\n                nodeName === Shape.POLYGON ||\n                nodeName === Shape.PATH\n                ? Math.SQRT2\n                : 0.5;\n            // if (lineCap?.value === 'square') {\n            //   expansion = Math.SQRT1_2;\n            // }\n            // if (lineJoin?.value === 'miter' && expansion < Math.SQRT2 * miterLimit) {\n            //   expansion = Math.SQRT1_2 * miterLimit;\n            // }\n            // append border only if stroke existed\n            var hasStroke = stroke && !stroke.isNone;\n            if (hasStroke) {\n                var halfLineWidth = ((lineWidth || 0) + (increasedLineWidthForHitTesting || 0)) *\n                    expansion;\n                // halfExtents[0] += halfLineWidth[0];\n                // halfExtents[1] += halfLineWidth[1];\n                halfExtents[0] += halfLineWidth;\n                halfExtents[1] += halfLineWidth;\n                // vec3.add(\n                //   halfExtents,\n                //   halfExtents,\n                //   vec3.set(tmpVec3c, halfLineWidth, halfLineWidth, 0),\n                // );\n            }\n            geometry_1.renderBounds.update(center, halfExtents);\n            // account for shadow, only support constant value now\n            if (shadowColor && shadowType && shadowType !== 'inner') {\n                var _o = geometry_1.renderBounds, min = _o.min, max = _o.max;\n                var _p = parsedStyle, shadowBlur = _p.shadowBlur, shadowOffsetX = _p.shadowOffsetX, shadowOffsetY = _p.shadowOffsetY;\n                var shadowBlurInPixels = shadowBlur || 0;\n                var shadowOffsetXInPixels = shadowOffsetX || 0;\n                var shadowOffsetYInPixels = shadowOffsetY || 0;\n                var shadowLeft = min[0] - shadowBlurInPixels + shadowOffsetXInPixels;\n                var shadowRight = max[0] + shadowBlurInPixels + shadowOffsetXInPixels;\n                var shadowTop = min[1] - shadowBlurInPixels + shadowOffsetYInPixels;\n                var shadowBottom = max[1] + shadowBlurInPixels + shadowOffsetYInPixels;\n                min[0] = Math.min(min[0], shadowLeft);\n                max[0] = Math.max(max[0], shadowRight);\n                min[1] = Math.min(min[1], shadowTop);\n                max[1] = Math.max(max[1], shadowBottom);\n                geometry_1.renderBounds.setMinMax(min, max);\n            }\n            // account for filter, eg. blur(5px), drop-shadow()\n            filter.forEach(function (_a) {\n                var name = _a.name, params = _a.params;\n                if (name === 'blur') {\n                    var blurRadius = params[0].value;\n                    geometry_1.renderBounds.update(geometry_1.renderBounds.center, addVec3(geometry_1.renderBounds.halfExtents, geometry_1.renderBounds.halfExtents, [blurRadius, blurRadius, 0]));\n                }\n                else if (name === 'drop-shadow') {\n                    var shadowOffsetX = params[0].value;\n                    var shadowOffsetY = params[1].value;\n                    var shadowBlur = params[2].value;\n                    var _b = geometry_1.renderBounds, min = _b.min, max = _b.max;\n                    var shadowLeft = min[0] - shadowBlur + shadowOffsetX;\n                    var shadowRight = max[0] + shadowBlur + shadowOffsetX;\n                    var shadowTop = min[1] - shadowBlur + shadowOffsetY;\n                    var shadowBottom = max[1] + shadowBlur + shadowOffsetY;\n                    min[0] = Math.min(min[0], shadowLeft);\n                    max[0] = Math.max(max[0], shadowRight);\n                    min[1] = Math.min(min[1], shadowTop);\n                    max[1] = Math.max(max[1], shadowBottom);\n                    geometry_1.renderBounds.setMinMax(min, max);\n                }\n            });\n            object.geometry.dirty = false;\n            // @see https://github.com/antvis/g/issues/957\n            var flipY = hwidth < 0;\n            var flipX = hheight < 0;\n            // set transform origin\n            var usedOriginXValue = (flipY ? -1 : 1) *\n                (transformOrigin\n                    ? convertPercentUnit(transformOrigin[0], 0, object, true)\n                    : 0);\n            var usedOriginYValue = (flipX ? -1 : 1) *\n                (transformOrigin\n                    ? convertPercentUnit(transformOrigin[1], 1, object, true)\n                    : 0);\n            if (usedOriginXValue || usedOriginYValue) {\n                object.setOrigin(usedOriginXValue, usedOriginYValue);\n            }\n        }\n    };\n    DefaultStyleValueRegistry.prototype.updateSizeAttenuation = function (node, zoom) {\n        if (node.style.isSizeAttenuation) {\n            if (!node.style.rawLineWidth) {\n                node.style.rawLineWidth = node.style.lineWidth;\n            }\n            node.style.lineWidth = (node.style.rawLineWidth || 1) / zoom;\n            if (node.nodeName === Shape.CIRCLE) {\n                if (!node.style.rawR) {\n                    node.style.rawR = node.style.r;\n                }\n                node.style.r = (node.style.rawR || 1) / zoom;\n            }\n        }\n        else {\n            if (node.style.rawLineWidth) {\n                node.style.lineWidth = node.style.rawLineWidth;\n                delete node.style.rawLineWidth;\n            }\n            if (node.nodeName === Shape.CIRCLE) {\n                if (node.style.rawR) {\n                    node.style.r = node.style.rawR;\n                    delete node.style.rawR;\n                }\n            }\n        }\n    };\n    DefaultStyleValueRegistry.prototype.isPropertyInheritable = function (name) {\n        var metadata = propertyMetadataCache[name];\n        if (!metadata) {\n            return false;\n        }\n        return metadata.inh;\n    };\n    return DefaultStyleValueRegistry;\n}());\n\nvar CSSPropertyAngle = /** @class */ (function () {\n    function CSSPropertyAngle() {\n        this.parser = parseAngle;\n        this.parserUnmemoize = parseAngleUnmemoize;\n        this.parserWithCSSDisabled = null;\n        this.mixer = mergeNumbers;\n    }\n    CSSPropertyAngle.prototype.calculator = function (name, oldParsed, parsed, object) {\n        return convertAngleUnit(parsed);\n    };\n    return CSSPropertyAngle;\n}());\n\n/**\n * clipPath / textPath / offsetPath\n */\nvar CSSPropertyClipPath = /** @class */ (function () {\n    function CSSPropertyClipPath() {\n    }\n    CSSPropertyClipPath.prototype.calculator = function (name, oldPath, newPath, object, runtime) {\n        // unset\n        if (newPath instanceof CSSKeywordValue) {\n            newPath = null;\n        }\n        runtime.sceneGraphService.updateDisplayObjectDependency(name, oldPath, newPath, object);\n        if (name === 'clipPath') {\n            // should affect children\n            object.forEach(function (leaf) {\n                if (leaf.childNodes.length === 0) {\n                    runtime.sceneGraphService.dirtifyToRoot(leaf);\n                }\n            });\n        }\n        return newPath;\n    };\n    return CSSPropertyClipPath;\n}());\n\nvar CSSPropertyColor = /** @class */ (function () {\n    function CSSPropertyColor() {\n        this.parser = parseColor;\n        this.parserWithCSSDisabled = parseColor;\n        this.mixer = mergeColors;\n    }\n    CSSPropertyColor.prototype.calculator = function (name, oldParsed, parsed, object) {\n        if (parsed instanceof CSSKeywordValue) {\n            // 'unset' 'none'\n            return parsed.value === 'none' ? noneColor : transparentColor;\n        }\n        return parsed;\n    };\n    return CSSPropertyColor;\n}());\n\nvar CSSPropertyFilter = /** @class */ (function () {\n    function CSSPropertyFilter() {\n        this.parser = parseFilter;\n    }\n    CSSPropertyFilter.prototype.calculator = function (name, oldParsed, parsed) {\n        // unset or none\n        if (parsed instanceof CSSKeywordValue) {\n            return [];\n        }\n        return parsed;\n    };\n    return CSSPropertyFilter;\n}());\n\nfunction getFontSize(object) {\n    var fontSize = object.parsedStyle.fontSize;\n    return isNil(fontSize) ? null : fontSize;\n}\n/**\n * <length> & <percentage>\n */\nvar CSSPropertyLengthOrPercentage = /** @class */ (function () {\n    function CSSPropertyLengthOrPercentage() {\n        this.parser = parseLengthOrPercentage;\n        this.parserUnmemoize = parseLengthOrPercentageUnmemoize;\n        this.parserWithCSSDisabled = null;\n        this.mixer = mergeNumbers;\n    }\n    /**\n     * according to parent's bounds\n     *\n     * @example\n     * CSS.percent(50) -> CSS.px(0.5 * parent.width)\n     */\n    CSSPropertyLengthOrPercentage.prototype.calculator = function (name, oldParsed, computed, object, runtime) {\n        var _a;\n        if (isNumber(computed)) {\n            return computed;\n        }\n        if (CSSUnitValue.isRelativeUnit(computed.unit)) {\n            var registry = runtime.styleValueRegistry;\n            if (computed.unit === UnitType.kPercentage) {\n                // TODO: merge dimensions\n                return 0;\n            }\n            else if (computed.unit === UnitType.kEms) {\n                if (object.parentNode) {\n                    var fontSize = getFontSize(object.parentNode);\n                    if (fontSize) {\n                        fontSize *= computed.value;\n                        return fontSize;\n                    }\n                    else {\n                        registry.addUnresolveProperty(object, name);\n                    }\n                }\n                else {\n                    registry.addUnresolveProperty(object, name);\n                }\n                return 0;\n            }\n            else if (computed.unit === UnitType.kRems) {\n                if ((_a = object === null || object === void 0 ? void 0 : object.ownerDocument) === null || _a === void 0 ? void 0 : _a.documentElement) {\n                    var fontSize = getFontSize(object.ownerDocument.documentElement);\n                    if (fontSize) {\n                        fontSize *= computed.value;\n                        return fontSize;\n                    }\n                    else {\n                        registry.addUnresolveProperty(object, name);\n                    }\n                }\n                else {\n                    registry.addUnresolveProperty(object, name);\n                }\n                return 0;\n            }\n        }\n        else {\n            // remove listener if exists\n            // registry.unregisterParentGeometryBoundsChangedHandler(object, name);\n            // return absolute value\n            return computed.value;\n        }\n    };\n    return CSSPropertyLengthOrPercentage;\n}());\n\n/**\n * format to Tuple2<CSSUnitValue>\n *\n * @example\n * rect.style.lineDash = 10;\n * rect.style.lineDash = [10, 10];\n * rect.style.lineDash = '10 10';\n */\nvar CSSPropertyLengthOrPercentage12 = /** @class */ (function () {\n    function CSSPropertyLengthOrPercentage12() {\n        this.mixer = mergeNumberLists;\n    }\n    CSSPropertyLengthOrPercentage12.prototype.parser = function (radius) {\n        var parsed = parseDimensionArray(isNumber(radius) ? [radius] : radius);\n        var formatted;\n        if (parsed.length === 1) {\n            formatted = [parsed[0], parsed[0]];\n        }\n        else {\n            formatted = [parsed[0], parsed[1]];\n        }\n        return formatted;\n    };\n    CSSPropertyLengthOrPercentage12.prototype.calculator = function (name, oldParsed, computed) {\n        return computed.map(function (c) { return c.value; });\n    };\n    return CSSPropertyLengthOrPercentage12;\n}());\n\n/**\n * used in rounded rect\n *\n * @example\n * rect.style.radius = 10;\n * rect.style.radius = '10 10';\n * rect.style.radius = '10 10 10 10';\n */\nvar CSSPropertyLengthOrPercentage14 = /** @class */ (function () {\n    function CSSPropertyLengthOrPercentage14() {\n        this.mixer = mergeNumberLists;\n    }\n    CSSPropertyLengthOrPercentage14.prototype.parser = function (radius) {\n        var parsed = parseDimensionArray(isNumber(radius) ? [radius] : radius);\n        var formatted;\n        // format to Tuple<CSSUnitValue>\n        if (parsed.length === 1) {\n            formatted = [parsed[0], parsed[0], parsed[0], parsed[0]];\n        }\n        else if (parsed.length === 2) {\n            formatted = [parsed[0], parsed[1], parsed[0], parsed[1]];\n        }\n        else if (parsed.length === 3) {\n            formatted = [parsed[0], parsed[1], parsed[2], parsed[1]];\n        }\n        else {\n            formatted = [parsed[0], parsed[1], parsed[2], parsed[3]];\n        }\n        return formatted;\n    };\n    CSSPropertyLengthOrPercentage14.prototype.calculator = function (name, oldParsed, computed) {\n        return computed.map(function (c) { return c.value; });\n    };\n    return CSSPropertyLengthOrPercentage14;\n}());\n\nvar CSSPropertyMarker = /** @class */ (function () {\n    function CSSPropertyMarker() {\n    }\n    CSSPropertyMarker.prototype.calculator = function (name, oldMarker, newMarker, object) {\n        // unset\n        if (newMarker instanceof CSSKeywordValue) {\n            newMarker = null;\n        }\n        var cloned = newMarker === null || newMarker === void 0 ? void 0 : newMarker.cloneNode(true);\n        if (cloned) {\n            // FIXME: SVG should not inherit parent's style, add a flag here\n            cloned.style.isMarker = true;\n        }\n        return cloned;\n    };\n    return CSSPropertyMarker;\n}());\n\nvar CSSPropertyNumber = /** @class */ (function () {\n    function CSSPropertyNumber() {\n        this.mixer = mergeNumbers;\n        this.parser = parseNumber;\n        this.parserUnmemoize = parseNumberUnmemoize;\n        this.parserWithCSSDisabled = null;\n    }\n    CSSPropertyNumber.prototype.calculator = function (name, oldParsed, computed) {\n        return computed.value;\n    };\n    return CSSPropertyNumber;\n}());\n\nvar CSSPropertyOffsetDistance = /** @class */ (function () {\n    function CSSPropertyOffsetDistance() {\n        this.parser = parseNumber;\n        this.parserUnmemoize = parseNumberUnmemoize;\n        this.parserWithCSSDisabled = null;\n        this.mixer = clampedMergeNumbers(0, 1);\n    }\n    CSSPropertyOffsetDistance.prototype.calculator = function (name, oldParsed, computed) {\n        return computed.value;\n    };\n    CSSPropertyOffsetDistance.prototype.postProcessor = function (object) {\n        var _a = object.parsedStyle, offsetPath = _a.offsetPath, offsetDistance = _a.offsetDistance;\n        if (!offsetPath) {\n            return;\n        }\n        var nodeName = offsetPath.nodeName;\n        if (nodeName === Shape.LINE ||\n            nodeName === Shape.PATH ||\n            nodeName === Shape.POLYLINE) {\n            // set position in world space\n            var point = offsetPath.getPoint(offsetDistance);\n            if (point) {\n                object.setLocalPosition(point.x, point.y);\n            }\n        }\n    };\n    return CSSPropertyOffsetDistance;\n}());\n\n/**\n * opacity\n */\nvar CSSPropertyOpacity = /** @class */ (function () {\n    function CSSPropertyOpacity() {\n        this.parser = parseNumber;\n        this.parserUnmemoize = parseNumberUnmemoize;\n        this.parserWithCSSDisabled = null;\n        this.mixer = clampedMergeNumbers(0, 1);\n    }\n    CSSPropertyOpacity.prototype.calculator = function (name, oldParsed, computed) {\n        return computed.value;\n    };\n    return CSSPropertyOpacity;\n}());\n\nvar CSSPropertyPath = /** @class */ (function () {\n    function CSSPropertyPath() {\n        /**\n         * path2Curve\n         */\n        this.parser = parsePath;\n        this.parserWithCSSDisabled = parsePath;\n        this.mixer = mergePaths;\n    }\n    CSSPropertyPath.prototype.calculator = function (name, oldParsed, parsed) {\n        // unset\n        if (parsed instanceof CSSKeywordValue && parsed.value === 'unset') {\n            return {\n                absolutePath: [],\n                hasArc: false,\n                segments: [],\n                polygons: [],\n                polylines: [],\n                curve: null,\n                totalLength: 0,\n                rect: new Rectangle(0, 0, 0, 0),\n            };\n        }\n        return parsed;\n    };\n    return CSSPropertyPath;\n}());\n\nvar CSSPropertyPoints = /** @class */ (function () {\n    function CSSPropertyPoints() {\n        this.parser = parsePoints;\n        this.mixer = mergePoints;\n    }\n    return CSSPropertyPoints;\n}());\n\nvar CSSPropertyShadowBlur = /** @class */ (function (_super) {\n    __extends(CSSPropertyShadowBlur, _super);\n    function CSSPropertyShadowBlur() {\n        var _this = _super.apply(this, __spreadArray([], __read(arguments), false)) || this;\n        _this.mixer = clampedMergeNumbers(0, Infinity);\n        return _this;\n    }\n    return CSSPropertyShadowBlur;\n}(CSSPropertyLengthOrPercentage));\n\nvar CSSPropertyText = /** @class */ (function () {\n    function CSSPropertyText() {\n    }\n    CSSPropertyText.prototype.calculator = function (name, oldParsed, parsed, object) {\n        if (parsed instanceof CSSKeywordValue) {\n            if (parsed.value === 'unset') {\n                return '';\n            }\n            else {\n                return parsed.value;\n            }\n        }\n        // allow number as valid text content\n        return \"\".concat(parsed);\n    };\n    CSSPropertyText.prototype.postProcessor = function (object) {\n        object.nodeValue = \"\".concat(object.parsedStyle.text) || '';\n    };\n    return CSSPropertyText;\n}());\n\n/**\n * it must transform after text get parsed\n * @see https://developer.mozilla.org/zh-CN/docs/Web/CSS/text-transform\n */\nvar CSSPropertyTextTransform = /** @class */ (function () {\n    function CSSPropertyTextTransform() {\n    }\n    CSSPropertyTextTransform.prototype.calculator = function (name, oldParsed, parsed, object) {\n        var rawText = object.getAttribute('text');\n        if (rawText) {\n            var transformedText = rawText;\n            if (parsed.value === 'capitalize') {\n                transformedText = rawText.charAt(0).toUpperCase() + rawText.slice(1);\n            }\n            else if (parsed.value === 'lowercase') {\n                transformedText = rawText.toLowerCase();\n            }\n            else if (parsed.value === 'uppercase') {\n                transformedText = rawText.toUpperCase();\n            }\n            object.parsedStyle.text = transformedText;\n        }\n        return parsed.value;\n    };\n    return CSSPropertyTextTransform;\n}());\n\nvar canvasMap = {};\nvar defaultCanvasIdCounter = 0;\n/**\n * destroy existed canvas with the same id\n */\nfunction cleanExistedCanvas(container, canvas) {\n    if (container) {\n        var id = typeof container === 'string'\n            ? container\n            : container.id || defaultCanvasIdCounter++;\n        if (canvasMap[id]) {\n            canvasMap[id].destroy();\n        }\n        canvasMap[id] = canvas;\n    }\n}\nvar isBrowser = typeof window !== 'undefined' && typeof window.document !== 'undefined';\n\nfunction isElement(target) {\n    return !!target.getAttribute;\n}\nfunction sortedIndex(array, value) {\n    var low = 0;\n    var high = array.length;\n    while (low < high) {\n        var mid = (low + high) >>> 1;\n        if (sortByZIndex(array[mid], value) < 0) {\n            low = mid + 1;\n        }\n        else {\n            high = mid;\n        }\n    }\n    return low;\n}\nfunction sortByZIndex(o1, o2) {\n    var zIndex1 = Number(o1.parsedStyle.zIndex || 0);\n    var zIndex2 = Number(o2.parsedStyle.zIndex || 0);\n    if (zIndex1 === zIndex2) {\n        var parent_1 = o1.parentNode;\n        if (parent_1) {\n            var children = parent_1.childNodes || [];\n            return children.indexOf(o1) - children.indexOf(o2);\n        }\n    }\n    return zIndex1 - zIndex2;\n}\nfunction findClosestClipPathTarget(object) {\n    var _a;\n    var el = object;\n    do {\n        var clipPath = (_a = el.parsedStyle) === null || _a === void 0 ? void 0 : _a.clipPath;\n        if (clipPath)\n            return el;\n        el = el.parentElement;\n    } while (el !== null);\n    return null;\n}\nvar PX_SUFFIX = 'px';\nfunction setDOMSize($el, width, height) {\n    if (isBrowser && $el.style) {\n        $el.style.width = width + PX_SUFFIX;\n        $el.style.height = height + PX_SUFFIX;\n    }\n}\nfunction getStyle($el, property) {\n    if (isBrowser) {\n        return document.defaultView\n            .getComputedStyle($el, null)\n            .getPropertyValue(property);\n    }\n}\nfunction getWidth($el) {\n    var width = getStyle($el, 'width');\n    if (width === 'auto') {\n        return $el.offsetWidth;\n    }\n    return parseFloat(width);\n}\nfunction getHeight($el) {\n    var height = getStyle($el, 'height');\n    if (height === 'auto') {\n        return $el.offsetHeight;\n    }\n    return parseFloat(height);\n}\n\n// borrow from hammer.js\nvar MOUSE_POINTER_ID = 1;\nvar TOUCH_TO_POINTER = {\n    touchstart: 'pointerdown',\n    touchend: 'pointerup',\n    touchendoutside: 'pointerupoutside',\n    touchmove: 'pointermove',\n    touchcancel: 'pointercancel',\n};\nvar clock = typeof performance === 'object' && performance.now ? performance : Date;\n\nfunction isFillOrStrokeAffected(pointerEvents, fill, stroke) {\n    // account for pointerEvents\n    // @see https://developer.mozilla.org/en-US/docs/Web/CSS/pointer-events\n    if (pointerEvents === void 0) { pointerEvents = 'auto'; }\n    var hasFill = false;\n    var hasStroke = false;\n    var isFillOtherThanNone = !!fill && !fill.isNone;\n    var isStrokeOtherThanNone = !!stroke && !stroke.isNone;\n    if (pointerEvents === 'visiblepainted' ||\n        pointerEvents === 'painted' ||\n        pointerEvents === 'auto') {\n        hasFill = isFillOtherThanNone;\n        hasStroke = isStrokeOtherThanNone;\n    }\n    else if (pointerEvents === 'visiblefill' || pointerEvents === 'fill') {\n        hasFill = true;\n    }\n    else if (pointerEvents === 'visiblestroke' || pointerEvents === 'stroke') {\n        hasStroke = true;\n    }\n    else if (pointerEvents === 'visible' || pointerEvents === 'all') {\n        // The values of the fill and stroke do not affect event processing.\n        hasFill = true;\n        hasStroke = true;\n    }\n    return [hasFill, hasStroke];\n}\n\n/**\n * Thanks for following contributor of codes\n * https://gist.github.com/1866474\n * http://paulirish.com/2011/requestanimationframe-for-smart-animating/\n * http://my.opera.com/emoller/blog/2011/12/20/requestanimationframe-for-smart-er-animating\n * https://github.com/Financial-Times/polyfill-library/blob/master/polyfills/requestAnimationFrame/polyfill.js\n **/\nvar uId = 1;\nvar uniqueId = function () { return uId++; };\n// We use `self` instead of `window` for `WebWorker` support.\nvar root = typeof self === 'object' && self.self == self\n    ? self\n    : // @ts-ignore\n        typeof global === 'object' && global.global == global\n            ? // @ts-ignore\n                global\n            : {};\nvar nowOffset = Date.now();\n// use performance api if exist, otherwise use Date.now.\n// Date.now polyfill required.\nvar pnow = function () {\n    if (root.performance && typeof root.performance.now === 'function') {\n        return root.performance.now();\n    }\n    // fallback\n    return Date.now() - nowOffset;\n};\nvar reservedCBs = {};\nvar lastTime = Date.now();\nvar polyfillRaf = function (callback) {\n    if (typeof callback !== 'function') {\n        throw new TypeError(callback + ' is not a function');\n    }\n    var currentTime = Date.now();\n    var gap = currentTime - lastTime;\n    var delay = gap > 16 ? 0 : 16 - gap;\n    var id = uniqueId();\n    reservedCBs[id] = callback;\n    // keys(reservedCBs).length > 1 의미는 이미 setTimeout 이 걸려있는 경우.\n    // 함께 callback 이 실행될 수 있게 reservedCBs 에만 추가해주고 return\n    if (Object.keys(reservedCBs).length > 1)\n        return id;\n    setTimeout(function () {\n        lastTime = currentTime;\n        var copied = reservedCBs;\n        reservedCBs = {};\n        Object.keys(copied).forEach(function (key) { return copied[key](pnow()); });\n    }, delay);\n    return id;\n};\nvar polyfillCaf = function (id) {\n    delete reservedCBs[id];\n};\nvar vendorPrefixes = ['', 'webkit', 'moz', 'ms', 'o'];\nvar getRequestAnimationFrame = function (vp) {\n    if (typeof vp !== 'string')\n        return polyfillRaf;\n    if (vp === '')\n        return root['requestAnimationFrame'];\n    return root[vp + 'RequestAnimationFrame'];\n};\nvar getCancelAnimationFrame = function (vp) {\n    if (typeof vp !== 'string')\n        return polyfillCaf;\n    if (vp === '')\n        return root['cancelAnimationFrame'];\n    return (root[vp + 'CancelAnimationFrame'] ||\n        root[vp + 'CancelRequestAnimationFrame']);\n};\nvar find = function (arr, predicate) {\n    var i = 0;\n    while (arr[i] !== void 0) {\n        if (predicate(arr[i]))\n            return arr[i];\n        i = i + 1;\n    }\n};\nvar vp = find(vendorPrefixes, function (vp) { return !!getRequestAnimationFrame(vp); });\nvar raf = getRequestAnimationFrame(vp);\nvar caf = getCancelAnimationFrame(vp);\nroot.requestAnimationFrame = raf;\nroot.cancelAnimationFrame = caf;\n\nvar AsyncParallelHook = /** @class */ (function () {\n    function AsyncParallelHook() {\n        this.callbacks = [];\n    }\n    AsyncParallelHook.prototype.getCallbacksNum = function () {\n        return this.callbacks.length;\n    };\n    AsyncParallelHook.prototype.tapPromise = function (options, fn) {\n        this.callbacks.push(fn);\n    };\n    AsyncParallelHook.prototype.promise = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        return Promise.all(this.callbacks.map(function (callback) {\n            return callback.apply(void 0, __spreadArray([], __read(args), false));\n        }));\n    };\n    return AsyncParallelHook;\n}());\n\nvar AsyncSeriesWaterfallHook = /** @class */ (function () {\n    function AsyncSeriesWaterfallHook() {\n        this.callbacks = [];\n    }\n    AsyncSeriesWaterfallHook.prototype.tapPromise = function (options, fn) {\n        this.callbacks.push(fn);\n    };\n    AsyncSeriesWaterfallHook.prototype.promise = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        return __awaiter(this, void 0, void 0, function () {\n            var result, i, callback;\n            var _a;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0:\n                        if (!this.callbacks.length) return [3 /*break*/, 6];\n                        return [4 /*yield*/, (_a = this.callbacks)[0].apply(_a, __spreadArray([], __read(args), false))];\n                    case 1:\n                        result = _b.sent();\n                        i = 0;\n                        _b.label = 2;\n                    case 2:\n                        if (!(i < this.callbacks.length - 1)) return [3 /*break*/, 5];\n                        callback = this.callbacks[i];\n                        return [4 /*yield*/, callback(result)];\n                    case 3:\n                        // @ts-ignore\n                        result = _b.sent();\n                        _b.label = 4;\n                    case 4:\n                        i++;\n                        return [3 /*break*/, 2];\n                    case 5: return [2 /*return*/, result];\n                    case 6: return [2 /*return*/, null];\n                }\n            });\n        });\n    };\n    return AsyncSeriesWaterfallHook;\n}());\n\nvar SyncHook = /** @class */ (function () {\n    function SyncHook() {\n        this.callbacks = [];\n    }\n    SyncHook.prototype.tap = function (options, fn) {\n        this.callbacks.push(fn);\n    };\n    SyncHook.prototype.call = function () {\n        /* eslint-disable-next-line prefer-rest-params */\n        var argsArr = arguments;\n        this.callbacks.forEach(function (callback) {\n            /* eslint-disable-next-line prefer-spread */\n            callback.apply(void 0, argsArr);\n        });\n    };\n    return SyncHook;\n}());\n\nvar SyncWaterfallHook = /** @class */ (function () {\n    function SyncWaterfallHook() {\n        this.callbacks = [];\n    }\n    SyncWaterfallHook.prototype.tap = function (options, fn) {\n        this.callbacks.push(fn);\n    };\n    SyncWaterfallHook.prototype.call = function () {\n        if (this.callbacks.length) {\n            /* eslint-disable-next-line prefer-rest-params */\n            var argsArr = arguments;\n            /* eslint-disable-next-line prefer-spread */\n            var result = this.callbacks[0].apply(void 0, argsArr);\n            for (var i = 0; i < this.callbacks.length - 1; i++) {\n                var callback = this.callbacks[i];\n                // @ts-ignore\n                result = callback(result);\n            }\n            return result;\n        }\n        return null;\n    };\n    return SyncWaterfallHook;\n}());\n\nvar genericFontFamilies = [\n    'serif',\n    'sans-serif',\n    'monospace',\n    'cursive',\n    'fantasy',\n    'system-ui',\n];\nvar stringRegExp = /([\\\"\\'])[^\\'\\\"]+\\1/;\nfunction toFontString(attributes) {\n    var _a = attributes.fontSize, fontSize = _a === void 0 ? 16 : _a, _b = attributes.fontFamily, fontFamily = _b === void 0 ? 'sans-serif' : _b, _c = attributes.fontStyle, fontStyle = _c === void 0 ? 'normal' : _c, _d = attributes.fontVariant, fontVariant = _d === void 0 ? 'normal' : _d, _e = attributes.fontWeight, fontWeight = _e === void 0 ? 'normal' : _e;\n    // build canvas api font setting from individual components. Convert a numeric this.fontSize to px\n    // const fontSizeString: string = isNumber(fontSize) ? `${fontSize}px` : fontSize.toString();\n    var fontSizeString = (isNumber(fontSize) && \"\".concat(fontSize, \"px\")) || '16px';\n    // Clean-up fontFamily property by quoting each font name\n    // this will support font names with spaces\n    var fontFamilies = fontFamily.split(',');\n    for (var i = fontFamilies.length - 1; i >= 0; i--) {\n        // Trim any extra white-space\n        var fontFamily_1 = fontFamilies[i].trim();\n        // Check if font already contains strings\n        if (!stringRegExp.test(fontFamily_1) &&\n            genericFontFamilies.indexOf(fontFamily_1) < 0) {\n            fontFamily_1 = \"\\\"\".concat(fontFamily_1, \"\\\"\");\n        }\n        fontFamilies[i] = fontFamily_1;\n    }\n    return \"\".concat(fontStyle, \" \").concat(fontVariant, \" \").concat(fontWeight, \" \").concat(fontSizeString, \" \").concat(fontFamilies.join(','));\n}\n\nfunction createSkewMatrix(skewMatrix, skewX, skewY) {\n    // Create an identity matrix\n    mat4.identity(skewMatrix);\n    // Apply skew to the matrix\n    skewMatrix[4] = Math.tan(skewX); // Skew Y axis in X direction\n    skewMatrix[1] = Math.tan(skewY); // Skew X axis in Y direction\n    return skewMatrix;\n}\nvar SCALE_EPSILON = 0.00001;\nvar tmpMat1 = mat4.create();\nvar tmpMat2 = mat4.create();\nfunction parsedTransformToMat4(transform, object) {\n    if (transform.length) {\n        var m_1 = mat4.identity(tmpMat1);\n        transform.forEach(function (parsed) {\n            var t = parsed.t, d = parsed.d;\n            if (t === 'scale') {\n                // scale(1) scale(1, 1)\n                var newScale = (d === null || d === void 0 ? void 0 : d.map(function (s) { return Math.max(s.value, SCALE_EPSILON); })) || [\n                    1, 1,\n                ];\n                mat4.fromScaling(tmpMat2, [newScale[0], newScale[1], 1]);\n            }\n            else if (t === 'scalex') {\n                var newScale = (d === null || d === void 0 ? void 0 : d.map(function (s) { return Math.max(s.value, SCALE_EPSILON); })) || [1];\n                mat4.fromScaling(tmpMat2, [newScale[0], 1, 1]);\n            }\n            else if (t === 'scaley') {\n                var newScale = (d === null || d === void 0 ? void 0 : d.map(function (s) { return Math.max(s.value, SCALE_EPSILON); })) || [1];\n                mat4.fromScaling(tmpMat2, [1, newScale[0], 1]);\n            }\n            else if (t === 'scalez') {\n                var newScale = (d === null || d === void 0 ? void 0 : d.map(function (s) { return Math.max(s.value, SCALE_EPSILON); })) || [1];\n                mat4.fromScaling(tmpMat2, [1, 1, newScale[0]]);\n            }\n            else if (t === 'scale3d') {\n                var newScale = (d === null || d === void 0 ? void 0 : d.map(function (s) { return Math.max(s.value, SCALE_EPSILON); })) || [\n                    1, 1, 1,\n                ];\n                mat4.fromScaling(tmpMat2, [newScale[0], newScale[1], newScale[2]]);\n            }\n            else if (t === 'translate') {\n                var newTranslation = d || [Opx, Opx];\n                mat4.fromTranslation(tmpMat2, [\n                    newTranslation[0].value,\n                    newTranslation[1].value,\n                    0,\n                ]);\n            }\n            else if (t === 'translatex') {\n                var newTranslation = d || [Opx];\n                mat4.fromTranslation(tmpMat2, [newTranslation[0].value, 0, 0]);\n            }\n            else if (t === 'translatey') {\n                var newTranslation = d || [Opx];\n                mat4.fromTranslation(tmpMat2, [0, newTranslation[0].value, 0]);\n            }\n            else if (t === 'translatez') {\n                var newTranslation = d || [Opx];\n                mat4.fromTranslation(tmpMat2, [0, 0, newTranslation[0].value]);\n            }\n            else if (t === 'translate3d') {\n                var newTranslation = d || [Opx, Opx, Opx];\n                mat4.fromTranslation(tmpMat2, [\n                    newTranslation[0].value,\n                    newTranslation[1].value,\n                    newTranslation[2].value,\n                ]);\n            }\n            else if (t === 'rotate') {\n                var newAngles = d || [Odeg];\n                mat4.fromZRotation(tmpMat2, deg2rad(convertAngleUnit(newAngles[0])));\n            }\n            else if (t === 'rotatex') {\n                var newAngles = d || [Odeg];\n                mat4.fromXRotation(tmpMat2, deg2rad(convertAngleUnit(newAngles[0])));\n            }\n            else if (t === 'rotatey') {\n                var newAngles = d || [Odeg];\n                mat4.fromYRotation(tmpMat2, deg2rad(convertAngleUnit(newAngles[0])));\n            }\n            else if (t === 'rotatez') {\n                var newAngles = d || [Odeg];\n                mat4.fromZRotation(tmpMat2, deg2rad(convertAngleUnit(newAngles[0])));\n            }\n            else if (t === 'rotate3d') {\n                var newAngles = d || [Opx, Opx, Opx, Odeg];\n                mat4.fromRotation(tmpMat2, deg2rad(convertAngleUnit(newAngles[3])), [\n                    newAngles[0].value,\n                    newAngles[1].value,\n                    newAngles[2].value,\n                ]);\n            }\n            else if (t === 'skew') {\n                var newSkew = (d === null || d === void 0 ? void 0 : d.map(function (s) { return s.value; })) || [0, 0];\n                createSkewMatrix(tmpMat2, deg2rad(newSkew[0]), deg2rad(newSkew[1]));\n            }\n            else if (t === 'skewx') {\n                var newSkew = (d === null || d === void 0 ? void 0 : d.map(function (s) { return s.value; })) || [0];\n                createSkewMatrix(tmpMat2, deg2rad(newSkew[0]), 0);\n            }\n            else if (t === 'skewy') {\n                var newSkew = (d === null || d === void 0 ? void 0 : d.map(function (s) { return s.value; })) || [0];\n                createSkewMatrix(tmpMat2, 0, deg2rad(newSkew[0]));\n            }\n            else if (t === 'matrix') {\n                var _a = __read(d.map(function (s) { return s.value; }), 6), a = _a[0], b = _a[1], c = _a[2], dd = _a[3], tx = _a[4], ty = _a[5];\n                mat4.set(tmpMat2, a, b, 0, 0, c, dd, 0, 0, 0, 0, 1, 0, tx, ty, 0, 1);\n            }\n            else if (t === 'matrix3d') {\n                // @ts-ignore\n                mat4.set.apply(mat4, __spreadArray([tmpMat2], __read(d.map(function (s) { return s.value; })), false));\n            }\n            mat4.mul(m_1, m_1, tmpMat2);\n        });\n        object.setLocalTransform(m_1);\n    }\n    else {\n        object.resetLocalTransform();\n    }\n    return object.getLocalTransform();\n}\n\n/**\n * @see /zh/docs/api/animation#支持变换的属性\n *\n * support the following formats like CSS Transform:\n *\n * scale\n * * scale(x, y)\n * * scaleX(x)\n * * scaleY(x)\n * * scaleZ(z)\n * * scale3d(x, y, z)\n *\n * translate (unit: none, px, %(relative to its bounds))\n * * translate(x, y) eg. translate(0, 0) translate(0, 30px) translate(100%, 100%)\n * * translateX(0)\n * * translateY(0)\n * * translateZ(0)\n * * translate3d(0, 0, 0)\n *\n * rotate (unit: deg rad turn)\n * * rotate(0.5turn) rotate(30deg) rotate(1rad)\n *\n * none\n *\n * unsupported for now:\n * * calc() eg. translate(calc(100% + 10px))\n * * matrix/matrix3d()\n * * skew/skewX/skewY\n * * perspective\n */\nvar CSSPropertyTransform = /** @class */ (function () {\n    function CSSPropertyTransform() {\n        this.parser = parseTransform;\n        this.parserUnmemoize = parseTransformUnmemoize;\n        this.parserWithCSSDisabled = parseTransformUnmemoize;\n        this.mixer = mergeTransforms;\n    }\n    CSSPropertyTransform.prototype.calculator = function (name, oldParsed, parsed, object) {\n        // 'none'\n        if (parsed instanceof CSSKeywordValue) {\n            return [];\n        }\n        return parsed;\n    };\n    CSSPropertyTransform.prototype.postProcessor = function (object) {\n        var transform = object.parsedStyle.transform;\n        parsedTransformToMat4(transform, object);\n    };\n    return CSSPropertyTransform;\n}());\n\n/**\n * @see https://developer.mozilla.org/zh-CN/docs/Web/CSS/transform-origin\n * @example\n * [10px, 10px] [10%, 10%]\n */\nvar CSSPropertyTransformOrigin = /** @class */ (function () {\n    function CSSPropertyTransformOrigin() {\n        this.parser = parseTransformOrigin;\n        this.parserUnmemoize = parseTransformOriginUnmemoize;\n    }\n    CSSPropertyTransformOrigin.prototype.postProcessor = function (object) {\n        var transformOrigin = object.parsedStyle.transformOrigin;\n        if (transformOrigin[0].unit === UnitType.kPixels &&\n            transformOrigin[1].unit === UnitType.kPixels) {\n            object.setOrigin(transformOrigin[0].value, transformOrigin[1].value);\n        }\n        else {\n            // Relative to geometry bounds, calculate later.\n            object.getGeometryBounds();\n        }\n    };\n    return CSSPropertyTransformOrigin;\n}());\n\nvar CSSPropertyZIndex = /** @class */ (function () {\n    function CSSPropertyZIndex() {\n        this.parser = parseNumber;\n        this.parserUnmemoize = parseNumberUnmemoize;\n    }\n    CSSPropertyZIndex.prototype.calculator = function (name, oldParsed, computed, object) {\n        return computed.value;\n    };\n    CSSPropertyZIndex.prototype.postProcessor = function (object) {\n        if (object.parentNode) {\n            var parentEntity = object.parentNode;\n            var parentRenderable = parentEntity.renderable;\n            var parentSortable = parentEntity.sortable;\n            if (parentRenderable) {\n                parentRenderable.dirty = true;\n            }\n            // need re-sort on parent\n            if (parentSortable) {\n                parentSortable.dirty = true;\n                parentSortable.dirtyReason = SortReason.Z_INDEX_CHANGED;\n            }\n        }\n    };\n    return CSSPropertyZIndex;\n}());\n\nvar CircleUpdater = /** @class */ (function () {\n    function CircleUpdater() {\n    }\n    CircleUpdater.prototype.update = function (parsedStyle, object) {\n        var _a = parsedStyle.cx, cx = _a === void 0 ? 0 : _a, _b = parsedStyle.cy, cy = _b === void 0 ? 0 : _b, _c = parsedStyle.r, r = _c === void 0 ? 0 : _c;\n        return {\n            cx: cx,\n            cy: cy,\n            hwidth: r,\n            hheight: r,\n        };\n    };\n    return CircleUpdater;\n}());\n\nvar EllipseUpdater = /** @class */ (function () {\n    function EllipseUpdater() {\n    }\n    EllipseUpdater.prototype.update = function (parsedStyle, object) {\n        var _a = parsedStyle.cx, cx = _a === void 0 ? 0 : _a, _b = parsedStyle.cy, cy = _b === void 0 ? 0 : _b, _c = parsedStyle.rx, rx = _c === void 0 ? 0 : _c, _d = parsedStyle.ry, ry = _d === void 0 ? 0 : _d;\n        return {\n            cx: cx,\n            cy: cy,\n            hwidth: rx,\n            hheight: ry,\n        };\n    };\n    return EllipseUpdater;\n}());\n\nvar LineUpdater = /** @class */ (function () {\n    function LineUpdater() {\n    }\n    LineUpdater.prototype.update = function (parsedStyle) {\n        var x1 = parsedStyle.x1, y1 = parsedStyle.y1, x2 = parsedStyle.x2, y2 = parsedStyle.y2;\n        var minX = Math.min(x1, x2);\n        var maxX = Math.max(x1, x2);\n        var minY = Math.min(y1, y2);\n        var maxY = Math.max(y1, y2);\n        var width = maxX - minX;\n        var height = maxY - minY;\n        var hwidth = width / 2;\n        var hheight = height / 2;\n        return {\n            cx: minX + hwidth,\n            cy: minY + hheight,\n            hwidth: hwidth,\n            hheight: hheight,\n        };\n    };\n    return LineUpdater;\n}());\n\nvar PathUpdater = /** @class */ (function () {\n    function PathUpdater() {\n    }\n    PathUpdater.prototype.update = function (parsedStyle) {\n        var d = parsedStyle.d;\n        var _a = d.rect, x = _a.x, y = _a.y, width = _a.width, height = _a.height;\n        var hwidth = width / 2;\n        var hheight = height / 2;\n        return {\n            cx: x + hwidth,\n            cy: y + hheight,\n            hwidth: hwidth,\n            hheight: hheight,\n        };\n    };\n    return PathUpdater;\n}());\n\nvar PolylineUpdater = /** @class */ (function () {\n    function PolylineUpdater() {\n    }\n    PolylineUpdater.prototype.update = function (parsedStyle) {\n        if (parsedStyle.points && isArray(parsedStyle.points.points)) {\n            var points = parsedStyle.points.points;\n            // FIXME: account for miter lineJoin\n            var minX = Math.min.apply(Math, __spreadArray([], __read(points.map(function (point) { return point[0]; })), false));\n            var maxX = Math.max.apply(Math, __spreadArray([], __read(points.map(function (point) { return point[0]; })), false));\n            var minY = Math.min.apply(Math, __spreadArray([], __read(points.map(function (point) { return point[1]; })), false));\n            var maxY = Math.max.apply(Math, __spreadArray([], __read(points.map(function (point) { return point[1]; })), false));\n            var width = maxX - minX;\n            var height = maxY - minY;\n            var hwidth = width / 2;\n            var hheight = height / 2;\n            return {\n                cx: minX + hwidth,\n                cy: minY + hheight,\n                hwidth: hwidth,\n                hheight: hheight,\n            };\n        }\n        return {\n            cx: 0,\n            cy: 0,\n            hwidth: 0,\n            hheight: 0,\n        };\n    };\n    return PolylineUpdater;\n}());\n\nvar RectUpdater = /** @class */ (function () {\n    function RectUpdater() {\n    }\n    RectUpdater.prototype.update = function (parsedStyle, object) {\n        var _a = parsedStyle.x, x = _a === void 0 ? 0 : _a, _b = parsedStyle.y, y = _b === void 0 ? 0 : _b, src = parsedStyle.src, _c = parsedStyle.width, width = _c === void 0 ? 0 : _c, _d = parsedStyle.height, height = _d === void 0 ? 0 : _d;\n        var contentWidth = width;\n        var contentHeight = height;\n        // resize with HTMLImageElement's size\n        if (src && !isString(src)) {\n            if (!contentWidth) {\n                contentWidth = src.width;\n                parsedStyle.width = contentWidth;\n            }\n            if (!contentHeight) {\n                contentHeight = src.height;\n                parsedStyle.height = contentHeight;\n            }\n        }\n        return {\n            cx: x + contentWidth / 2,\n            cy: y + contentHeight / 2,\n            hwidth: contentWidth / 2,\n            hheight: contentHeight / 2,\n        };\n    };\n    return RectUpdater;\n}());\n\nvar TextUpdater = /** @class */ (function () {\n    function TextUpdater(globalRuntime) {\n        this.globalRuntime = globalRuntime;\n    }\n    TextUpdater.prototype.isReadyToMeasure = function (parsedStyle, object) {\n        var text = parsedStyle.text, textAlign = parsedStyle.textAlign, textBaseline = parsedStyle.textBaseline, fontSize = parsedStyle.fontSize, fontStyle = parsedStyle.fontStyle, fontWeight = parsedStyle.fontWeight, fontVariant = parsedStyle.fontVariant, lineWidth = parsedStyle.lineWidth;\n        return runtime.enableCSSParsing\n            ? text &&\n                fontSize &&\n                fontStyle &&\n                fontWeight &&\n                fontVariant &&\n                textAlign &&\n                textBaseline &&\n                !isNil(lineWidth)\n            : text;\n    };\n    TextUpdater.prototype.update = function (parsedStyle, object) {\n        var _a, _b;\n        var text = parsedStyle.text, _c = parsedStyle.textAlign, textAlign = _c === void 0 ? 'start' : _c, _d = parsedStyle.lineWidth, lineWidth = _d === void 0 ? 1 : _d, _e = parsedStyle.textBaseline, textBaseline = _e === void 0 ? 'alphabetic' : _e, _f = parsedStyle.dx, dx = _f === void 0 ? 0 : _f, _g = parsedStyle.dy, dy = _g === void 0 ? 0 : _g, _h = parsedStyle.x, x = _h === void 0 ? 0 : _h, _j = parsedStyle.y, y = _j === void 0 ? 0 : _j;\n        if (!this.isReadyToMeasure(parsedStyle, object)) {\n            parsedStyle.metrics = {\n                font: '',\n                width: 0,\n                height: 0,\n                lines: [],\n                lineWidths: [],\n                lineHeight: 0,\n                maxLineWidth: 0,\n                fontProperties: {\n                    ascent: 0,\n                    descent: 0,\n                    fontSize: 0,\n                },\n                lineMetrics: [],\n            };\n            return {\n                hwidth: 0,\n                hheight: 0,\n                cx: 0,\n                cy: 0,\n            };\n        }\n        var offscreenCanvas = (((_b = (_a = object === null || object === void 0 ? void 0 : object.ownerDocument) === null || _a === void 0 ? void 0 : _a.defaultView) === null || _b === void 0 ? void 0 : _b.getConfig()) || {}).offscreenCanvas;\n        var metrics = this.globalRuntime.textService.measureText(text, parsedStyle, offscreenCanvas);\n        parsedStyle.metrics = metrics;\n        var width = metrics.width, height = metrics.height, lineHeight = metrics.lineHeight, fontProperties = metrics.fontProperties;\n        var hwidth = width / 2;\n        var hheight = height / 2;\n        // default 'left'\n        var lineXOffset = x + hwidth;\n        if (textAlign === 'center' || textAlign === 'middle') {\n            lineXOffset += lineWidth / 2 - hwidth;\n        }\n        else if (textAlign === 'right' || textAlign === 'end') {\n            lineXOffset += lineWidth - hwidth * 2;\n        }\n        var lineYOffset = y - hheight;\n        if (textBaseline === 'middle') {\n            // eslint-disable-next-line prefer-destructuring\n            lineYOffset += hheight;\n        }\n        else if (textBaseline === 'top' || textBaseline === 'hanging') {\n            lineYOffset += hheight * 2;\n        }\n        else if (textBaseline === 'alphabetic') {\n            // prevent calling getImageData for ascent metrics\n            lineYOffset += this.globalRuntime.enableCSSParsing\n                ? lineHeight - fontProperties.ascent\n                : 0;\n        }\n        else if (textBaseline === 'bottom' || textBaseline === 'ideographic') {\n            lineYOffset += 0;\n        }\n        // TODO: ideographic & bottom\n        if (dx) {\n            lineXOffset += dx;\n        }\n        if (dy) {\n            lineYOffset += dy;\n        }\n        return {\n            cx: lineXOffset,\n            cy: lineYOffset,\n            hwidth: hwidth,\n            hheight: hheight,\n        };\n    };\n    return TextUpdater;\n}());\n\nvar GroupUpdater = /** @class */ (function () {\n    function GroupUpdater() {\n    }\n    GroupUpdater.prototype.update = function (parsedStyle, object) {\n        return {\n            cx: 0,\n            cy: 0,\n            hwidth: 0,\n            hheight: 0,\n        };\n    };\n    return GroupUpdater;\n}());\n\nfunction isFederatedEvent(value) {\n    return !!value.type;\n}\n/**\n * An DOM-compatible synthetic event implementation that is \"forwarded\" on behalf of an original\n * FederatedEvent or native Event.\n */\nvar FederatedEvent = /** @class */ (function () {\n    /**\n     * The event boundary which manages this event. Propagation can only occur\n     *  within the boundary's jurisdiction.\n     */\n    function FederatedEvent(manager) {\n        /**\n         * The propagation phase.\n         * @see https://developer.mozilla.org/en-US/docs/Web/API/Event/eventPhase\n         */\n        this.eventPhase = FederatedEvent.prototype.NONE;\n        /**\n         * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Event/bubbles\n         */\n        this.bubbles = true;\n        /**\n         * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Event/cancelBubble\n         */\n        this.cancelBubble = true;\n        /**\n         * @see https://developer.mozilla.org/en-US/docs/Web/API/Event/cancelable\n         */\n        this.cancelable = false;\n        /** Flags whether the default response of the user agent was prevent through this event. */\n        this.defaultPrevented = false;\n        /** Flags whether propagation was stopped. */\n        this.propagationStopped = false;\n        /** Flags whether propagation was immediately stopped. */\n        this.propagationImmediatelyStopped = false;\n        /**\n         * The coordinates of the evnet relative to the nearest DOM layer.\n         * This is a non-standard property.\n         */\n        this.layer = new Point();\n        /**\n         * The coordinates of the event relative to the DOM document.\n         * This is a non-standard property.\n         * relative to the DOM document.\n         * @see https://developer.mozilla.org/zh-CN/docs/Web/API/MouseEvent/pageX\n         */\n        this.page = new Point();\n        /**\n         * relative to Canvas, origin is left-top\n         */\n        this.canvas = new Point();\n        /**\n         * relative to Viewport, account for Camera\n         */\n        this.viewport = new Point();\n        this.composed = false;\n        this.NONE = 0;\n        this.CAPTURING_PHASE = 1;\n        this.AT_TARGET = 2;\n        this.BUBBLING_PHASE = 3;\n        this.manager = manager;\n    }\n    Object.defineProperty(FederatedEvent.prototype, \"name\", {\n        /**\n         * @deprecated\n         */\n        get: function () {\n            return this.type;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(FederatedEvent.prototype, \"layerX\", {\n        get: function () {\n            return this.layer.x;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(FederatedEvent.prototype, \"layerY\", {\n        get: function () {\n            return this.layer.y;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(FederatedEvent.prototype, \"pageX\", {\n        get: function () {\n            return this.page.x;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(FederatedEvent.prototype, \"pageY\", {\n        get: function () {\n            return this.page.y;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(FederatedEvent.prototype, \"x\", {\n        get: function () {\n            return this.canvas.x;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(FederatedEvent.prototype, \"y\", {\n        get: function () {\n            return this.canvas.y;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(FederatedEvent.prototype, \"canvasX\", {\n        get: function () {\n            return this.canvas.x;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(FederatedEvent.prototype, \"canvasY\", {\n        get: function () {\n            return this.canvas.y;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(FederatedEvent.prototype, \"viewportX\", {\n        get: function () {\n            return this.viewport.x;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(FederatedEvent.prototype, \"viewportY\", {\n        get: function () {\n            return this.viewport.y;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * The propagation path for this event\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Event/composedPath\n     *\n     * So composedPath()[0] represents the original target.\n     * @see https://polymer-library.polymer-project.org/3.0/docs/devguide/events#retargeting\n     */\n    FederatedEvent.prototype.composedPath = function () {\n        if (this.manager && (!this.path || this.path[0] !== this.target)) {\n            this.path = this.target ? this.manager.propagationPath(this.target) : [];\n        }\n        return this.path;\n    };\n    Object.defineProperty(FederatedEvent.prototype, \"propagationPath\", {\n        /**\n         * @deprecated\n         */\n        get: function () {\n            return this.composedPath();\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Event/preventDefault\n     */\n    FederatedEvent.prototype.preventDefault = function () {\n        if (this.nativeEvent instanceof Event && this.nativeEvent.cancelable) {\n            this.nativeEvent.preventDefault();\n        }\n        this.defaultPrevented = true;\n    };\n    /**\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Event/stopImmediatePropagation\n     */\n    FederatedEvent.prototype.stopImmediatePropagation = function () {\n        this.propagationImmediatelyStopped = true;\n    };\n    /**\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Event/stopPropagation\n     */\n    FederatedEvent.prototype.stopPropagation = function () {\n        this.propagationStopped = true;\n    };\n    /**\n     * added for compatibility with DOM Event,\n     * deprecated props and methods\n     */\n    FederatedEvent.prototype.initEvent = function () { };\n    FederatedEvent.prototype.initUIEvent = function () { };\n    FederatedEvent.prototype.clone = function () {\n        throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED);\n    };\n    return FederatedEvent;\n}());\n\nvar FederatedMouseEvent = /** @class */ (function (_super) {\n    __extends(FederatedMouseEvent, _super);\n    function FederatedMouseEvent() {\n        var _this = _super.apply(this, __spreadArray([], __read(arguments), false)) || this;\n        /**\n         * The coordinates of the mouse event relative to the canvas.\n         */\n        _this.client = new Point();\n        /**\n         * The movement in this pointer relative to the last `mousemove` event.\n         */\n        _this.movement = new Point();\n        /**\n         * The offset of the pointer coordinates w.r.t. target DisplayObject in world space. This is\n         * not supported at the moment.\n         */\n        _this.offset = new Point();\n        /**\n         * The pointer coordinates in world space.\n         */\n        _this.global = new Point();\n        /**\n         * The pointer coordinates in sceen space.\n         */\n        _this.screen = new Point();\n        return _this;\n    }\n    Object.defineProperty(FederatedMouseEvent.prototype, \"clientX\", {\n        get: function () {\n            return this.client.x;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(FederatedMouseEvent.prototype, \"clientY\", {\n        get: function () {\n            return this.client.y;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(FederatedMouseEvent.prototype, \"movementX\", {\n        get: function () {\n            return this.movement.x;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(FederatedMouseEvent.prototype, \"movementY\", {\n        get: function () {\n            return this.movement.y;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(FederatedMouseEvent.prototype, \"offsetX\", {\n        get: function () {\n            return this.offset.x;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(FederatedMouseEvent.prototype, \"offsetY\", {\n        get: function () {\n            return this.offset.y;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(FederatedMouseEvent.prototype, \"globalX\", {\n        get: function () {\n            return this.global.x;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(FederatedMouseEvent.prototype, \"globalY\", {\n        get: function () {\n            return this.global.y;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(FederatedMouseEvent.prototype, \"screenX\", {\n        get: function () {\n            return this.screen.x;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(FederatedMouseEvent.prototype, \"screenY\", {\n        get: function () {\n            return this.screen.y;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    FederatedMouseEvent.prototype.getModifierState = function (key) {\n        return ('getModifierState' in this.nativeEvent &&\n            this.nativeEvent.getModifierState(key));\n    };\n    FederatedMouseEvent.prototype.initMouseEvent = function () {\n        throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED);\n    };\n    return FederatedMouseEvent;\n}(FederatedEvent));\n\n// @ts-ignore\nvar FederatedPointerEvent = /** @class */ (function (_super) {\n    __extends(FederatedPointerEvent, _super);\n    function FederatedPointerEvent() {\n        var _this = _super.apply(this, __spreadArray([], __read(arguments), false)) || this;\n        /**\n         * The width of the pointer's contact along the x-axis, measured in CSS pixels.\n         * radiusX of TouchEvents will be represented by this value.\n         *\n         * @see https://developer.mozilla.org/en-US/docs/Web/API/PointerEvent/width\n         */\n        _this.width = 0;\n        /**\n         * The height of the pointer's contact along the y-axis, measured in CSS pixels.\n         * radiusY of TouchEvents will be represented by this value.\n         *\n         * @see https://developer.mozilla.org/en-US/docs/Web/API/PointerEvent/height\n         */\n        _this.height = 0;\n        /**\n         * Indicates whether or not the pointer device that created the event is the primary pointer.\n         *\n         * @see https://developer.mozilla.org/en-US/docs/Web/API/PointerEvent/isPrimary\n         */\n        _this.isPrimary = false;\n        return _this;\n    }\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/PointerEvent/getCoalescedEvents\n     */\n    FederatedPointerEvent.prototype.getCoalescedEvents = function () {\n        if (this.type === 'pointermove' ||\n            this.type === 'mousemove' ||\n            this.type === 'touchmove') {\n            // @ts-ignore\n            return [this];\n        }\n        return [];\n    };\n    /**\n     * @see https://chromestatus.com/feature/5765569655603200\n     */\n    FederatedPointerEvent.prototype.getPredictedEvents = function () {\n        throw new Error('getPredictedEvents is not supported!');\n    };\n    /**\n     * @see https://github.com/antvis/G/issues/1115\n     * We currently reuses event objects in the event system,\n     * avoiding the creation of a large number of event objects.\n     * Reused objects are only used to carry different data,\n     * such as coordinate information, native event objects,\n     * and therefore the lifecycle is limited to the event handler,\n     * which can lead to unintended consequences if an attempt is made to cache the entire event object.\n     *\n     * Therefore, while keeping the above performance considerations in mind, it is possible to provide a clone method that creates a new object when the user really wants to cache it, e.g.\n     */\n    FederatedPointerEvent.prototype.clone = function () {\n        return this.manager.clonePointerEvent(this);\n    };\n    return FederatedPointerEvent;\n}(FederatedMouseEvent));\n\n// @ts-ignore\nvar FederatedWheelEvent = /** @class */ (function (_super) {\n    __extends(FederatedWheelEvent, _super);\n    function FederatedWheelEvent() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    FederatedWheelEvent.prototype.clone = function () {\n        return this.manager.cloneWheelEvent(this);\n    };\n    return FederatedWheelEvent;\n}(FederatedMouseEvent));\n\n/**\n * @see https://developer.mozilla.org/en-US/docs/Web/Events/Creating_and_triggering_events\n *\n * @example\n  const event = new CustomEvent('build', { detail: { prop1: 'xx' } });\n  circle.addEventListener('build', (e) => {\n    e.target; // circle\n    e.detail; // { prop1: 'xx' }\n  });\n\n  circle.dispatchEvent(event);\n */\nvar CustomEvent = /** @class */ (function (_super) {\n    __extends(CustomEvent, _super);\n    // eslint-disable-next-line @typescript-eslint/ban-types\n    function CustomEvent(eventName, object) {\n        var _this = _super.call(this, null) || this;\n        _this.type = eventName;\n        _this.detail = object;\n        // compatible with G 3.0\n        Object.assign(_this, object);\n        return _this;\n    }\n    return CustomEvent;\n}(FederatedEvent));\n\nvar DELEGATION_SPLITTER = ':';\n/**\n * Objects that can receive events and may have listeners for them.\n * eg. Element, Canvas, DisplayObject\n * @see https://developer.mozilla.org/en-US/docs/Web/API/EventTarget\n */\nvar EventTarget = /** @class */ (function () {\n    function EventTarget() {\n        /**\n         * event emitter\n         */\n        this.emitter = new EventEmitter();\n    }\n    /**\n     * @deprecated\n     * @alias addEventListener\n     */\n    EventTarget.prototype.on = function (type, listener, options) {\n        this.addEventListener(type, listener, options);\n        return this;\n    };\n    /**\n     * support `capture` & `once` in options\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/EventTarget/addEventListener\n     */\n    EventTarget.prototype.addEventListener = function (type, listener, options) {\n        var capture = (isBoolean(options) && options) || (isObject(options) && options.capture);\n        var once = isObject(options) && options.once;\n        var context = isFunction(listener) ? undefined : listener;\n        // compatible with G 3.0\n        // support using delegate name in event type, eg. 'node:click'\n        var useDelegatedName = false;\n        var delegatedName = '';\n        if (type.indexOf(DELEGATION_SPLITTER) > -1) {\n            var _a = __read(type.split(DELEGATION_SPLITTER), 2), name_1 = _a[0], eventType = _a[1];\n            type = eventType;\n            delegatedName = name_1;\n            useDelegatedName = true;\n        }\n        type = capture ? \"\".concat(type, \"capture\") : type;\n        listener = isFunction(listener) ? listener : listener.handleEvent;\n        // compatible with G 3.0\n        if (useDelegatedName) {\n            var originListener_1 = listener;\n            listener = function () {\n                var _a;\n                var args = [];\n                for (var _i = 0; _i < arguments.length; _i++) {\n                    args[_i] = arguments[_i];\n                }\n                if (((_a = args[0].target) === null || _a === void 0 ? void 0 : _a.name) !== delegatedName) {\n                    return;\n                }\n                // @ts-ignore\n                originListener_1.apply(void 0, __spreadArray([], __read(args), false));\n            };\n        }\n        if (once) {\n            this.emitter.once(type, listener, context);\n        }\n        else {\n            this.emitter.on(type, listener, context);\n        }\n        return this;\n    };\n    /**\n     * @deprecated\n     * @alias removeEventListener\n     */\n    EventTarget.prototype.off = function (type, listener, options) {\n        if (type) {\n            this.removeEventListener(type, listener, options);\n        }\n        else {\n            // remove all listeners\n            this.removeAllEventListeners();\n        }\n        return this;\n    };\n    EventTarget.prototype.removeAllEventListeners = function () {\n        this.emitter.removeAllListeners();\n    };\n    EventTarget.prototype.removeEventListener = function (type, listener, options) {\n        var capture = (isBoolean(options) && options) || (isObject(options) && options.capture);\n        var context = isFunction(listener) ? undefined : listener;\n        type = capture ? \"\".concat(type, \"capture\") : type;\n        listener = isFunction(listener) ? listener : listener === null || listener === void 0 ? void 0 : listener.handleEvent;\n        this.emitter.off(type, listener, context);\n        return this;\n    };\n    /**\n     * @deprecated\n     * @alias dispatchEvent\n     */\n    // eslint-disable-next-line @typescript-eslint/ban-types\n    EventTarget.prototype.emit = function (eventName, object) {\n        this.dispatchEvent(new CustomEvent(eventName, object));\n    };\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/dispatchEvent\n     */\n    EventTarget.prototype.dispatchEvent = function (e, skipPropagate) {\n        var _a, _b;\n        if (skipPropagate === void 0) { skipPropagate = false; }\n        if (!isFederatedEvent(e)) {\n            throw new Error('DisplayObject cannot propagate events outside of the Federated Events API');\n        }\n        // should account for Element / Document / Canvas\n        var canvas;\n        // @ts-ignore\n        if (this.document) {\n            canvas = this;\n            // @ts-ignore\n        }\n        else if (this.defaultView) {\n            canvas = this.defaultView;\n        }\n        else {\n            canvas = (_a = this.ownerDocument) === null || _a === void 0 ? void 0 : _a.defaultView;\n        }\n        // assign event manager\n        if (canvas) {\n            e.manager = canvas.getEventService() || null;\n            if (!e.manager) {\n                return false;\n            }\n            e.defaultPrevented = false;\n            e.path = [];\n            if (!skipPropagate) {\n                e.target = this;\n            }\n            (_b = e.manager) === null || _b === void 0 ? void 0 : _b.dispatchEvent(e, e.type, skipPropagate);\n        }\n        return !e.defaultPrevented;\n    };\n    return EventTarget;\n}());\n\n/**\n * @see https://developer.mozilla.org/en-US/docs/Web/API/Node\n */\nvar Node = /** @class */ (function (_super) {\n    __extends(Node, _super);\n    function Node() {\n        var _this = _super.call(this) || this;\n        _this.shadow = false;\n        /**\n         * points to canvas.document\n         * @see https://developer.mozilla.org/en-US/docs/Web/API/Node/ownerDocument\n         */\n        _this.ownerDocument = null;\n        /**\n         * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Node/isConnected\n         * @example\n            circle.isConnected; // false\n            canvas.appendChild(circle);\n            circle.isConnected; // true\n         */\n        _this.isConnected = false;\n        /**\n         * Returns node's node document's document base URL.\n         * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Node\n         */\n        _this.baseURI = '';\n        /**\n         * Returns the children.\n         * @see https://developer.mozilla.org/en-US/docs/Web/API/Node/childNodes\n         */\n        _this.childNodes = [];\n        /**\n         * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Node/nodeType\n         */\n        _this.nodeType = 0;\n        /**\n         * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Node/nodeName\n         */\n        _this.nodeName = '';\n        /**\n         * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Node/nodeValue\n         */\n        _this.nodeValue = null;\n        /**\n         * @see https://developer.mozilla.org/en-US/docs/Web/API/ParentNode\n         */\n        _this.parentNode = null;\n        return _this;\n    }\n    Node.isNode = function (target) {\n        return !!target.childNodes;\n    };\n    Object.defineProperty(Node.prototype, \"textContent\", {\n        /**\n         * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Node/textContent\n         */\n        get: function () {\n            var e_1, _a;\n            var out = '';\n            if (this.nodeName === Shape.TEXT) {\n                // @ts-ignore\n                out += this.style.text;\n            }\n            try {\n                for (var _b = __values(this.childNodes), _c = _b.next(); !_c.done; _c = _b.next()) {\n                    var child = _c.value;\n                    if (child.nodeName === Shape.TEXT) {\n                        out += child.nodeValue;\n                    }\n                    else {\n                        out += child.textContent;\n                    }\n                }\n            }\n            catch (e_1_1) { e_1 = { error: e_1_1 }; }\n            finally {\n                try {\n                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n                }\n                finally { if (e_1) throw e_1.error; }\n            }\n            return out;\n        },\n        set: function (content) {\n            var _this = this;\n            // remove all children\n            this.childNodes.slice().forEach(function (child) {\n                _this.removeChild(child);\n            });\n            if (this.nodeName === Shape.TEXT) {\n                // @ts-ignore\n                this.style.text = \"\".concat(content);\n            }\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Node/getRootNode\n     */\n    Node.prototype.getRootNode = function (opts) {\n        if (opts === void 0) { opts = {}; }\n        if (this.parentNode) {\n            return this.parentNode.getRootNode(opts);\n        }\n        if (opts.composed && this.host) {\n            return this.host.getRootNode(opts);\n        }\n        return this;\n    };\n    Node.prototype.hasChildNodes = function () {\n        return this.childNodes.length > 0;\n    };\n    Node.prototype.isDefaultNamespace = function (namespace) {\n        throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED);\n    };\n    Node.prototype.lookupNamespaceURI = function (prefix) {\n        throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED);\n    };\n    Node.prototype.lookupPrefix = function (namespace) {\n        throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED);\n    };\n    Node.prototype.normalize = function () {\n        throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED);\n    };\n    /**\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Node/isEqualNode\n     */\n    Node.prototype.isEqualNode = function (otherNode) {\n        // TODO: compare 2 nodes, not sameness\n        return this === otherNode;\n    };\n    Node.prototype.isSameNode = function (otherNode) {\n        return this.isEqualNode(otherNode);\n    };\n    Object.defineProperty(Node.prototype, \"parent\", {\n        /**\n         * @deprecated\n         * @alias parentNode\n         */\n        get: function () {\n            return this.parentNode;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Node.prototype, \"parentElement\", {\n        get: function () {\n            return null;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Node.prototype, \"nextSibling\", {\n        get: function () {\n            return null;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Node.prototype, \"previousSibling\", {\n        get: function () {\n            return null;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Node.prototype, \"firstChild\", {\n        get: function () {\n            return this.childNodes.length > 0 ? this.childNodes[0] : null;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Node.prototype, \"lastChild\", {\n        get: function () {\n            return this.childNodes.length > 0\n                ? this.childNodes[this.childNodes.length - 1]\n                : null;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Node/compareDocumentPosition\n     * @see https://github.com/b-fuze/deno-dom/blob/master/src/dom/node.ts#L338\n     */\n    Node.prototype.compareDocumentPosition = function (other) {\n        var _a;\n        if (other === this) {\n            // same node\n            return 0;\n        }\n        // if (!(other instanceof Node)) {\n        //   throw new TypeError(\n        //     'Node.compareDocumentPosition: Argument 1 does not implement interface Node.',\n        //   );\n        // }\n        var node1Root = other;\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        var node2Root = this;\n        var node1Hierarchy = [node1Root];\n        var node2Hierarchy = [node2Root];\n        while ((_a = node1Root.parentNode) !== null && _a !== void 0 ? _a : node2Root.parentNode) {\n            node1Root = node1Root.parentNode\n                ? (node1Hierarchy.push(node1Root.parentNode), node1Root.parentNode)\n                : node1Root;\n            node2Root = node2Root.parentNode\n                ? (node2Hierarchy.push(node2Root.parentNode), node2Root.parentNode)\n                : node2Root;\n        }\n        // Check if they don't share the same root node\n        if (node1Root !== node2Root) {\n            return (Node.DOCUMENT_POSITION_DISCONNECTED |\n                Node.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC |\n                Node.DOCUMENT_POSITION_PRECEDING);\n        }\n        var longerHierarchy = node1Hierarchy.length > node2Hierarchy.length\n            ? node1Hierarchy\n            : node2Hierarchy;\n        var shorterHierarchy = longerHierarchy === node1Hierarchy ? node2Hierarchy : node1Hierarchy;\n        // Check if either is a container of the other\n        if (longerHierarchy[longerHierarchy.length - shorterHierarchy.length] ===\n            shorterHierarchy[0]) {\n            return longerHierarchy === node1Hierarchy\n                ? // other is a child of this\n                    Node.DOCUMENT_POSITION_CONTAINED_BY | Node.DOCUMENT_POSITION_FOLLOWING\n                : // this is a child of other\n                    Node.DOCUMENT_POSITION_CONTAINS | Node.DOCUMENT_POSITION_PRECEDING;\n        }\n        // Find their first common ancestor and see whether they\n        // are preceding or following\n        var longerStart = longerHierarchy.length - shorterHierarchy.length;\n        for (var i = shorterHierarchy.length - 1; i >= 0; i--) {\n            var shorterHierarchyNode = shorterHierarchy[i];\n            var longerHierarchyNode = longerHierarchy[longerStart + i];\n            // We found the first common ancestor\n            if (longerHierarchyNode !== shorterHierarchyNode) {\n                var siblings = shorterHierarchyNode.parentNode.childNodes;\n                if (siblings.indexOf(shorterHierarchyNode) <\n                    siblings.indexOf(longerHierarchyNode)) {\n                    // Shorter is before longer\n                    if (shorterHierarchy === node1Hierarchy) {\n                        // Other is before this\n                        return Node.DOCUMENT_POSITION_PRECEDING;\n                    }\n                    else {\n                        // This is before other\n                        return Node.DOCUMENT_POSITION_FOLLOWING;\n                    }\n                }\n                else {\n                    // Longer is before shorter\n                    if (longerHierarchy === node1Hierarchy) {\n                        // Other is before this\n                        return Node.DOCUMENT_POSITION_PRECEDING;\n                    }\n                    else {\n                        // Other is after this\n                        return Node.DOCUMENT_POSITION_FOLLOWING;\n                    }\n                }\n            }\n        }\n        return Node.DOCUMENT_POSITION_FOLLOWING;\n    };\n    /**\n     * @deprecated\n     * @alias contains\n     */\n    Node.prototype.contain = function (other) {\n        return this.contains(other);\n    };\n    Node.prototype.contains = function (other) {\n        // the node itself, one of its direct children\n        var tmp = other;\n        // @see https://developer.mozilla.org/en-US/docs/Web/API/Node/contains\n        while (tmp && this !== tmp) {\n            tmp = tmp.parentNode;\n        }\n        return !!tmp;\n    };\n    Node.prototype.getAncestor = function (n) {\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        var temp = this;\n        while (n > 0 && temp) {\n            temp = temp.parentNode;\n            n--;\n        }\n        return temp;\n    };\n    Node.prototype.forEach = function (callback, assigned) {\n        if (assigned === void 0) { assigned = false; }\n        if (!callback(this)) {\n            (assigned ? this.childNodes.slice() : this.childNodes).forEach(function (child) {\n                child.forEach(callback);\n            });\n        }\n    };\n    /**\n     * Both nodes are in different documents or different trees in the same document.\n     */\n    Node.DOCUMENT_POSITION_DISCONNECTED = 1;\n    /**\n     * otherNode precedes the node in either a pre-order depth-first traversal\n     * of a tree containing both (e.g., as an ancestor or previous sibling or a descendant of a previous sibling or previous sibling of an ancestor) or (if they are disconnected) in an arbitrary but consistent ordering.\n     */\n    Node.DOCUMENT_POSITION_PRECEDING = 2;\n    /**\n     * otherNode follows the node in either a pre-order depth-first traversal of a tree containing both (e.g., as a descendant or following sibling or a descendant of a following sibling or following sibling of an ancestor) or (if they are disconnected) in an arbitrary but consistent ordering.\n     */\n    Node.DOCUMENT_POSITION_FOLLOWING = 4;\n    /**\n     * otherNode is an ancestor of the node.\n     */\n    Node.DOCUMENT_POSITION_CONTAINS = 8;\n    /**\n     * otherNode is a descendant of the node.\n     */\n    Node.DOCUMENT_POSITION_CONTAINED_BY = 16;\n    /**\n     * The result relies upon arbitrary and/or implementation-specific behavior and is not guaranteed to be portable.\n     */\n    Node.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC = 32;\n    return Node;\n}(EventTarget));\n\nvar PROPAGATION_LIMIT = 2048;\nvar EventService = /** @class */ (function () {\n    function EventService(globalRuntime, context) {\n        var _this = this;\n        this.globalRuntime = globalRuntime;\n        this.context = context;\n        this.emitter = new EventEmitter();\n        /**\n         * Store HTML elements in current canvas.\n         */\n        this.nativeHTMLMap = new WeakMap();\n        this.cursor = 'default';\n        this.mappingTable = {};\n        this.mappingState = {\n            trackingData: {},\n        };\n        this.eventPool = new Map();\n        this.tmpMatrix = mat4.create();\n        this.tmpVec3 = vec3.create();\n        this.onPointerDown = function (from) {\n            var e = _this.createPointerEvent(from);\n            _this.dispatchEvent(e, 'pointerdown');\n            if (e.pointerType === 'touch') {\n                _this.dispatchEvent(e, 'touchstart');\n            }\n            else if (e.pointerType === 'mouse' || e.pointerType === 'pen') {\n                var isRightButton = e.button === 2;\n                _this.dispatchEvent(e, isRightButton ? 'rightdown' : 'mousedown');\n            }\n            var trackingData = _this.trackingData(from.pointerId);\n            trackingData.pressTargetsByButton[from.button] = e.composedPath();\n            _this.freeEvent(e);\n        };\n        this.onPointerUp = function (from) {\n            var _a;\n            var now = clock.now();\n            var e = _this.createPointerEvent(from, undefined, undefined, _this.context.config.alwaysTriggerPointerEventOnCanvas\n                ? _this.rootTarget\n                : undefined);\n            _this.dispatchEvent(e, 'pointerup');\n            if (e.pointerType === 'touch') {\n                _this.dispatchEvent(e, 'touchend');\n            }\n            else if (e.pointerType === 'mouse' || e.pointerType === 'pen') {\n                var isRightButton = e.button === 2;\n                _this.dispatchEvent(e, isRightButton ? 'rightup' : 'mouseup');\n            }\n            var trackingData = _this.trackingData(from.pointerId);\n            var pressTarget = _this.findMountedTarget(trackingData.pressTargetsByButton[from.button]);\n            var clickTarget = pressTarget;\n            // pointerupoutside only bubbles. It only bubbles upto the parent that doesn't contain\n            // the pointerup location.\n            if (pressTarget && !e.composedPath().includes(pressTarget)) {\n                var currentTarget = pressTarget;\n                while (currentTarget && !e.composedPath().includes(currentTarget)) {\n                    e.currentTarget = currentTarget;\n                    _this.notifyTarget(e, 'pointerupoutside');\n                    if (e.pointerType === 'touch') {\n                        _this.notifyTarget(e, 'touchendoutside');\n                    }\n                    else if (e.pointerType === 'mouse' || e.pointerType === 'pen') {\n                        var isRightButton = e.button === 2;\n                        _this.notifyTarget(e, isRightButton ? 'rightupoutside' : 'mouseupoutside');\n                    }\n                    if (Node.isNode(currentTarget)) {\n                        currentTarget = currentTarget.parentNode;\n                    }\n                }\n                delete trackingData.pressTargetsByButton[from.button];\n                // currentTarget is the most specific ancestor holding both the pointerdown and pointerup\n                // targets. That is - it's our click target!\n                clickTarget = currentTarget;\n            }\n            if (clickTarget) {\n                var clickEvent = _this.clonePointerEvent(e, 'click');\n                clickEvent.target = clickTarget;\n                clickEvent.path = [];\n                if (!trackingData.clicksByButton[from.button]) {\n                    trackingData.clicksByButton[from.button] = {\n                        clickCount: 0,\n                        target: clickEvent.target,\n                        timeStamp: now,\n                    };\n                }\n                var clickHistory = trackingData.clicksByButton[from.button];\n                if (clickHistory.target === clickEvent.target &&\n                    now - clickHistory.timeStamp < 200) {\n                    ++clickHistory.clickCount;\n                }\n                else {\n                    clickHistory.clickCount = 1;\n                }\n                clickHistory.target = clickEvent.target;\n                clickHistory.timeStamp = now;\n                clickEvent.detail = clickHistory.clickCount;\n                // @see https://github.com/antvis/G/issues/1091\n                if (!((_a = e.detail) === null || _a === void 0 ? void 0 : _a.preventClick)) {\n                    if (!_this.context.config.useNativeClickEvent &&\n                        (clickEvent.pointerType === 'mouse' ||\n                            clickEvent.pointerType === 'touch')) {\n                        _this.dispatchEvent(clickEvent, 'click');\n                    }\n                    _this.dispatchEvent(clickEvent, 'pointertap');\n                }\n                _this.freeEvent(clickEvent);\n            }\n            _this.freeEvent(e);\n        };\n        this.onPointerMove = function (from) {\n            var e = _this.createPointerEvent(from, undefined, undefined, _this.context.config.alwaysTriggerPointerEventOnCanvas\n                ? _this.rootTarget\n                : undefined);\n            var isMouse = e.pointerType === 'mouse' || e.pointerType === 'pen';\n            var trackingData = _this.trackingData(from.pointerId);\n            var outTarget = _this.findMountedTarget(trackingData.overTargets);\n            // First pointerout/pointerleave\n            if (trackingData.overTargets && outTarget !== e.target) {\n                // pointerout always occurs on the overTarget when the pointer hovers over another element.\n                var outType = from.type === 'mousemove' ? 'mouseout' : 'pointerout';\n                var outEvent = _this.createPointerEvent(from, outType, outTarget || undefined);\n                _this.dispatchEvent(outEvent, 'pointerout');\n                if (isMouse)\n                    _this.dispatchEvent(outEvent, 'mouseout');\n                // If the pointer exits overTarget and its descendants, then a pointerleave event is also fired. This event\n                // is dispatched to all ancestors that no longer capture the pointer.\n                if (!e.composedPath().includes(outTarget)) {\n                    var leaveEvent = _this.createPointerEvent(from, 'pointerleave', outTarget || undefined);\n                    leaveEvent.eventPhase = leaveEvent.AT_TARGET;\n                    while (leaveEvent.target &&\n                        !e.composedPath().includes(leaveEvent.target)) {\n                        leaveEvent.currentTarget = leaveEvent.target;\n                        _this.notifyTarget(leaveEvent);\n                        if (isMouse) {\n                            _this.notifyTarget(leaveEvent, 'mouseleave');\n                        }\n                        if (Node.isNode(leaveEvent.target)) {\n                            leaveEvent.target = leaveEvent.target.parentNode;\n                        }\n                    }\n                    _this.freeEvent(leaveEvent);\n                }\n                _this.freeEvent(outEvent);\n            }\n            // Then pointerover\n            if (outTarget !== e.target) {\n                // pointerover always occurs on the new overTarget\n                var overType = from.type === 'mousemove' ? 'mouseover' : 'pointerover';\n                var overEvent = _this.clonePointerEvent(e, overType); // clone faster\n                _this.dispatchEvent(overEvent, 'pointerover');\n                if (isMouse)\n                    _this.dispatchEvent(overEvent, 'mouseover');\n                // Probe whether the newly hovered Node is an ancestor of the original overTarget.\n                var overTargetAncestor = outTarget && Node.isNode(outTarget) && outTarget.parentNode;\n                while (overTargetAncestor &&\n                    overTargetAncestor !==\n                        (Node.isNode(_this.rootTarget) && _this.rootTarget.parentNode)) {\n                    if (overTargetAncestor === e.target)\n                        break;\n                    overTargetAncestor = overTargetAncestor.parentNode;\n                }\n                // The pointer has entered a non-ancestor of the original overTarget. This means we need a pointerentered\n                // event.\n                var didPointerEnter = !overTargetAncestor ||\n                    overTargetAncestor ===\n                        (Node.isNode(_this.rootTarget) && _this.rootTarget.parentNode);\n                if (didPointerEnter) {\n                    var enterEvent = _this.clonePointerEvent(e, 'pointerenter');\n                    enterEvent.eventPhase = enterEvent.AT_TARGET;\n                    while (enterEvent.target &&\n                        enterEvent.target !== outTarget &&\n                        enterEvent.target !==\n                            (Node.isNode(_this.rootTarget) && _this.rootTarget.parentNode)) {\n                        enterEvent.currentTarget = enterEvent.target;\n                        _this.notifyTarget(enterEvent);\n                        if (isMouse)\n                            _this.notifyTarget(enterEvent, 'mouseenter');\n                        if (Node.isNode(enterEvent.target)) {\n                            enterEvent.target = enterEvent.target.parentNode;\n                        }\n                    }\n                    _this.freeEvent(enterEvent);\n                }\n                _this.freeEvent(overEvent);\n            }\n            // Then pointermove\n            _this.dispatchEvent(e, 'pointermove');\n            if (e.pointerType === 'touch')\n                _this.dispatchEvent(e, 'touchmove');\n            if (isMouse) {\n                _this.dispatchEvent(e, 'mousemove');\n                _this.cursor = _this.getCursor(e.target);\n            }\n            trackingData.overTargets = e.composedPath();\n            _this.freeEvent(e);\n        };\n        this.onPointerOut = function (from) {\n            var trackingData = _this.trackingData(from.pointerId);\n            if (trackingData.overTargets) {\n                var isMouse = from.pointerType === 'mouse' || from.pointerType === 'pen';\n                var outTarget = _this.findMountedTarget(trackingData.overTargets);\n                // pointerout first\n                var outEvent = _this.createPointerEvent(from, 'pointerout', outTarget || undefined);\n                _this.dispatchEvent(outEvent);\n                if (isMouse)\n                    _this.dispatchEvent(outEvent, 'mouseout');\n                // pointerleave(s) are also dispatched b/c the pointer must've left rootTarget and its descendants to\n                // get an upstream pointerout event (upstream events do not know rootTarget has descendants).\n                var leaveEvent = _this.createPointerEvent(from, 'pointerleave', outTarget || undefined);\n                leaveEvent.eventPhase = leaveEvent.AT_TARGET;\n                while (leaveEvent.target &&\n                    leaveEvent.target !==\n                        (Node.isNode(_this.rootTarget) && _this.rootTarget.parentNode)) {\n                    leaveEvent.currentTarget = leaveEvent.target;\n                    _this.notifyTarget(leaveEvent);\n                    if (isMouse) {\n                        _this.notifyTarget(leaveEvent, 'mouseleave');\n                    }\n                    if (Node.isNode(leaveEvent.target)) {\n                        leaveEvent.target = leaveEvent.target.parentNode;\n                    }\n                }\n                trackingData.overTargets = null;\n                _this.freeEvent(outEvent);\n                _this.freeEvent(leaveEvent);\n            }\n            _this.cursor = null;\n        };\n        this.onPointerOver = function (from) {\n            var trackingData = _this.trackingData(from.pointerId);\n            var e = _this.createPointerEvent(from);\n            var isMouse = e.pointerType === 'mouse' || e.pointerType === 'pen';\n            _this.dispatchEvent(e, 'pointerover');\n            if (isMouse)\n                _this.dispatchEvent(e, 'mouseover');\n            if (e.pointerType === 'mouse')\n                _this.cursor = _this.getCursor(e.target);\n            // pointerenter events must be fired since the pointer entered from upstream.\n            var enterEvent = _this.clonePointerEvent(e, 'pointerenter');\n            enterEvent.eventPhase = enterEvent.AT_TARGET;\n            while (enterEvent.target &&\n                enterEvent.target !==\n                    (Node.isNode(_this.rootTarget) && _this.rootTarget.parentNode)) {\n                enterEvent.currentTarget = enterEvent.target;\n                _this.notifyTarget(enterEvent);\n                if (isMouse) {\n                    // mouseenter should not bubble\n                    // @see https://developer.mozilla.org/en-US/docs/Web/API/Element/mouseenter_event#usage_notes\n                    _this.notifyTarget(enterEvent, 'mouseenter');\n                }\n                if (Node.isNode(enterEvent.target)) {\n                    enterEvent.target = enterEvent.target.parentNode;\n                }\n            }\n            trackingData.overTargets = e.composedPath();\n            _this.freeEvent(e);\n            _this.freeEvent(enterEvent);\n        };\n        this.onPointerUpOutside = function (from) {\n            var trackingData = _this.trackingData(from.pointerId);\n            var pressTarget = _this.findMountedTarget(trackingData.pressTargetsByButton[from.button]);\n            var e = _this.createPointerEvent(from);\n            if (pressTarget) {\n                var currentTarget = pressTarget;\n                while (currentTarget) {\n                    e.currentTarget = currentTarget;\n                    _this.notifyTarget(e, 'pointerupoutside');\n                    if (e.pointerType === 'touch') ;\n                    else if (e.pointerType === 'mouse' || e.pointerType === 'pen') {\n                        _this.notifyTarget(e, e.button === 2 ? 'rightupoutside' : 'mouseupoutside');\n                    }\n                    if (Node.isNode(currentTarget)) {\n                        currentTarget = currentTarget.parentNode;\n                    }\n                }\n                delete trackingData.pressTargetsByButton[from.button];\n            }\n            _this.freeEvent(e);\n        };\n        this.onWheel = function (from) {\n            var wheelEvent = _this.createWheelEvent(from);\n            _this.dispatchEvent(wheelEvent);\n            _this.freeEvent(wheelEvent);\n        };\n        this.onClick = function (from) {\n            if (_this.context.config.useNativeClickEvent) {\n                var e = _this.createPointerEvent(from);\n                _this.dispatchEvent(e);\n                _this.freeEvent(e);\n            }\n        };\n        this.onPointerCancel = function (from) {\n            var e = _this.createPointerEvent(from, undefined, undefined, _this.context.config.alwaysTriggerPointerEventOnCanvas\n                ? _this.rootTarget\n                : undefined);\n            _this.dispatchEvent(e);\n            _this.freeEvent(e);\n        };\n    }\n    EventService.prototype.init = function () {\n        this.rootTarget = this.context.renderingContext.root.parentNode; // document\n        this.addEventMapping('pointerdown', this.onPointerDown);\n        this.addEventMapping('pointerup', this.onPointerUp);\n        this.addEventMapping('pointermove', this.onPointerMove);\n        this.addEventMapping('pointerout', this.onPointerOut);\n        this.addEventMapping('pointerleave', this.onPointerOut);\n        this.addEventMapping('pointercancel', this.onPointerCancel);\n        this.addEventMapping('pointerover', this.onPointerOver);\n        this.addEventMapping('pointerupoutside', this.onPointerUpOutside);\n        this.addEventMapping('wheel', this.onWheel);\n        this.addEventMapping('click', this.onClick);\n    };\n    EventService.prototype.destroy = function () {\n        this.emitter.removeAllListeners();\n        this.mappingTable = {};\n        this.mappingState = {};\n        this.eventPool.clear();\n    };\n    EventService.prototype.getScale = function () {\n        var bbox = this.context.contextService.getBoundingClientRect();\n        var scaleX = 1;\n        var scaleY = 1;\n        var $el = this.context.contextService.getDomElement();\n        if ($el && bbox) {\n            var offsetWidth = $el.offsetWidth, offsetHeight = $el.offsetHeight;\n            if (offsetWidth && offsetHeight) {\n                scaleX = bbox.width / offsetWidth;\n                scaleY = bbox.height / offsetHeight;\n            }\n        }\n        return {\n            scaleX: scaleX,\n            scaleY: scaleY,\n            bbox: bbox,\n        };\n    };\n    /**\n     * Should account for CSS Transform applied on container.\n     * @see https://github.com/antvis/G/issues/1161\n     * @see https://github.com/antvis/G/issues/1677\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/MouseEvent/offsetX\n     */\n    EventService.prototype.client2Viewport = function (client) {\n        var _a = this.getScale(), scaleX = _a.scaleX, scaleY = _a.scaleY, bbox = _a.bbox;\n        return new Point((client.x - ((bbox === null || bbox === void 0 ? void 0 : bbox.left) || 0)) / scaleX, (client.y - ((bbox === null || bbox === void 0 ? void 0 : bbox.top) || 0)) / scaleY);\n    };\n    EventService.prototype.viewport2Client = function (canvas) {\n        var _a = this.getScale(), scaleX = _a.scaleX, scaleY = _a.scaleY, bbox = _a.bbox;\n        return new Point((canvas.x + ((bbox === null || bbox === void 0 ? void 0 : bbox.left) || 0)) * scaleX, (canvas.y + ((bbox === null || bbox === void 0 ? void 0 : bbox.top) || 0)) * scaleY);\n    };\n    EventService.prototype.viewport2Canvas = function (_a) {\n        var x = _a.x, y = _a.y;\n        var canvas = this.rootTarget.defaultView;\n        var camera = canvas.getCamera();\n        var _b = this.context.config, width = _b.width, height = _b.height;\n        var projectionMatrixInverse = camera.getPerspectiveInverse();\n        var worldMatrix = camera.getWorldTransform();\n        var vpMatrix = mat4.multiply(this.tmpMatrix, worldMatrix, projectionMatrixInverse);\n        var viewport = vec3.set(this.tmpVec3, (x / width) * 2 - 1, (1 - y / height) * 2 - 1, 0);\n        vec3.transformMat4(viewport, viewport, vpMatrix);\n        return new Point(viewport[0], viewport[1]);\n    };\n    EventService.prototype.canvas2Viewport = function (canvasP) {\n        var canvas = this.rootTarget.defaultView;\n        var camera = canvas.getCamera();\n        // World -> Clip\n        var projectionMatrix = camera.getPerspective();\n        var viewMatrix = camera.getViewTransform();\n        var vpMatrix = mat4.multiply(this.tmpMatrix, projectionMatrix, viewMatrix);\n        var clip = vec3.set(this.tmpVec3, canvasP.x, canvasP.y, 0);\n        vec3.transformMat4(this.tmpVec3, this.tmpVec3, vpMatrix);\n        // Clip -> NDC -> Viewport, flip Y\n        var _a = this.context.config, width = _a.width, height = _a.height;\n        return new Point(((clip[0] + 1) / 2) * width, (1 - (clip[1] + 1) / 2) * height);\n    };\n    EventService.prototype.setPickHandler = function (pickHandler) {\n        this.pickHandler = pickHandler;\n    };\n    EventService.prototype.addEventMapping = function (type, fn) {\n        if (!this.mappingTable[type]) {\n            this.mappingTable[type] = [];\n        }\n        this.mappingTable[type].push({\n            fn: fn,\n            priority: 0,\n        });\n        this.mappingTable[type].sort(function (a, b) { return a.priority - b.priority; });\n    };\n    EventService.prototype.mapEvent = function (e) {\n        if (!this.rootTarget) {\n            return;\n        }\n        var mappers = this.mappingTable[e.type];\n        if (mappers) {\n            for (var i = 0, j = mappers.length; i < j; i++) {\n                mappers[i].fn(e);\n            }\n        }\n        else {\n            console.warn(\"[EventService]: Event mapping not defined for \".concat(e.type));\n        }\n    };\n    EventService.prototype.dispatchEvent = function (e, type, skipPropagate) {\n        // Canvas should skip\n        if (!skipPropagate) {\n            e.propagationStopped = false;\n            e.propagationImmediatelyStopped = false;\n            this.propagate(e, type);\n        }\n        else {\n            // target phase\n            e.eventPhase = e.AT_TARGET;\n            var canvas = this.rootTarget.defaultView || null;\n            e.currentTarget = canvas;\n            this.notifyListeners(e, type);\n        }\n        this.emitter.emit(type || e.type, e);\n    };\n    EventService.prototype.propagate = function (e, type) {\n        if (!e.target) {\n            return;\n        }\n        // [target, parent, root, Canvas]\n        var composedPath = e.composedPath();\n        // event flow: capture -> target -> bubbling\n        // capture phase\n        e.eventPhase = e.CAPTURING_PHASE;\n        for (var i = composedPath.length - 1; i >= 1; i--) {\n            e.currentTarget = composedPath[i];\n            this.notifyTarget(e, type);\n            if (e.propagationStopped || e.propagationImmediatelyStopped)\n                return;\n        }\n        // target phase\n        e.eventPhase = e.AT_TARGET;\n        e.currentTarget = e.target;\n        this.notifyTarget(e, type);\n        if (e.propagationStopped || e.propagationImmediatelyStopped)\n            return;\n        // find current target in composed path\n        var index = composedPath.indexOf(e.currentTarget);\n        // bubbling phase\n        e.eventPhase = e.BUBBLING_PHASE;\n        for (var i = index + 1; i < composedPath.length; i++) {\n            e.currentTarget = composedPath[i];\n            this.notifyTarget(e, type);\n            if (e.propagationStopped || e.propagationImmediatelyStopped)\n                return;\n        }\n    };\n    EventService.prototype.propagationPath = function (target) {\n        var propagationPath = [target];\n        var canvas = this.rootTarget.defaultView || null;\n        if (canvas && canvas === target) {\n            propagationPath.unshift(canvas.document);\n            return propagationPath;\n        }\n        for (var i = 0; i < PROPAGATION_LIMIT && target !== this.rootTarget; i++) {\n            // if (Node.isNode(target) && !target.parentNode) {\n            //   throw new Error('Cannot find propagation path to disconnected target');\n            // }\n            if (Node.isNode(target) && target.parentNode) {\n                // [target, parent, parent, root]\n                propagationPath.push(target.parentNode);\n                target = target.parentNode;\n            }\n        }\n        if (canvas) {\n            // @ts-ignore\n            propagationPath.push(canvas);\n        }\n        return propagationPath;\n    };\n    EventService.prototype.hitTest = function (position) {\n        var viewportX = position.viewportX, viewportY = position.viewportY;\n        var _a = this.context.config, width = _a.width, height = _a.height, disableHitTesting = _a.disableHitTesting;\n        // outside canvas\n        if (viewportX < 0 ||\n            viewportY < 0 ||\n            viewportX > width ||\n            viewportY > height) {\n            return null;\n        }\n        return ((!disableHitTesting && this.pickHandler(position)) ||\n            this.rootTarget || // return Document\n            null);\n    };\n    /**\n     * whether the native event trigger came from Canvas,\n     * should account for HTML shape\n     */\n    EventService.prototype.isNativeEventFromCanvas = function ($el, nativeEvent) {\n        var target = nativeEvent === null || nativeEvent === void 0 ? void 0 : nativeEvent.target;\n        // Get event target inside a web component.\n        // @see https://stackoverflow.com/questions/57963312/get-event-target-inside-a-web-component\n        if (target === null || target === void 0 ? void 0 : target.shadowRoot) {\n            target = nativeEvent.composedPath()[0];\n        }\n        if (target) {\n            // from <canvas>\n            if (target === $el) {\n                return true;\n            }\n            // from <svg>\n            if ($el && $el.contains) {\n                return $el.contains(target);\n            }\n        }\n        if (nativeEvent === null || nativeEvent === void 0 ? void 0 : nativeEvent.composedPath) {\n            return nativeEvent.composedPath().indexOf($el) > -1;\n        }\n        // account for Touch\n        return false;\n    };\n    /**\n     * Find HTML from composed path in native UI event.\n     */\n    EventService.prototype.getExistedHTML = function (event) {\n        var e_1, _a;\n        if (event.nativeEvent.composedPath) {\n            try {\n                for (var _b = __values(event.nativeEvent.composedPath()), _c = _b.next(); !_c.done; _c = _b.next()) {\n                    var eventTarget = _c.value;\n                    var existed = this.nativeHTMLMap.get(eventTarget);\n                    if (existed) {\n                        return existed;\n                    }\n                }\n            }\n            catch (e_1_1) { e_1 = { error: e_1_1 }; }\n            finally {\n                try {\n                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n                }\n                finally { if (e_1) throw e_1.error; }\n            }\n        }\n        return null;\n    };\n    EventService.prototype.pickTarget = function (event) {\n        return this.hitTest({\n            clientX: event.clientX,\n            clientY: event.clientY,\n            viewportX: event.viewportX,\n            viewportY: event.viewportY,\n            x: event.canvasX,\n            y: event.canvasY,\n        });\n    };\n    EventService.prototype.createPointerEvent = function (from, type, target, fallbackTarget) {\n        var event = this.allocateEvent(FederatedPointerEvent);\n        this.copyPointerData(from, event);\n        this.copyMouseData(from, event);\n        this.copyData(from, event);\n        event.nativeEvent = from.nativeEvent;\n        event.originalEvent = from;\n        var existedHTML = this.getExistedHTML(event);\n        var $el = this.context.contextService.getDomElement();\n        event.target =\n            target !== null && target !== void 0 ? target : (existedHTML ||\n                (this.isNativeEventFromCanvas($el, event.nativeEvent) &&\n                    this.pickTarget(event)) ||\n                fallbackTarget);\n        if (typeof type === 'string') {\n            event.type = type;\n        }\n        return event;\n    };\n    EventService.prototype.createWheelEvent = function (from) {\n        var event = this.allocateEvent(FederatedWheelEvent);\n        this.copyWheelData(from, event);\n        this.copyMouseData(from, event);\n        this.copyData(from, event);\n        event.nativeEvent = from.nativeEvent;\n        event.originalEvent = from;\n        var existedHTML = this.getExistedHTML(event);\n        var $el = this.context.contextService.getDomElement();\n        event.target =\n            existedHTML ||\n                (this.isNativeEventFromCanvas($el, event.nativeEvent) &&\n                    this.pickTarget(event));\n        return event;\n    };\n    EventService.prototype.trackingData = function (id) {\n        if (!this.mappingState.trackingData[id]) {\n            this.mappingState.trackingData[id] = {\n                pressTargetsByButton: {},\n                clicksByButton: {},\n                overTarget: null,\n            };\n        }\n        return this.mappingState.trackingData[id];\n    };\n    EventService.prototype.cloneWheelEvent = function (from) {\n        var event = this.allocateEvent(FederatedWheelEvent);\n        event.nativeEvent = from.nativeEvent;\n        event.originalEvent = from.originalEvent;\n        this.copyWheelData(from, event);\n        this.copyMouseData(from, event);\n        this.copyData(from, event);\n        event.target = from.target;\n        event.path = from.composedPath().slice();\n        event.type = from.type;\n        return event;\n    };\n    EventService.prototype.clonePointerEvent = function (from, type) {\n        var event = this.allocateEvent(FederatedPointerEvent);\n        event.nativeEvent = from.nativeEvent;\n        event.originalEvent = from.originalEvent;\n        this.copyPointerData(from, event);\n        this.copyMouseData(from, event);\n        this.copyData(from, event);\n        event.target = from.target;\n        event.path = from.composedPath().slice();\n        event.type = type !== null && type !== void 0 ? type : event.type;\n        return event;\n    };\n    EventService.prototype.copyPointerData = function (from, to) {\n        // if (\n        //   !(\n        //     from instanceof FederatedPointerEvent &&\n        //     to instanceof FederatedPointerEvent\n        //   )\n        // )\n        //   return;\n        to.pointerId = from.pointerId;\n        to.width = from.width;\n        to.height = from.height;\n        to.isPrimary = from.isPrimary;\n        to.pointerType = from.pointerType;\n        to.pressure = from.pressure;\n        to.tangentialPressure = from.tangentialPressure;\n        to.tiltX = from.tiltX;\n        to.tiltY = from.tiltY;\n        to.twist = from.twist;\n    };\n    EventService.prototype.copyMouseData = function (from, to) {\n        // if (\n        //   !(\n        //     from instanceof FederatedMouseEvent && to instanceof FederatedMouseEvent\n        //   )\n        // )\n        //   return;\n        to.altKey = from.altKey;\n        to.button = from.button;\n        to.buttons = from.buttons;\n        to.ctrlKey = from.ctrlKey;\n        to.metaKey = from.metaKey;\n        to.shiftKey = from.shiftKey;\n        to.client.copyFrom(from.client);\n        to.movement.copyFrom(from.movement);\n        to.canvas.copyFrom(from.canvas);\n        to.screen.copyFrom(from.screen);\n        to.global.copyFrom(from.global);\n        to.offset.copyFrom(from.offset);\n    };\n    EventService.prototype.copyWheelData = function (from, to) {\n        to.deltaMode = from.deltaMode;\n        to.deltaX = from.deltaX;\n        to.deltaY = from.deltaY;\n        to.deltaZ = from.deltaZ;\n    };\n    EventService.prototype.copyData = function (from, to) {\n        to.isTrusted = from.isTrusted;\n        to.timeStamp = clock.now();\n        to.type = from.type;\n        to.detail = from.detail;\n        to.view = from.view;\n        to.page.copyFrom(from.page);\n        to.viewport.copyFrom(from.viewport);\n    };\n    EventService.prototype.allocateEvent = function (constructor) {\n        if (!this.eventPool.has(constructor)) {\n            this.eventPool.set(constructor, []);\n        }\n        // @ts-ignore\n        var event = this.eventPool.get(constructor).pop() ||\n            new constructor(this);\n        event.eventPhase = event.NONE;\n        event.currentTarget = null;\n        event.path = [];\n        event.target = null;\n        return event;\n    };\n    EventService.prototype.freeEvent = function (event) {\n        if (event.manager !== this)\n            throw new Error('It is illegal to free an event not managed by this EventBoundary!');\n        var constructor = event.constructor;\n        if (!this.eventPool.has(constructor)) {\n            this.eventPool.set(constructor, []);\n        }\n        // @ts-ignore\n        this.eventPool.get(constructor).push(event);\n    };\n    EventService.prototype.notifyTarget = function (e, type) {\n        type = type !== null && type !== void 0 ? type : e.type;\n        var key = e.eventPhase === e.CAPTURING_PHASE || e.eventPhase === e.AT_TARGET\n            ? \"\".concat(type, \"capture\")\n            : type;\n        this.notifyListeners(e, key);\n        if (e.eventPhase === e.AT_TARGET) {\n            this.notifyListeners(e, type);\n        }\n    };\n    EventService.prototype.notifyListeners = function (e, type) {\n        // hack EventEmitter, stops if the `propagationImmediatelyStopped` flag is set\n        // @ts-ignore\n        var emitter = e.currentTarget.emitter;\n        // @ts-ignore\n        var listeners = emitter._events[type];\n        if (!listeners)\n            return;\n        if ('fn' in listeners) {\n            if (listeners.once) {\n                emitter.removeListener(type, listeners.fn, undefined, true);\n            }\n            listeners.fn.call(e.currentTarget || listeners.context, e);\n            // listeners.fn.call(listeners.context, e);\n        }\n        else {\n            for (var i = 0; i < listeners.length && !e.propagationImmediatelyStopped; i++) {\n                if (listeners[i].once) {\n                    emitter.removeListener(type, listeners[i].fn, undefined, true);\n                }\n                listeners[i].fn.call(e.currentTarget || listeners[i].context, e);\n                // listeners[i].fn.call(listeners[i].context, e);\n            }\n        }\n    };\n    /**\n     * some detached nodes may exist in propagation path, need to skip them\n     */\n    EventService.prototype.findMountedTarget = function (propagationPath) {\n        if (!propagationPath) {\n            return null;\n        }\n        var currentTarget = propagationPath[propagationPath.length - 1];\n        for (var i = propagationPath.length - 2; i >= 0; i--) {\n            var target = propagationPath[i];\n            if (target === this.rootTarget ||\n                (Node.isNode(target) && target.parentNode === currentTarget)) {\n                currentTarget = propagationPath[i];\n            }\n            else {\n                break;\n            }\n        }\n        return currentTarget;\n    };\n    EventService.prototype.getCursor = function (target) {\n        var tmp = target;\n        while (tmp) {\n            var cursor = isElement(tmp) && tmp.getAttribute('cursor');\n            if (cursor) {\n                return cursor;\n            }\n            tmp = Node.isNode(tmp) && tmp.parentNode;\n        }\n    };\n    return EventService;\n}());\n\n/**\n * used in following scenes:\n * - g `ctx.measureText`\n * - g-plugin-canvas-picker `ctx.isPointInPath`\n * - g-plugin-device-renderer `ctx.createLinearGradient` and generate texture\n *\n * @see https://blog.scottlogic.com/2020/03/19/offscreen-canvas.html\n */\nvar OffscreenCanvasCreator = /** @class */ (function () {\n    function OffscreenCanvasCreator() {\n    }\n    OffscreenCanvasCreator.prototype.getOrCreateCanvas = function (offscreenCanvas, contextAttributes) {\n        if (this.canvas) {\n            return this.canvas;\n        }\n        // user-defined offscreen canvas\n        if (offscreenCanvas || runtime.offscreenCanvas) {\n            this.canvas = offscreenCanvas || runtime.offscreenCanvas;\n            this.context = this.canvas.getContext('2d', __assign({ willReadFrequently: true }, contextAttributes));\n        }\n        else {\n            try {\n                // OffscreenCanvas2D measureText can be up to 40% faster.\n                this.canvas = new window.OffscreenCanvas(0, 0);\n                this.context = this.canvas.getContext('2d', __assign({ willReadFrequently: true }, contextAttributes));\n                if (!this.context || !this.context.measureText) {\n                    this.canvas = document.createElement('canvas');\n                    this.context = this.canvas.getContext('2d');\n                }\n            }\n            catch (ex) {\n                this.canvas = document.createElement('canvas');\n                this.context = this.canvas.getContext('2d', __assign({ willReadFrequently: true }, contextAttributes));\n            }\n        }\n        this.canvas.width = 10;\n        this.canvas.height = 10;\n        return this.canvas;\n    };\n    OffscreenCanvasCreator.prototype.getOrCreateContext = function (offscreenCanvas, contextAttributes) {\n        if (this.context) {\n            return this.context;\n        }\n        this.getOrCreateCanvas(offscreenCanvas, contextAttributes);\n        return this.context;\n    };\n    return OffscreenCanvasCreator;\n}());\n\n/**\n * why we need re-render\n */\nvar RenderReason;\n(function (RenderReason) {\n    RenderReason[RenderReason[\"CAMERA_CHANGED\"] = 0] = \"CAMERA_CHANGED\";\n    RenderReason[RenderReason[\"DISPLAY_OBJECT_CHANGED\"] = 1] = \"DISPLAY_OBJECT_CHANGED\";\n    RenderReason[RenderReason[\"NONE\"] = 2] = \"NONE\";\n})(RenderReason || (RenderReason = {}));\n\n/**\n * Use frame renderer implemented by `g-canvas/svg/webgl`, in every frame we do followings:\n * * update & merge dirty rectangles\n * * begin frame\n * * filter by visible\n * * sort by z-index in scene graph\n * * culling with strategies registered in `g-canvas/webgl`\n * * end frame\n */\nvar RenderingService = /** @class */ (function () {\n    function RenderingService(globalRuntime, context) {\n        this.globalRuntime = globalRuntime;\n        this.context = context;\n        this.inited = false;\n        this.stats = {\n            /**\n             * total display objects in scenegraph\n             */\n            total: 0,\n            /**\n             * number of display objects need to render in current frame\n             */\n            rendered: 0,\n        };\n        this.zIndexCounter = 0;\n        this.hooks = {\n            /**\n             * called before any frame rendered\n             */\n            init: new SyncHook(),\n            initAsync: new AsyncParallelHook(),\n            /**\n             * only dirty object which has sth changed will be rendered\n             */\n            dirtycheck: new SyncWaterfallHook(),\n            /**\n             * do culling\n             */\n            cull: new SyncWaterfallHook(),\n            /**\n             * called at beginning of each frame, won't get called if nothing to re-render\n             */\n            beginFrame: new SyncHook(),\n            /**\n             * called before every dirty object get rendered\n             */\n            beforeRender: new SyncHook(),\n            /**\n             * called when every dirty object rendering even it's culled\n             */\n            render: new SyncHook(),\n            /**\n             * called after every dirty object get rendered\n             */\n            afterRender: new SyncHook(),\n            endFrame: new SyncHook(),\n            destroy: new SyncHook(),\n            /**\n             * use async but faster method such as GPU-based picking in `g-plugin-device-renderer`\n             */\n            pick: new AsyncSeriesWaterfallHook(),\n            /**\n             * Unsafe but sync version of pick.\n             */\n            pickSync: new SyncWaterfallHook(),\n            /**\n             * used in event system\n             */\n            pointerDown: new SyncHook(),\n            pointerUp: new SyncHook(),\n            pointerMove: new SyncHook(),\n            pointerOut: new SyncHook(),\n            pointerOver: new SyncHook(),\n            pointerWheel: new SyncHook(),\n            pointerCancel: new SyncHook(),\n            click: new SyncHook(),\n        };\n    }\n    RenderingService.prototype.init = function (callback) {\n        var _this = this;\n        var context = __assign(__assign({}, this.globalRuntime), this.context);\n        // register rendering plugins\n        this.context.renderingPlugins.forEach(function (plugin) {\n            plugin.apply(context, _this.globalRuntime);\n        });\n        this.hooks.init.call();\n        if (this.hooks.initAsync.getCallbacksNum() === 0) {\n            this.inited = true;\n            callback();\n        }\n        else {\n            this.hooks.initAsync.promise().then(function () {\n                _this.inited = true;\n                callback();\n            });\n        }\n    };\n    RenderingService.prototype.getStats = function () {\n        return this.stats;\n    };\n    /**\n     * Meet the following conditions:\n     * * disable DirtyRectangleRendering\n     * * camera changed\n     */\n    RenderingService.prototype.disableDirtyRectangleRendering = function () {\n        var renderer = this.context.config.renderer;\n        var enableDirtyRectangleRendering = renderer.getConfig().enableDirtyRectangleRendering;\n        return (!enableDirtyRectangleRendering ||\n            this.context.renderingContext.renderReasons.has(RenderReason.CAMERA_CHANGED));\n    };\n    RenderingService.prototype.render = function (canvasConfig, frame, rerenderCallback) {\n        var _this = this;\n        this.stats.total = 0;\n        this.stats.rendered = 0;\n        this.zIndexCounter = 0;\n        var renderingContext = this.context.renderingContext;\n        this.globalRuntime.sceneGraphService.syncHierarchy(renderingContext.root);\n        this.globalRuntime.sceneGraphService.triggerPendingEvents();\n        if (renderingContext.renderReasons.size && this.inited) {\n            // @ts-ignore\n            renderingContext.dirtyRectangleRenderingDisabled =\n                this.disableDirtyRectangleRendering();\n            var onlyCameraChanged = renderingContext.renderReasons.size === 1 &&\n                renderingContext.renderReasons.has(RenderReason.CAMERA_CHANGED);\n            var shouldTriggerRenderHooks = !canvasConfig.disableRenderHooks ||\n                !(canvasConfig.disableRenderHooks && onlyCameraChanged);\n            if (shouldTriggerRenderHooks) {\n                this.renderDisplayObject(renderingContext.root, canvasConfig, renderingContext);\n            }\n            this.hooks.beginFrame.call(frame);\n            if (shouldTriggerRenderHooks) {\n                renderingContext.renderListCurrentFrame.forEach(function (object) {\n                    _this.hooks.beforeRender.call(object);\n                    _this.hooks.render.call(object);\n                    _this.hooks.afterRender.call(object);\n                });\n            }\n            this.hooks.endFrame.call(frame);\n            renderingContext.renderListCurrentFrame = [];\n            renderingContext.renderReasons.clear();\n            rerenderCallback();\n        }\n        // console.log('stats', this.stats);\n    };\n    RenderingService.prototype.renderDisplayObject = function (displayObject, canvasConfig, renderingContext) {\n        var _this = this;\n        var _a = canvasConfig.renderer.getConfig(), enableDirtyCheck = _a.enableDirtyCheck, enableCulling = _a.enableCulling;\n        // recalc style values\n        if (this.globalRuntime.enableCSSParsing) {\n            this.globalRuntime.styleValueRegistry.recalc(displayObject);\n        }\n        // TODO: relayout\n        // dirtycheck first\n        var renderable = displayObject.renderable;\n        var objectChanged = enableDirtyCheck\n            ? // @ts-ignore\n                renderable.dirty || renderingContext.dirtyRectangleRenderingDisabled\n                    ? displayObject\n                    : null\n            : displayObject;\n        if (objectChanged) {\n            var objectToRender = enableCulling\n                ? this.hooks.cull.call(objectChanged, this.context.camera)\n                : objectChanged;\n            if (objectToRender) {\n                this.stats.rendered++;\n                renderingContext.renderListCurrentFrame.push(objectToRender);\n            }\n        }\n        displayObject.renderable.dirty = false;\n        displayObject.sortable.renderOrder = this.zIndexCounter++;\n        this.stats.total++;\n        // sort is very expensive, use cached result if possible\n        var sortable = displayObject.sortable;\n        if (sortable.dirty) {\n            this.sort(displayObject, sortable);\n            sortable.dirty = false;\n            sortable.dirtyChildren = [];\n            sortable.dirtyReason = undefined;\n        }\n        // recursive rendering its children\n        (sortable.sorted || displayObject.childNodes).forEach(function (child) {\n            _this.renderDisplayObject(child, canvasConfig, renderingContext);\n        });\n    };\n    RenderingService.prototype.sort = function (displayObject, sortable) {\n        if (sortable.sorted &&\n            sortable.dirtyReason !== SortReason.Z_INDEX_CHANGED) {\n            // avoid re-sorting the whole children list\n            sortable.dirtyChildren.forEach(function (child) {\n                var index = displayObject.childNodes.indexOf(child);\n                if (index === -1) {\n                    // remove from sorted list\n                    var index_1 = sortable.sorted.indexOf(child);\n                    if (index_1 >= 0) {\n                        sortable.sorted.splice(index_1, 1);\n                    }\n                }\n                else {\n                    if (sortable.sorted.length === 0) {\n                        sortable.sorted.push(child);\n                    }\n                    else {\n                        var index_2 = sortedIndex(sortable.sorted, child);\n                        sortable.sorted.splice(index_2, 0, child);\n                    }\n                }\n            });\n        }\n        else {\n            sortable.sorted = displayObject.childNodes.slice().sort(sortByZIndex);\n        }\n    };\n    RenderingService.prototype.destroy = function () {\n        this.inited = false;\n        this.hooks.destroy.call();\n        this.globalRuntime.sceneGraphService.clearPendingEvents();\n    };\n    RenderingService.prototype.dirtify = function () {\n        // need re-render\n        this.context.renderingContext.renderReasons.add(RenderReason.DISPLAY_OBJECT_CHANGED);\n    };\n    return RenderingService;\n}());\n\nvar ATTRIBUTE_REGEXP = /\\[\\s*(.*)=(.*)\\s*\\]/;\n/**\n * support the following DOM API:\n * * getElementById\n * * getElementsByClassName\n * * getElementsByName\n * * getElementsByTag\n * * querySelector\n * * querySelectorAll\n */\nvar DefaultSceneGraphSelector = /** @class */ (function () {\n    function DefaultSceneGraphSelector() {\n    }\n    DefaultSceneGraphSelector.prototype.selectOne = function (query, root) {\n        var _this = this;\n        if (query.startsWith('.')) {\n            return root.find(function (node) {\n                // return !node.shadow && node.id === query.substring(1);\n                return (((node === null || node === void 0 ? void 0 : node.classList) || []).indexOf(_this.getIdOrClassname(query)) > -1);\n            });\n        }\n        else if (query.startsWith('#')) {\n            // getElementById('id')\n            return root.find(function (node) {\n                // return !node.shadow && node.id === query.substring(1);\n                return node.id === _this.getIdOrClassname(query);\n            });\n        }\n        else if (query.startsWith('[')) {\n            var _a = this.getAttribute(query), name_1 = _a.name, value_1 = _a.value;\n            if (name_1) {\n                // getElementByName();\n                return root.find(function (node) {\n                    return root !== node &&\n                        (name_1 === 'name'\n                            ? node.name === value_1\n                            : _this.attributeToString(node, name_1) === value_1);\n                });\n            }\n            else {\n                return null;\n            }\n        }\n        else {\n            // getElementsByTag('circle');\n            return root.find(function (node) { return root !== node && node.nodeName === query; });\n        }\n    };\n    DefaultSceneGraphSelector.prototype.selectAll = function (query, root) {\n        var _this = this;\n        // only support `[name=\"${name}\"]` `.className` `#id`\n        if (query.startsWith('.')) {\n            // getElementsByClassName('className');\n            // should not include itself\n            return root.findAll(function (node) {\n                return root !== node &&\n                    ((node === null || node === void 0 ? void 0 : node.classList) || []).indexOf(_this.getIdOrClassname(query)) > -1;\n            });\n        }\n        else if (query.startsWith('#')) {\n            return root.findAll(function (node) {\n                return root !== node &&\n                    node.id === _this.getIdOrClassname(query);\n            });\n        }\n        else if (query.startsWith('[')) {\n            var _a = this.getAttribute(query), name_2 = _a.name, value_2 = _a.value;\n            if (name_2) {\n                // getElementsByName();\n                return root.findAll(function (node) {\n                    return root !== node &&\n                        (name_2 === 'name'\n                            ? node.name === value_2\n                            : _this.attributeToString(node, name_2) === value_2);\n                });\n            }\n            else {\n                return [];\n            }\n        }\n        else {\n            // getElementsByTag('circle');\n            return root.findAll(function (node) { return root !== node && node.nodeName === query; });\n        }\n    };\n    DefaultSceneGraphSelector.prototype.is = function (query, node) {\n        // a simple `matches` implementation\n        if (query.startsWith('.')) {\n            return node.className === this.getIdOrClassname(query);\n        }\n        else if (query.startsWith('#')) {\n            return node.id === this.getIdOrClassname(query);\n        }\n        else if (query.startsWith('[')) {\n            var _a = this.getAttribute(query), name_3 = _a.name, value = _a.value;\n            return name_3 === 'name'\n                ? node.name === value\n                : this.attributeToString(node, name_3) === value;\n        }\n        else {\n            return node.nodeName === query;\n        }\n    };\n    DefaultSceneGraphSelector.prototype.getIdOrClassname = function (query) {\n        return query.substring(1);\n    };\n    DefaultSceneGraphSelector.prototype.getAttribute = function (query) {\n        var matches = query.match(ATTRIBUTE_REGEXP);\n        var name = '';\n        var value = '';\n        if (matches && matches.length > 2) {\n            name = matches[1].replace(/\"/g, '');\n            value = matches[2].replace(/\"/g, '');\n        }\n        return { name: name, value: value };\n    };\n    DefaultSceneGraphSelector.prototype.attributeToString = function (node, name) {\n        if (!node.getAttribute) {\n            return '';\n        }\n        var value = node.getAttribute(name);\n        if (isNil(value)) {\n            return '';\n        }\n        if (value.toString) {\n            return value.toString();\n        }\n        return '';\n    };\n    return DefaultSceneGraphSelector;\n}());\n\nvar MutationEvent = /** @class */ (function (_super) {\n    __extends(MutationEvent, _super);\n    function MutationEvent(typeArg, relatedNode, prevValue, newValue, attrName, attrChange, prevParsedValue, newParsedValue) {\n        var _this = _super.call(this, null) || this;\n        _this.relatedNode = relatedNode;\n        _this.prevValue = prevValue;\n        _this.newValue = newValue;\n        _this.attrName = attrName;\n        _this.attrChange = attrChange;\n        _this.prevParsedValue = prevParsedValue;\n        _this.newParsedValue = newParsedValue;\n        _this.type = typeArg;\n        return _this;\n    }\n    MutationEvent.ADDITION = 2;\n    MutationEvent.MODIFICATION = 1;\n    MutationEvent.REMOVAL = 3;\n    return MutationEvent;\n}(FederatedEvent));\n\n/**\n * built-in events for element\n * @see https://developer.mozilla.org/en-US/docs/Web/API/MutationEvent\n *\n * TODO: use MutationObserver instead\n * @see https://developer.mozilla.org/en-US/docs/Web/API/MutationObserver\n */\nvar ElementEvent;\n(function (ElementEvent) {\n    ElementEvent[\"REPARENT\"] = \"reparent\";\n    ElementEvent[\"DESTROY\"] = \"destroy\";\n    /**\n     * @see https://www.w3.org/TR/DOM-Level-3-Events/#event-type-DOMAttrModified\n     */\n    ElementEvent[\"ATTR_MODIFIED\"] = \"DOMAttrModified\";\n    /**\n     * it has been inserted\n     * @see https://www.w3.org/TR/DOM-Level-3-Events/#event-type-DOMNodeInserted\n     */\n    ElementEvent[\"INSERTED\"] = \"DOMNodeInserted\";\n    /**\n     * it is being removed\n     * @see https://www.w3.org/TR/DOM-Level-3-Events/#event-type-DOMNodeRemoved\n     */\n    ElementEvent[\"REMOVED\"] = \"removed\";\n    /**\n     * @see https://www.w3.org/TR/DOM-Level-3-Events/#domnodeinsertedintodocument\n     */\n    ElementEvent[\"MOUNTED\"] = \"DOMNodeInsertedIntoDocument\";\n    /**\n     * @see https://www.w3.org/TR/DOM-Level-3-Events/#domnoderemovedfromdocument\n     */\n    ElementEvent[\"UNMOUNTED\"] = \"DOMNodeRemovedFromDocument\";\n    ElementEvent[\"BOUNDS_CHANGED\"] = \"bounds-changed\";\n    ElementEvent[\"CULLED\"] = \"culled\";\n})(ElementEvent || (ElementEvent = {}));\n\nfunction markRenderableDirty(e) {\n    var renderable = e.renderable;\n    if (renderable) {\n        renderable.renderBoundsDirty = true;\n        renderable.boundsDirty = true;\n    }\n}\nvar reparentEvent = new MutationEvent(ElementEvent.REPARENT, null, '', '', '', 0, '', '');\n/**\n * update transform in scene graph\n *\n * @see https://community.khronos.org/t/scene-graphs/50542/7\n */\nvar DefaultSceneGraphService = /** @class */ (function () {\n    function DefaultSceneGraphService(runtime) {\n        var _this = this;\n        this.runtime = runtime;\n        this.pendingEvents = [];\n        this.boundsChangedEvent = new CustomEvent(ElementEvent.BOUNDS_CHANGED);\n        /**\n         * rotate in world space\n         */\n        this.rotate = (function () {\n            var parentInvertRotation = quat$1.create();\n            return function (element, degrees, y, z, dirtify) {\n                if (y === void 0) { y = 0; }\n                if (z === void 0) { z = 0; }\n                if (dirtify === void 0) { dirtify = true; }\n                if (typeof degrees === 'number') {\n                    degrees = vec3.fromValues(degrees, y, z);\n                }\n                var transform = element.transformable;\n                if (element.parentNode === null ||\n                    !element.parentNode.transformable) {\n                    _this.rotateLocal(element, degrees);\n                }\n                else {\n                    var rotation = quat$1.create();\n                    quat$1.fromEuler(rotation, degrees[0], degrees[1], degrees[2]);\n                    var rot = _this.getRotation(element);\n                    var parentRot = _this.getRotation(element.parentNode);\n                    quat$1.copy(parentInvertRotation, parentRot);\n                    quat$1.invert(parentInvertRotation, parentInvertRotation);\n                    quat$1.multiply(rotation, parentInvertRotation, rotation);\n                    quat$1.multiply(transform.localRotation, rotation, rot);\n                    quat$1.normalize(transform.localRotation, transform.localRotation);\n                    if (dirtify) {\n                        _this.dirtifyLocal(element, transform);\n                    }\n                }\n            };\n        })();\n        /**\n         * rotate in local space\n         * @see @see https://docs.microsoft.com/en-us/windows/win32/api/directxmath/nf-directxmath-xmquaternionrotationrollpitchyaw\n         */\n        this.rotateLocal = (function () {\n            var rotation = quat$1.create();\n            return function (element, degrees, y, z, dirtify) {\n                if (y === void 0) { y = 0; }\n                if (z === void 0) { z = 0; }\n                if (dirtify === void 0) { dirtify = true; }\n                if (typeof degrees === 'number') {\n                    degrees = vec3.fromValues(degrees, y, z);\n                }\n                var transform = element.transformable;\n                quat$1.fromEuler(rotation, degrees[0], degrees[1], degrees[2]);\n                quat$1.mul(transform.localRotation, transform.localRotation, rotation);\n                if (dirtify) {\n                    _this.dirtifyLocal(element, transform);\n                }\n            };\n        })();\n        /**\n         * set euler angles(degrees) in world space\n         */\n        this.setEulerAngles = (function () {\n            var invParentRot = quat$1.create();\n            return function (element, degrees, y, z, dirtify) {\n                if (y === void 0) { y = 0; }\n                if (z === void 0) { z = 0; }\n                if (dirtify === void 0) { dirtify = true; }\n                if (typeof degrees === 'number') {\n                    degrees = vec3.fromValues(degrees, y, z);\n                }\n                var transform = element.transformable;\n                if (element.parentNode === null ||\n                    !element.parentNode.transformable) {\n                    _this.setLocalEulerAngles(element, degrees);\n                }\n                else {\n                    quat$1.fromEuler(transform.localRotation, degrees[0], degrees[1], degrees[2]);\n                    var parentRotation = _this.getRotation(element.parentNode);\n                    quat$1.copy(invParentRot, quat$1.invert(quat$1.create(), parentRotation));\n                    quat$1.mul(transform.localRotation, transform.localRotation, invParentRot);\n                    if (dirtify) {\n                        _this.dirtifyLocal(element, transform);\n                    }\n                }\n            };\n        })();\n        /**\n         * translate in local space\n         *\n         * @example\n         * ```\n         * translateLocal(x, y, z)\n         * translateLocal(vec3(x, y, z))\n         * ```\n         */\n        this.translateLocal = (function () {\n            return function (element, translation, y, z, dirtify) {\n                if (y === void 0) { y = 0; }\n                if (z === void 0) { z = 0; }\n                if (dirtify === void 0) { dirtify = true; }\n                if (typeof translation === 'number') {\n                    translation = vec3.fromValues(translation, y, z);\n                }\n                var transform = element.transformable;\n                if (vec3.equals(translation, vec3.create())) {\n                    return;\n                }\n                vec3.transformQuat(translation, translation, transform.localRotation);\n                vec3.add(transform.localPosition, transform.localPosition, translation);\n                if (dirtify) {\n                    _this.dirtifyLocal(element, transform);\n                }\n            };\n        })();\n        /**\n         * move to position in world space\n         *\n         * 对应 g 原版的 move/moveTo\n         * @see https://github.com/antvis/g/blob/master/packages/g-base/src/abstract/element.ts#L684-L689\n         */\n        this.setPosition = (function () {\n            var parentInvertMatrix = mat4.create();\n            var tmpPosition = vec3.create();\n            return function (element, position, dirtify) {\n                if (dirtify === void 0) { dirtify = true; }\n                var transform = element.transformable;\n                tmpPosition[0] = position[0];\n                tmpPosition[1] = position[1];\n                tmpPosition[2] = position[2] || 0;\n                if (vec3.equals(_this.getPosition(element), tmpPosition)) {\n                    return;\n                }\n                vec3.copy(transform.position, tmpPosition);\n                if (element.parentNode === null ||\n                    !element.parentNode.transformable) {\n                    vec3.copy(transform.localPosition, tmpPosition);\n                }\n                else {\n                    var parentTransform = element.parentNode.transformable;\n                    mat4.copy(parentInvertMatrix, parentTransform.worldTransform);\n                    mat4.invert(parentInvertMatrix, parentInvertMatrix);\n                    vec3.transformMat4(transform.localPosition, tmpPosition, parentInvertMatrix);\n                }\n                if (dirtify) {\n                    _this.dirtifyLocal(element, transform);\n                }\n            };\n        })();\n        /**\n         * move to position in local space\n         */\n        this.setLocalPosition = (function () {\n            var tmpPosition = vec3.create();\n            return function (element, position, dirtify) {\n                if (dirtify === void 0) { dirtify = true; }\n                var transform = element.transformable;\n                tmpPosition[0] = position[0];\n                tmpPosition[1] = position[1];\n                tmpPosition[2] = position[2] || 0;\n                if (vec3.equals(transform.localPosition, tmpPosition)) {\n                    return;\n                }\n                vec3.copy(transform.localPosition, tmpPosition);\n                if (dirtify) {\n                    _this.dirtifyLocal(element, transform);\n                }\n            };\n        })();\n        /**\n         * translate in world space\n         *\n         * @example\n         * ```\n         * translate(x, y, z)\n         * translate(vec3(x, y, z))\n         * ```\n         *\n         * 对应 g 原版的 translate 2D\n         * @see https://github.com/antvis/g/blob/master/packages/g-base/src/abstract/element.ts#L665-L676\n         */\n        this.translate = (function () {\n            var zeroVec3 = vec3.create();\n            var tmpVec3 = vec3.create();\n            var tr = vec3.create();\n            return function (element, translation, y, z, dirtify) {\n                if (y === void 0) { y = 0; }\n                if (z === void 0) { z = 0; }\n                if (dirtify === void 0) { dirtify = true; }\n                if (typeof translation === 'number') {\n                    translation = vec3.set(tmpVec3, translation, y, z);\n                }\n                if (vec3.equals(translation, zeroVec3)) {\n                    return;\n                }\n                vec3.add(tr, _this.getPosition(element), translation);\n                _this.setPosition(element, tr, dirtify);\n            };\n        })();\n        this.setRotation = function () {\n            var parentInvertRotation = quat$1.create();\n            return function (element, rotation, y, z, w, dirtify) {\n                if (dirtify === void 0) { dirtify = true; }\n                var transform = element.transformable;\n                if (typeof rotation === 'number') {\n                    rotation = quat$1.fromValues(rotation, y, z, w);\n                }\n                if (element.parentNode === null ||\n                    !element.parentNode.transformable) {\n                    _this.setLocalRotation(element, rotation);\n                }\n                else {\n                    var parentRot = _this.getRotation(element.parentNode);\n                    quat$1.copy(parentInvertRotation, parentRot);\n                    quat$1.invert(parentInvertRotation, parentInvertRotation);\n                    quat$1.multiply(transform.localRotation, parentInvertRotation, rotation);\n                    quat$1.normalize(transform.localRotation, transform.localRotation);\n                    if (dirtify) {\n                        _this.dirtifyLocal(element, transform);\n                    }\n                }\n            };\n        };\n        this.displayObjectDependencyMap = new WeakMap();\n        this.calcLocalTransform = (function () {\n            var tmpMat = mat4.create();\n            var tmpPosition = vec3.create();\n            var tmpQuat = quat$1.fromValues(0, 0, 0, 1);\n            return function (transform) {\n                var hasSkew = transform.localSkew[0] !== 0 || transform.localSkew[1] !== 0;\n                if (hasSkew) {\n                    mat4.fromRotationTranslationScaleOrigin(transform.localTransform, transform.localRotation, transform.localPosition, vec3.fromValues(1, 1, 1), transform.origin);\n                    // apply skew2D\n                    if (transform.localSkew[0] !== 0 || transform.localSkew[1] !== 0) {\n                        var tmpMat4 = mat4.identity(tmpMat);\n                        tmpMat4[4] = Math.tan(transform.localSkew[0]);\n                        tmpMat4[1] = Math.tan(transform.localSkew[1]);\n                        mat4.multiply(transform.localTransform, transform.localTransform, tmpMat4);\n                    }\n                    var scaling = mat4.fromRotationTranslationScaleOrigin(tmpMat, tmpQuat, tmpPosition, transform.localScale, transform.origin);\n                    mat4.multiply(transform.localTransform, transform.localTransform, scaling);\n                }\n                else {\n                    // @see https://github.com/mattdesl/css-mat4/blob/master/index.js\n                    mat4.fromRotationTranslationScaleOrigin(transform.localTransform, transform.localRotation, transform.localPosition, transform.localScale, transform.origin);\n                }\n            };\n        })();\n    }\n    DefaultSceneGraphService.prototype.matches = function (query, root) {\n        return this.runtime.sceneGraphSelector.is(query, root);\n    };\n    DefaultSceneGraphService.prototype.querySelector = function (query, root) {\n        return this.runtime.sceneGraphSelector.selectOne(query, root);\n    };\n    DefaultSceneGraphService.prototype.querySelectorAll = function (query, root) {\n        return this.runtime.sceneGraphSelector.selectAll(query, root);\n        // .filter((node) => !node.shadow);\n    };\n    DefaultSceneGraphService.prototype.attach = function (child, parent, index) {\n        var _a;\n        var detached = false;\n        if (child.parentNode) {\n            detached = child.parentNode !== parent;\n            this.detach(child);\n        }\n        child.parentNode = parent;\n        if (!isNil(index)) {\n            child.parentNode.childNodes.splice(index, 0, child);\n        }\n        else {\n            child.parentNode.childNodes.push(child);\n        }\n        // parent needs re-sort\n        var sortable = parent.sortable;\n        if (((_a = sortable === null || sortable === void 0 ? void 0 : sortable.sorted) === null || _a === void 0 ? void 0 : _a.length) ||\n            child.parsedStyle.zIndex) {\n            if (sortable.dirtyChildren.indexOf(child) === -1) {\n                sortable.dirtyChildren.push(child);\n            }\n            // if (sortable) {\n            // only child has z-Index\n            sortable.dirty = true;\n            sortable.dirtyReason = SortReason.ADDED;\n        }\n        // this.updateGraphDepth(child);\n        var transform = child.transformable;\n        if (transform) {\n            this.dirtifyWorld(child, transform);\n        }\n        if (transform.frozen) {\n            this.unfreezeParentToRoot(child);\n        }\n        if (detached) {\n            child.dispatchEvent(reparentEvent);\n        }\n    };\n    DefaultSceneGraphService.prototype.detach = function (child) {\n        var _a, _b;\n        if (child.parentNode) {\n            var transform = child.transformable;\n            // if (transform) {\n            //   const worldTransform = this.getWorldTransform(child, transform);\n            //   mat4.getScaling(transform.localScale, worldTransform);\n            //   mat4.getTranslation(transform.localPosition, worldTransform);\n            //   mat4.getRotation(transform.localRotation, worldTransform);\n            //   transform.localDirtyFlag = true;\n            // }\n            // parent needs re-sort\n            var sortable = child.parentNode.sortable;\n            // if (sortable) {\n            if (((_a = sortable === null || sortable === void 0 ? void 0 : sortable.sorted) === null || _a === void 0 ? void 0 : _a.length) ||\n                ((_b = child.style) === null || _b === void 0 ? void 0 : _b.zIndex)) {\n                if (sortable.dirtyChildren.indexOf(child) === -1) {\n                    sortable.dirtyChildren.push(child);\n                }\n                sortable.dirty = true;\n                sortable.dirtyReason = SortReason.REMOVED;\n            }\n            var index = child.parentNode.childNodes.indexOf(child);\n            if (index > -1) {\n                child.parentNode.childNodes.splice(index, 1);\n            }\n            if (transform) {\n                this.dirtifyWorld(child, transform);\n            }\n            child.parentNode = null;\n        }\n    };\n    DefaultSceneGraphService.prototype.getOrigin = function (element) {\n        element.getGeometryBounds();\n        return element.transformable.origin;\n    };\n    /**\n     * same as pivot in Pixi.js\n     *\n     * @see https://stackoverflow.com/questions/40748452/how-to-change-css-transform-origin-but-preserve-transformation\n     */\n    DefaultSceneGraphService.prototype.setOrigin = function (element, origin, y, z) {\n        if (y === void 0) { y = 0; }\n        if (z === void 0) { z = 0; }\n        if (typeof origin === 'number') {\n            origin = [origin, y, z];\n        }\n        var transform = element.transformable;\n        if (origin[0] === transform.origin[0] &&\n            origin[1] === transform.origin[1] &&\n            origin[2] === transform.origin[2]) {\n            return;\n        }\n        var originVec = transform.origin;\n        // const delta = vec3.subtract(vec3.create(), origin, originVec);\n        // vec3.add(transform.localPosition, transform.localPosition, delta);\n        // update origin\n        originVec[0] = origin[0];\n        originVec[1] = origin[1];\n        originVec[2] = origin[2] || 0;\n        this.dirtifyLocal(element, transform);\n    };\n    /**\n     * set euler angles(degrees) in local space\n     */\n    DefaultSceneGraphService.prototype.setLocalEulerAngles = function (element, degrees, y, z, dirtify) {\n        if (y === void 0) { y = 0; }\n        if (z === void 0) { z = 0; }\n        if (dirtify === void 0) { dirtify = true; }\n        if (typeof degrees === 'number') {\n            degrees = vec3.fromValues(degrees, y, z);\n        }\n        var transform = element.transformable;\n        quat$1.fromEuler(transform.localRotation, degrees[0], degrees[1], degrees[2]);\n        if (dirtify) {\n            this.dirtifyLocal(element, transform);\n        }\n    };\n    /**\n     * scale in local space\n     */\n    DefaultSceneGraphService.prototype.scaleLocal = function (element, scaling, dirtify) {\n        if (dirtify === void 0) { dirtify = true; }\n        var transform = element.transformable;\n        vec3.multiply(transform.localScale, transform.localScale, vec3.fromValues(scaling[0], scaling[1], scaling[2] || 1));\n        if (dirtify) {\n            this.dirtifyLocal(element, transform);\n        }\n    };\n    DefaultSceneGraphService.prototype.setLocalScale = function (element, scaling, dirtify) {\n        if (dirtify === void 0) { dirtify = true; }\n        var transform = element.transformable;\n        var updatedScaling = vec3.fromValues(scaling[0], scaling[1], scaling[2] || transform.localScale[2]);\n        if (vec3.equals(updatedScaling, transform.localScale)) {\n            return;\n        }\n        vec3.copy(transform.localScale, updatedScaling);\n        if (dirtify) {\n            this.dirtifyLocal(element, transform);\n        }\n    };\n    DefaultSceneGraphService.prototype.setLocalRotation = function (element, rotation, y, z, w, dirtify) {\n        if (dirtify === void 0) { dirtify = true; }\n        if (typeof rotation === 'number') {\n            rotation = quat$1.fromValues(rotation, y, z, w);\n        }\n        var transform = element.transformable;\n        quat$1.copy(transform.localRotation, rotation);\n        if (dirtify) {\n            this.dirtifyLocal(element, transform);\n        }\n    };\n    DefaultSceneGraphService.prototype.setLocalSkew = function (element, skew, y) {\n        if (typeof skew === 'number') {\n            skew = vec2.fromValues(skew, y);\n        }\n        var transform = element.transformable;\n        vec2.copy(transform.localSkew, skew);\n        this.dirtifyLocal(element, transform);\n    };\n    DefaultSceneGraphService.prototype.dirtifyLocal = function (element, transform) {\n        if (!transform.localDirtyFlag) {\n            transform.localDirtyFlag = true;\n            if (!transform.dirtyFlag) {\n                this.dirtifyWorld(element, transform);\n            }\n        }\n    };\n    DefaultSceneGraphService.prototype.dirtifyWorld = function (element, transform) {\n        if (!transform.dirtyFlag) {\n            this.unfreezeParentToRoot(element);\n        }\n        this.dirtifyWorldInternal(element, transform);\n        this.dirtifyToRoot(element, true);\n    };\n    DefaultSceneGraphService.prototype.triggerPendingEvents = function () {\n        var _this = this;\n        var set = new Set();\n        var trigger = function (element, detail) {\n            if (element.isConnected && !set.has(element.entity)) {\n                _this.boundsChangedEvent.detail = detail;\n                _this.boundsChangedEvent.target = element;\n                if (element.isMutationObserved) {\n                    element.dispatchEvent(_this.boundsChangedEvent);\n                }\n                else {\n                    element.ownerDocument.defaultView.dispatchEvent(_this.boundsChangedEvent, true);\n                }\n                set.add(element.entity);\n            }\n        };\n        this.pendingEvents.forEach(function (_a) {\n            var _b = __read(_a, 2), element = _b[0], detail = _b[1];\n            if (detail.affectChildren) {\n                element.forEach(function (e) {\n                    trigger(e, detail);\n                });\n            }\n            else {\n                trigger(element, detail);\n            }\n        });\n        this.clearPendingEvents();\n        set.clear();\n    };\n    DefaultSceneGraphService.prototype.clearPendingEvents = function () {\n        this.pendingEvents = [];\n    };\n    DefaultSceneGraphService.prototype.dirtifyToRoot = function (element, affectChildren) {\n        if (affectChildren === void 0) { affectChildren = false; }\n        var p = element;\n        // only need to re-render itself\n        if (p.renderable) {\n            p.renderable.dirty = true;\n        }\n        while (p) {\n            markRenderableDirty(p);\n            p = p.parentNode;\n        }\n        if (affectChildren) {\n            element.forEach(function (e) {\n                markRenderableDirty(e);\n            });\n        }\n        // inform dependencies\n        this.informDependentDisplayObjects(element);\n        // reuse the same custom event\n        this.pendingEvents.push([element, { affectChildren: affectChildren }]);\n    };\n    DefaultSceneGraphService.prototype.updateDisplayObjectDependency = function (name, oldPath, newPath, object) {\n        // clear ref to old clip path\n        if (oldPath && oldPath !== newPath) {\n            var oldDependencyMap = this.displayObjectDependencyMap.get(oldPath);\n            if (oldDependencyMap && oldDependencyMap[name]) {\n                var index = oldDependencyMap[name].indexOf(object);\n                oldDependencyMap[name].splice(index, 1);\n            }\n        }\n        if (newPath) {\n            var newDependencyMap = this.displayObjectDependencyMap.get(newPath);\n            if (!newDependencyMap) {\n                this.displayObjectDependencyMap.set(newPath, {});\n                newDependencyMap = this.displayObjectDependencyMap.get(newPath);\n            }\n            if (!newDependencyMap[name]) {\n                newDependencyMap[name] = [];\n            }\n            newDependencyMap[name].push(object);\n        }\n    };\n    DefaultSceneGraphService.prototype.informDependentDisplayObjects = function (object) {\n        var _this = this;\n        var dependencyMap = this.displayObjectDependencyMap.get(object);\n        if (dependencyMap) {\n            Object.keys(dependencyMap).forEach(function (name) {\n                dependencyMap[name].forEach(function (target) {\n                    _this.dirtifyToRoot(target, true);\n                    target.dispatchEvent(new MutationEvent(ElementEvent.ATTR_MODIFIED, target, _this, _this, name, MutationEvent.MODIFICATION, _this, _this));\n                    if (target.isCustomElement && target.isConnected) {\n                        if (target.attributeChangedCallback) {\n                            target.attributeChangedCallback(name, _this, _this);\n                        }\n                    }\n                });\n            });\n        }\n    };\n    DefaultSceneGraphService.prototype.getPosition = function (element) {\n        var transform = element.transformable;\n        return mat4.getTranslation(transform.position, this.getWorldTransform(element, transform));\n    };\n    DefaultSceneGraphService.prototype.getRotation = function (element) {\n        var transform = element.transformable;\n        return mat4.getRotation(transform.rotation, this.getWorldTransform(element, transform));\n    };\n    DefaultSceneGraphService.prototype.getScale = function (element) {\n        var transform = element.transformable;\n        return mat4.getScaling(transform.scaling, this.getWorldTransform(element, transform));\n    };\n    DefaultSceneGraphService.prototype.getWorldTransform = function (element, transform) {\n        if (transform === void 0) { transform = element.transformable; }\n        if (!transform.localDirtyFlag && !transform.dirtyFlag) {\n            return transform.worldTransform;\n        }\n        if (element.parentNode && element.parentNode.transformable) {\n            this.getWorldTransform(element.parentNode);\n        }\n        this.sync(element, transform);\n        return transform.worldTransform;\n    };\n    DefaultSceneGraphService.prototype.getLocalPosition = function (element) {\n        return element.transformable.localPosition;\n    };\n    DefaultSceneGraphService.prototype.getLocalRotation = function (element) {\n        return element.transformable.localRotation;\n    };\n    DefaultSceneGraphService.prototype.getLocalScale = function (element) {\n        return element.transformable.localScale;\n    };\n    DefaultSceneGraphService.prototype.getLocalSkew = function (element) {\n        return element.transformable.localSkew;\n    };\n    DefaultSceneGraphService.prototype.getLocalTransform = function (element) {\n        var transform = element.transformable;\n        if (transform.localDirtyFlag) {\n            this.calcLocalTransform(transform);\n            transform.localDirtyFlag = false;\n        }\n        return transform.localTransform;\n    };\n    DefaultSceneGraphService.prototype.setLocalTransform = function (element, transform) {\n        var t = mat4.getTranslation(vec3.create(), transform);\n        var r = mat4.getRotation(quat$1.create(), transform);\n        var s = mat4.getScaling(vec3.create(), transform);\n        this.setLocalScale(element, s, false);\n        this.setLocalPosition(element, t, false);\n        this.setLocalRotation(element, r, undefined, undefined, undefined, false);\n        this.dirtifyLocal(element, element.transformable);\n    };\n    DefaultSceneGraphService.prototype.resetLocalTransform = function (element) {\n        this.setLocalScale(element, [1, 1, 1]);\n        this.setLocalPosition(element, [0, 0, 0]);\n        this.setLocalEulerAngles(element, [0, 0, 0]);\n        this.setLocalSkew(element, [0, 0]);\n    };\n    DefaultSceneGraphService.prototype.getTransformedGeometryBounds = function (element, render, existedAABB) {\n        if (render === void 0) { render = false; }\n        var bounds = this.getGeometryBounds(element, render);\n        if (!AABB.isEmpty(bounds)) {\n            var aabb = existedAABB || new AABB();\n            aabb.setFromTransformedAABB(bounds, this.getWorldTransform(element));\n            return aabb;\n        }\n        else {\n            return null;\n        }\n    };\n    /**\n     * won't account for children\n     */\n    DefaultSceneGraphService.prototype.getGeometryBounds = function (element, render) {\n        if (render === void 0) { render = false; }\n        var geometry = element.geometry;\n        if (geometry.dirty) {\n            runtime.styleValueRegistry.updateGeometry(element);\n        }\n        var bounds = render\n            ? geometry.renderBounds\n            : geometry.contentBounds || null;\n        // return (bounds && new AABB(bounds.center, bounds.halfExtents)) || new AABB();\n        return bounds || new AABB();\n    };\n    /**\n     * account for children in world space\n     */\n    DefaultSceneGraphService.prototype.getBounds = function (element, render) {\n        var _this = this;\n        if (render === void 0) { render = false; }\n        var renderable = element.renderable;\n        if (!renderable.boundsDirty && !render && renderable.bounds) {\n            return renderable.bounds;\n        }\n        if (!renderable.renderBoundsDirty && render && renderable.renderBounds) {\n            return renderable.renderBounds;\n        }\n        // reuse existed if possible\n        var existedAABB = render ? renderable.renderBounds : renderable.bounds;\n        // reset with geometry's aabb\n        var aabb = this.getTransformedGeometryBounds(element, render, existedAABB);\n        // merge children's aabbs\n        var children = element.childNodes;\n        children.forEach(function (child) {\n            var childBounds = _this.getBounds(child, render);\n            if (childBounds) {\n                if (!aabb) {\n                    aabb = existedAABB || new AABB();\n                    aabb.update(childBounds.center, childBounds.halfExtents);\n                }\n                else {\n                    aabb.add(childBounds);\n                }\n            }\n        });\n        if (!aabb) {\n            aabb = new AABB();\n        }\n        if (render) {\n            // FIXME: account for clip path\n            var clipped = findClosestClipPathTarget(element);\n            if (clipped) {\n                // use bounds under world space\n                var clipPathBounds = clipped.parsedStyle.clipPath.getBounds(render);\n                if (!aabb) {\n                    aabb.update(clipPathBounds.center, clipPathBounds.halfExtents);\n                }\n                else if (clipPathBounds) {\n                    aabb = clipPathBounds.intersection(aabb);\n                }\n            }\n        }\n        if (render) {\n            renderable.renderBounds = aabb;\n            renderable.renderBoundsDirty = false;\n        }\n        else {\n            renderable.bounds = aabb;\n            renderable.boundsDirty = false;\n        }\n        return aabb;\n    };\n    /**\n     * account for children in local space\n     */\n    DefaultSceneGraphService.prototype.getLocalBounds = function (element) {\n        if (element.parentNode) {\n            var parentInvert = mat4.create();\n            if (element.parentNode.transformable) {\n                parentInvert = mat4.invert(mat4.create(), this.getWorldTransform(element.parentNode));\n            }\n            var bounds = this.getBounds(element);\n            if (!AABB.isEmpty(bounds)) {\n                var localBounds = new AABB();\n                localBounds.setFromTransformedAABB(bounds, parentInvert);\n                return localBounds;\n            }\n        }\n        return this.getBounds(element);\n    };\n    DefaultSceneGraphService.prototype.getBoundingClientRect = function (element) {\n        var _a, _b;\n        var aabb;\n        var bounds = this.getGeometryBounds(element);\n        if (!AABB.isEmpty(bounds)) {\n            aabb = new AABB();\n            // apply transformation to aabb\n            aabb.setFromTransformedAABB(bounds, this.getWorldTransform(element));\n        }\n        // calc context's offset\n        var bbox = (_b = (_a = element.ownerDocument) === null || _a === void 0 ? void 0 : _a.defaultView) === null || _b === void 0 ? void 0 : _b.getContextService().getBoundingClientRect();\n        if (aabb) {\n            var _c = __read(aabb.getMin(), 2), left = _c[0], top_1 = _c[1];\n            var _d = __read(aabb.getMax(), 2), right = _d[0], bottom = _d[1];\n            return new Rectangle(left + ((bbox === null || bbox === void 0 ? void 0 : bbox.left) || 0), top_1 + ((bbox === null || bbox === void 0 ? void 0 : bbox.top) || 0), right - left, bottom - top_1);\n        }\n        return new Rectangle((bbox === null || bbox === void 0 ? void 0 : bbox.left) || 0, (bbox === null || bbox === void 0 ? void 0 : bbox.top) || 0, 0, 0);\n    };\n    DefaultSceneGraphService.prototype.dirtifyWorldInternal = function (element, transform) {\n        var _this = this;\n        if (!transform.dirtyFlag) {\n            transform.dirtyFlag = true;\n            transform.frozen = false;\n            element.childNodes.forEach(function (child) {\n                var childTransform = child.transformable;\n                if (!childTransform.dirtyFlag) {\n                    _this.dirtifyWorldInternal(child, childTransform);\n                }\n            });\n            var renderable = element.renderable;\n            if (renderable) {\n                renderable.renderBoundsDirty = true;\n                renderable.boundsDirty = true;\n                renderable.dirty = true;\n            }\n        }\n    };\n    DefaultSceneGraphService.prototype.syncHierarchy = function (element) {\n        var transform = element.transformable;\n        if (transform.frozen) {\n            return;\n        }\n        transform.frozen = true;\n        if (transform.localDirtyFlag || transform.dirtyFlag) {\n            this.sync(element, transform);\n        }\n        var children = element.childNodes;\n        for (var i = 0; i < children.length; i++) {\n            this.syncHierarchy(children[i]);\n        }\n    };\n    DefaultSceneGraphService.prototype.sync = function (element, transform) {\n        if (transform.localDirtyFlag) {\n            this.calcLocalTransform(transform);\n            transform.localDirtyFlag = false;\n        }\n        if (transform.dirtyFlag) {\n            var parent_1 = element.parentNode;\n            var parentTransform = parent_1 && parent_1.transformable;\n            if (parent_1 === null || !parentTransform) {\n                mat4.copy(transform.worldTransform, transform.localTransform);\n            }\n            else {\n                // TODO: should we support scale compensation?\n                // @see https://github.com/playcanvas/engine/issues/1077#issuecomment-359765557\n                mat4.multiply(transform.worldTransform, parentTransform.worldTransform, transform.localTransform);\n            }\n            transform.dirtyFlag = false;\n        }\n    };\n    DefaultSceneGraphService.prototype.unfreezeParentToRoot = function (child) {\n        var p = child.parentNode;\n        while (p) {\n            var transform = p.transformable;\n            if (transform) {\n                transform.frozen = false;\n            }\n            p = p.parentNode;\n        }\n    };\n    return DefaultSceneGraphService;\n}());\n\nvar TEXT_METRICS = {\n    MetricsString: '|ÉqÅ',\n    BaselineSymbol: 'M',\n    BaselineMultiplier: 1.4,\n    HeightMultiplier: 2,\n    Newlines: [\n        0x000a, // line feed\n        0x000d, // carriage return\n    ],\n    BreakingSpaces: [\n        0x0009, // character tabulation\n        0x0020, // space\n        0x2000, // en quad\n        0x2001, // em quad\n        0x2002, // en space\n        0x2003, // em space\n        0x2004, // three-per-em space\n        0x2005, // four-per-em space\n        0x2006, // six-per-em space\n        0x2008, // punctuation space\n        0x2009, // thin space\n        0x200a, // hair space\n        0x205f, // medium mathematical space\n        0x3000, // ideographic space\n    ],\n};\nvar LATIN_REGEX = /[a-zA-Z0-9\\u00C0-\\u00D6\\u00D8-\\u00f6\\u00f8-\\u00ff!\"#$%&'()*+,-./:;]/;\n// Line breaking rules in CJK (Kinsoku Shori)\n// Refer from https://en.wikipedia.org/wiki/Line_breaking_rules_in_East_Asian_languages\nvar regexCannotStartZhCn = /[!%),.:;?\\]}¢°·'\"\"†‡›℃∶、。〃〆〕〗〞﹚﹜！＂％＇），．：；？！］｝～]/;\nvar regexCannotEndZhCn = /[$(£¥·'\"〈《「『【〔〖〝﹙﹛＄（．［｛￡￥]/;\nvar regexCannotStartZhTw = /[!),.:;?\\]}¢·–—'\"•\"、。〆〞〕〉》」︰︱︲︳﹐﹑﹒﹓﹔﹕﹖﹘﹚﹜！），．：；？︶︸︺︼︾﹀﹂﹗］｜｝､]/;\nvar regexCannotEndZhTw = /[([{£¥'\"‵〈《「『〔〝︴﹙﹛（｛︵︷︹︻︽︿﹁﹃﹏]/;\nvar regexCannotStartJaJp = /[)\\]｝〕〉》」』】〙〗〟'\"｠»ヽヾーァィゥェォッャュョヮヵヶぁぃぅぇぉっゃゅょゎゕゖㇰㇱㇲㇳㇴㇵㇶㇷㇸㇹㇺㇻㇼㇽㇾㇿ々〻‐゠–〜?!‼⁇⁈⁉・、:;,。.]/;\nvar regexCannotEndJaJp = /[([｛〔〈《「『【〘〖〝'\"｟«—...‥〳〴〵]/;\nvar regexCannotStartKoKr = /[!%),.:;?\\]}¢°'\"†‡℃〆〈《「『〕！％），．：；？］｝]/;\nvar regexCannotEndKoKr = /[$([{£¥'\"々〇〉》」〔＄（［｛｠￥￦#]/;\nvar regexCannotStart = new RegExp(\"\".concat(regexCannotStartZhCn.source, \"|\").concat(regexCannotStartZhTw.source, \"|\").concat(regexCannotStartJaJp.source, \"|\").concat(regexCannotStartKoKr.source));\nvar regexCannotEnd = new RegExp(\"\".concat(regexCannotEndZhCn.source, \"|\").concat(regexCannotEndZhTw.source, \"|\").concat(regexCannotEndJaJp.source, \"|\").concat(regexCannotEndKoKr.source));\n/**\n * Borrow from pixi/packages/text/src/TextMetrics.ts\n */\nvar TextService = /** @class */ (function () {\n    function TextService(runtime) {\n        var _this = this;\n        this.runtime = runtime;\n        /**\n         * font metrics cache\n         */\n        this.fontMetricsCache = {};\n        this.shouldBreakByKinsokuShorui = function (char, nextChar) {\n            if (_this.isBreakingSpace(nextChar))\n                return false;\n            if (char) {\n                // Line breaking rules in CJK (Kinsoku Shori)\n                if (regexCannotEnd.exec(nextChar) || regexCannotStart.exec(char)) {\n                    return true;\n                }\n            }\n            return false;\n        };\n        this.trimByKinsokuShorui = function (prev) {\n            var next = __spreadArray([], __read(prev), false);\n            var prevLine = next[next.length - 2];\n            if (!prevLine) {\n                return prev;\n            }\n            var lastChar = prevLine[prevLine.length - 1];\n            next[next.length - 2] = prevLine.slice(0, -1);\n            next[next.length - 1] = lastChar + next[next.length - 1];\n            return next;\n        };\n    }\n    /**\n     * Calculates the ascent, descent and fontSize of a given font-style.\n     */\n    TextService.prototype.measureFont = function (font, offscreenCanvas) {\n        // as this method is used for preparing assets, don't recalculate things if we don't need to\n        if (this.fontMetricsCache[font]) {\n            return this.fontMetricsCache[font];\n        }\n        var properties = {\n            ascent: 0,\n            descent: 0,\n            fontSize: 0,\n        };\n        var canvas = this.runtime.offscreenCanvasCreator.getOrCreateCanvas(offscreenCanvas);\n        var context = this.runtime.offscreenCanvasCreator.getOrCreateContext(offscreenCanvas, {\n            willReadFrequently: true,\n        });\n        context.font = font;\n        var metricsString = TEXT_METRICS.MetricsString + TEXT_METRICS.BaselineSymbol;\n        var width = Math.ceil(context.measureText(metricsString).width);\n        var baseline = Math.ceil(context.measureText(TEXT_METRICS.BaselineSymbol).width);\n        var height = TEXT_METRICS.HeightMultiplier * baseline;\n        baseline = (baseline * TEXT_METRICS.BaselineMultiplier) | 0;\n        // @ts-ignore\n        canvas.width = width;\n        // @ts-ignore\n        canvas.height = height;\n        context.fillStyle = '#f00';\n        context.fillRect(0, 0, width, height);\n        context.font = font;\n        context.textBaseline = 'alphabetic';\n        context.fillStyle = '#000';\n        context.fillText(metricsString, 0, baseline);\n        var imagedata = context.getImageData(0, 0, width || 1, height || 1).data;\n        var pixels = imagedata.length;\n        var line = width * 4;\n        var i = 0;\n        var idx = 0;\n        var stop = false;\n        // ascent. scan from top to bottom until we find a non red pixel\n        for (i = 0; i < baseline; ++i) {\n            for (var j = 0; j < line; j += 4) {\n                if (imagedata[idx + j] !== 255) {\n                    stop = true;\n                    break;\n                }\n            }\n            if (!stop) {\n                idx += line;\n            }\n            else {\n                break;\n            }\n        }\n        properties.ascent = baseline - i;\n        idx = pixels - line;\n        stop = false;\n        // descent. scan from bottom to top until we find a non red pixel\n        for (i = height; i > baseline; --i) {\n            for (var j = 0; j < line; j += 4) {\n                if (imagedata[idx + j] !== 255) {\n                    stop = true;\n                    break;\n                }\n            }\n            if (!stop) {\n                idx -= line;\n            }\n            else {\n                break;\n            }\n        }\n        properties.descent = i - baseline;\n        properties.fontSize = properties.ascent + properties.descent;\n        this.fontMetricsCache[font] = properties;\n        return properties;\n    };\n    TextService.prototype.measureText = function (text, parsedStyle, offscreenCanvas) {\n        var _a = parsedStyle.fontSize, fontSize = _a === void 0 ? 16 : _a, _b = parsedStyle.wordWrap, wordWrap = _b === void 0 ? false : _b, strokeHeight = parsedStyle.lineHeight, _c = parsedStyle.lineWidth, lineWidth = _c === void 0 ? 1 : _c, _d = parsedStyle.textBaseline, textBaseline = _d === void 0 ? 'alphabetic' : _d, _e = parsedStyle.textAlign, textAlign = _e === void 0 ? 'start' : _e, _f = parsedStyle.letterSpacing, letterSpacing = _f === void 0 ? 0 : _f, textPath = parsedStyle.textPath; parsedStyle.textPathSide; parsedStyle.textPathStartOffset; \n        var // dropShadow = 0,\n        // dropShadowDistance = 0,\n        _g = parsedStyle.leading, \n        // dropShadow = 0,\n        // dropShadowDistance = 0,\n        leading = _g === void 0 ? 0 : _g;\n        var font = toFontString(parsedStyle);\n        // if (runtime.enableCSSParsing) {\n        var fontProperties = this.measureFont(font, offscreenCanvas);\n        // fallback in case UA disallow canvas data extraction\n        // (toDataURI, getImageData functions)\n        if (fontProperties.fontSize === 0) {\n            fontProperties.fontSize = fontSize;\n            fontProperties.ascent = fontSize;\n        }\n        // } else {\n        //   fontProperties = {\n        //     fontSize,\n        //   };\n        // }\n        var context = this.runtime.offscreenCanvasCreator.getOrCreateContext(offscreenCanvas);\n        context.font = font;\n        // no overflowing by default\n        parsedStyle.isOverflowing = false;\n        var outputText = wordWrap\n            ? this.wordWrap(text, parsedStyle, offscreenCanvas)\n            : text;\n        var lines = outputText.split(/(?:\\r\\n|\\r|\\n)/);\n        var lineWidths = new Array(lines.length);\n        var maxLineWidth = 0;\n        // account for textPath\n        if (textPath) {\n            textPath.getTotalLength();\n            // const startingPoint = textPath.getPoint(0);\n            for (var i = 0; i < lines.length; i++) {\n                var width = context.measureText(lines[i]).width +\n                    (lines[i].length - 1) * letterSpacing;\n                // for (\n                //   let i = reverse ? lines[0].length - 1 : 0;\n                //   reverse ? i >= 0 : i < lines[0].length;\n                //   reverse ? i-- : i++\n                // ) {\n                //   graphemeInfo = lineBounds[i];\n                //   if (positionInPath > totalPathLength) {\n                //     positionInPath %= totalPathLength;\n                //   } else if (positionInPath < 0) {\n                //     positionInPath += totalPathLength;\n                //   }\n                //   // it would probably much faster to send all the grapheme position for a line\n                //   // and calculate path position/angle at once.\n                //   this.setGraphemeOnPath(\n                //     positionInPath,\n                //     graphemeInfo,\n                //     startingPoint\n                //   );\n                //   positionInPath += graphemeInfo.kernedWidth;\n                // }\n            }\n        }\n        else {\n            for (var i = 0; i < lines.length; i++) {\n                // char width + letterSpacing\n                var lineWidth_1 = context.measureText(lines[i]).width +\n                    (lines[i].length - 1) * letterSpacing;\n                lineWidths[i] = lineWidth_1;\n                maxLineWidth = Math.max(maxLineWidth, lineWidth_1);\n            }\n            var width = maxLineWidth + lineWidth;\n            // if (dropShadow) {\n            //   width += dropShadowDistance;\n            // }\n            var lineHeight_1 = strokeHeight || fontProperties.fontSize + lineWidth;\n            var height = Math.max(lineHeight_1, fontProperties.fontSize + lineWidth) +\n                (lines.length - 1) * (lineHeight_1 + leading);\n            // if (dropShadow) {\n            //   height += dropShadowDistance;\n            // }\n            lineHeight_1 += leading;\n            // handle vertical text baseline\n            var offsetY_1 = 0;\n            if (textBaseline === 'middle') {\n                offsetY_1 = -height / 2;\n            }\n            else if (textBaseline === 'bottom' ||\n                textBaseline === 'alphabetic' ||\n                textBaseline === 'ideographic') {\n                offsetY_1 = -height;\n            }\n            else if (textBaseline === 'top' || textBaseline === 'hanging') {\n                offsetY_1 = 0;\n            }\n            return {\n                font: font,\n                width: width,\n                height: height,\n                lines: lines,\n                lineWidths: lineWidths,\n                lineHeight: lineHeight_1,\n                maxLineWidth: maxLineWidth,\n                fontProperties: fontProperties,\n                lineMetrics: lineWidths.map(function (width, i) {\n                    var offsetX = 0;\n                    // handle horizontal text align\n                    if (textAlign === 'center' || textAlign === 'middle') {\n                        offsetX -= width / 2;\n                    }\n                    else if (textAlign === 'right' || textAlign === 'end') {\n                        offsetX -= width;\n                    }\n                    return new Rectangle(offsetX - lineWidth / 2, offsetY_1 + i * lineHeight_1, width + lineWidth, lineHeight_1);\n                }),\n            };\n        }\n    };\n    TextService.prototype.setGraphemeOnPath = function () { };\n    TextService.prototype.wordWrap = function (text, parsedStyle, offscreenCanvas) {\n        var _this = this;\n        var _a = parsedStyle.wordWrapWidth, wordWrapWidth = _a === void 0 ? 0 : _a, _b = parsedStyle.letterSpacing, letterSpacing = _b === void 0 ? 0 : _b, _c = parsedStyle.maxLines, maxLines = _c === void 0 ? Infinity : _c, textOverflow = parsedStyle.textOverflow;\n        var context = this.runtime.offscreenCanvasCreator.getOrCreateContext(offscreenCanvas);\n        var maxWidth = wordWrapWidth + letterSpacing;\n        var ellipsis = '';\n        if (textOverflow === 'ellipsis') {\n            ellipsis = '...';\n        }\n        else if (textOverflow && textOverflow !== 'clip') {\n            ellipsis = textOverflow;\n        }\n        var lines = [];\n        var currentIndex = 0;\n        var currentWidth = 0;\n        var cache = {};\n        var calcWidth = function (char) {\n            return _this.getFromCache(char, letterSpacing, cache, context);\n        };\n        var ellipsisWidth = Array.from(ellipsis).reduce(function (prev, cur) {\n            return prev + calcWidth(cur);\n        }, 0);\n        var chars = Array.from(text);\n        for (var i = 0; i < chars.length; i++) {\n            var char = chars[i];\n            var prevChar = text[i - 1];\n            var nextChar = text[i + 1];\n            var charWidth = calcWidth(char);\n            if (this.isNewline(char)) {\n                currentIndex++;\n                // exceed maxLines, break immediately\n                if (currentIndex >= maxLines) {\n                    parsedStyle.isOverflowing = true;\n                    break;\n                }\n                currentWidth = 0;\n                lines[currentIndex] = '';\n                continue;\n            }\n            if (currentWidth > 0 && currentWidth + charWidth > maxWidth) {\n                if (currentIndex + 1 >= maxLines) {\n                    parsedStyle.isOverflowing = true;\n                    // If there is not enough space to display the string itself, it is clipped.\n                    // @see https://developer.mozilla.org/en-US/docs/Web/CSS/text-overflow#values\n                    if (ellipsisWidth > 0 && ellipsisWidth <= maxWidth) {\n                        // Backspace from line's end.\n                        var currentLineLength = lines[currentIndex].length;\n                        var lastLineWidth = 0;\n                        var lastLineIndex = currentLineLength;\n                        for (var i_1 = 0; i_1 < currentLineLength; i_1++) {\n                            var width = calcWidth(lines[currentIndex][i_1]);\n                            if (lastLineWidth + width + ellipsisWidth > maxWidth) {\n                                lastLineIndex = i_1;\n                                break;\n                            }\n                            lastLineWidth += width;\n                        }\n                        lines[currentIndex] =\n                            (lines[currentIndex] || '').slice(0, lastLineIndex) + ellipsis;\n                    }\n                    break;\n                }\n                currentIndex++;\n                currentWidth = 0;\n                lines[currentIndex] = '';\n                if (this.isBreakingSpace(char)) {\n                    continue;\n                }\n                if (!this.canBreakInLastChar(char)) {\n                    lines = this.trimToBreakable(lines);\n                    currentWidth = this.sumTextWidthByCache(lines[currentIndex] || '', cache);\n                }\n                if (this.shouldBreakByKinsokuShorui(char, nextChar)) {\n                    lines = this.trimByKinsokuShorui(lines);\n                    currentWidth += calcWidth(prevChar || '');\n                }\n            }\n            currentWidth += charWidth;\n            lines[currentIndex] = (lines[currentIndex] || '') + char;\n        }\n        return lines.join('\\n');\n    };\n    TextService.prototype.isBreakingSpace = function (char) {\n        if (typeof char !== 'string') {\n            return false;\n        }\n        return TEXT_METRICS.BreakingSpaces.indexOf(char.charCodeAt(0)) >= 0;\n    };\n    TextService.prototype.isNewline = function (char) {\n        if (typeof char !== 'string') {\n            return false;\n        }\n        return TEXT_METRICS.Newlines.indexOf(char.charCodeAt(0)) >= 0;\n    };\n    TextService.prototype.trimToBreakable = function (prev) {\n        var next = __spreadArray([], __read(prev), false);\n        var prevLine = next[next.length - 2];\n        var index = this.findBreakableIndex(prevLine);\n        if (index === -1 || !prevLine)\n            return next;\n        var trimmedChar = prevLine.slice(index, index + 1);\n        var isTrimmedWithSpace = this.isBreakingSpace(trimmedChar);\n        var trimFrom = index + 1;\n        var trimTo = index + (isTrimmedWithSpace ? 0 : 1);\n        next[next.length - 1] += prevLine.slice(trimFrom, prevLine.length);\n        next[next.length - 2] = prevLine.slice(0, trimTo);\n        return next;\n    };\n    TextService.prototype.canBreakInLastChar = function (char) {\n        if (char && LATIN_REGEX.test(char))\n            return false;\n        return true;\n    };\n    TextService.prototype.sumTextWidthByCache = function (text, cache) {\n        return text.split('').reduce(function (sum, c) {\n            if (!cache[c])\n                throw Error('cannot count the word without cache');\n            return sum + cache[c];\n        }, 0);\n    };\n    TextService.prototype.findBreakableIndex = function (line) {\n        for (var i = line.length - 1; i >= 0; i--) {\n            if (!LATIN_REGEX.test(line[i]))\n                return i;\n        }\n        return -1;\n    };\n    TextService.prototype.getFromCache = function (key, letterSpacing, cache, context) {\n        var width = cache[key];\n        if (typeof width !== 'number') {\n            var spacing = key.length * letterSpacing;\n            width = context.measureText(key).width + spacing;\n            cache[key] = width;\n        }\n        return width;\n    };\n    return TextService;\n}());\n\nvar runtime = {};\n/**\n * Replace with IoC container\n */\nvar geometryUpdaterFactory = (function () {\n    var _a;\n    var rectUpdater = new RectUpdater();\n    var polylineUpdater = new PolylineUpdater();\n    return _a = {},\n        _a[Shape.CIRCLE] = new CircleUpdater(),\n        _a[Shape.ELLIPSE] = new EllipseUpdater(),\n        _a[Shape.RECT] = rectUpdater,\n        _a[Shape.IMAGE] = rectUpdater,\n        _a[Shape.GROUP] = new GroupUpdater(),\n        _a[Shape.LINE] = new LineUpdater(),\n        _a[Shape.TEXT] = new TextUpdater(runtime),\n        _a[Shape.POLYLINE] = polylineUpdater,\n        _a[Shape.POLYGON] = polylineUpdater,\n        _a[Shape.PATH] = new PathUpdater(),\n        _a[Shape.HTML] = null,\n        _a[Shape.MESH] = null,\n        _a;\n})();\nvar CSSPropertySyntaxFactory = (function () {\n    var _a;\n    var color = new CSSPropertyColor();\n    var length = new CSSPropertyLengthOrPercentage();\n    return _a = {},\n        _a[PropertySyntax.PERCENTAGE] = null,\n        _a[PropertySyntax.NUMBER] = new CSSPropertyNumber(),\n        _a[PropertySyntax.ANGLE] = new CSSPropertyAngle(),\n        _a[PropertySyntax.DEFINED_PATH] = new CSSPropertyClipPath(),\n        _a[PropertySyntax.PAINT] = color,\n        _a[PropertySyntax.COLOR] = color,\n        _a[PropertySyntax.FILTER] = new CSSPropertyFilter(),\n        _a[PropertySyntax.LENGTH] = length,\n        _a[PropertySyntax.LENGTH_PERCENTAGE] = length,\n        _a[PropertySyntax.LENGTH_PERCENTAGE_12] = new CSSPropertyLengthOrPercentage12(),\n        _a[PropertySyntax.LENGTH_PERCENTAGE_14] = new CSSPropertyLengthOrPercentage14(),\n        _a[PropertySyntax.COORDINATE] = new CSSPropertyLengthOrPercentage(),\n        _a[PropertySyntax.OFFSET_DISTANCE] = new CSSPropertyOffsetDistance(),\n        _a[PropertySyntax.OPACITY_VALUE] = new CSSPropertyOpacity(),\n        _a[PropertySyntax.PATH] = new CSSPropertyPath(),\n        _a[PropertySyntax.LIST_OF_POINTS] = new CSSPropertyPoints(),\n        _a[PropertySyntax.SHADOW_BLUR] = new CSSPropertyShadowBlur(),\n        _a[PropertySyntax.TEXT] = new CSSPropertyText(),\n        _a[PropertySyntax.TEXT_TRANSFORM] = new CSSPropertyTextTransform(),\n        _a[PropertySyntax.TRANSFORM] = new CSSPropertyTransform(),\n        _a[PropertySyntax.TRANSFORM_ORIGIN] = new CSSPropertyTransformOrigin(),\n        _a[PropertySyntax.Z_INDEX] = new CSSPropertyZIndex(),\n        _a[PropertySyntax.MARKER] = new CSSPropertyMarker(),\n        _a;\n})();\nvar getGlobalThis = function () {\n    if (typeof globalThis !== 'undefined')\n        return globalThis;\n    if (typeof self !== 'undefined')\n        return self;\n    if (typeof window !== 'undefined')\n        return window;\n    // @ts-ignore\n    if (typeof global !== 'undefined')\n        return global;\n    return {};\n    // [!] Error: The 'this' keyword is equivalent to 'undefined' at the top level of an ES module, and has been rewritten\n    // @see https://rollupjs.org/troubleshooting/#error-this-is-undefined\n    // if (typeof this !== 'undefined') return this;\n};\n/**\n * Camera\n * `g-camera-api` will provide an advanced implementation\n */\nruntime.CameraContribution = Camera;\n/**\n * `g-web-animations-api` will provide an AnimationTimeline\n */\nruntime.AnimationTimeline = null;\nruntime.EasingFunction = null;\nruntime.offscreenCanvasCreator = new OffscreenCanvasCreator();\nruntime.sceneGraphSelector = new DefaultSceneGraphSelector();\nruntime.sceneGraphService = new DefaultSceneGraphService(runtime);\nruntime.textService = new TextService(runtime);\nruntime.geometryUpdaterFactory = geometryUpdaterFactory;\nruntime.CSSPropertySyntaxFactory = CSSPropertySyntaxFactory;\nruntime.styleValueRegistry = new DefaultStyleValueRegistry(runtime);\nruntime.layoutRegistry = null;\nruntime.globalThis = getGlobalThis();\nruntime.enableCSSParsing = false;\nruntime.enableDataset = false;\nruntime.enableStyleSyntax = true;\nruntime.enableAttributeDashCased = false;\nruntime.enableSizeAttenuation = false;\n\nvar entityCounter = 0;\nfunction resetEntityCounter() {\n    entityCounter = 0;\n}\nvar insertedEvent = new MutationEvent(ElementEvent.INSERTED, null, '', '', '', 0, '', '');\nvar removedEvent = new MutationEvent(ElementEvent.REMOVED, null, '', '', '', 0, '', '');\nvar destroyEvent = new CustomEvent(ElementEvent.DESTROY);\n/**\n * Has following capabilities:\n * * Node insert/remove, eg. appendChild, removeChild, remove...\n * * Query eg. querySelector getElementById...\n * * Animation\n */\nvar Element = /** @class */ (function (_super) {\n    __extends(Element, _super);\n    function Element() {\n        var _this = _super.call(this) || this;\n        /**\n         * Unique id.\n         */\n        _this.entity = entityCounter++;\n        _this.renderable = {\n            bounds: undefined,\n            boundsDirty: true,\n            renderBounds: undefined,\n            renderBoundsDirty: true,\n            dirtyRenderBounds: undefined,\n            dirty: false,\n        };\n        _this.cullable = {\n            strategy: Strategy.Standard,\n            visibilityPlaneMask: -1,\n            visible: true,\n            enable: true,\n        };\n        _this.transformable = {\n            dirtyFlag: false,\n            localDirtyFlag: false,\n            frozen: false,\n            localPosition: [0, 0, 0],\n            localRotation: [0, 0, 0, 1],\n            localScale: [1, 1, 1],\n            localTransform: [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1],\n            localSkew: [0, 0],\n            position: [0, 0, 0],\n            rotation: [0, 0, 0, 1],\n            scaling: [1, 1, 1],\n            worldTransform: [1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1],\n            origin: [0, 0, 0],\n        };\n        _this.sortable = {\n            dirty: false,\n            sorted: undefined,\n            renderOrder: 0,\n            dirtyChildren: [],\n            dirtyReason: undefined,\n        };\n        _this.geometry = {\n            contentBounds: undefined,\n            renderBounds: undefined,\n            dirty: true,\n        };\n        _this.rBushNode = {\n            aabb: undefined,\n        };\n        /**\n         * https://developer.mozilla.org/zh-CN/docs/Web/API/Element/namespaceURI\n         */\n        _this.namespaceURI = 'g';\n        _this.scrollLeft = 0;\n        _this.scrollTop = 0;\n        /**\n         * We don't support border now\n         * @see https://developer.mozilla.org/en-US/docs/Web/API/Element/clientTop\n         */\n        _this.clientTop = 0;\n        _this.clientLeft = 0;\n        /**\n         * is destroyed or not\n         */\n        _this.destroyed = false;\n        /**\n         * compatible with `style`\n         * @see https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/style\n         */\n        _this.style = {};\n        _this.computedStyle = runtime.enableCSSParsing\n            ? {\n                opacity: unsetKeywordValue,\n                fillOpacity: unsetKeywordValue,\n                strokeOpacity: unsetKeywordValue,\n                fill: unsetKeywordValue,\n                stroke: unsetKeywordValue,\n                transform: unsetKeywordValue,\n                transformOrigin: unsetKeywordValue,\n                visibility: unsetKeywordValue,\n                pointerEvents: unsetKeywordValue,\n                lineWidth: unsetKeywordValue,\n                lineCap: unsetKeywordValue,\n                lineJoin: unsetKeywordValue,\n                increasedLineWidthForHitTesting: unsetKeywordValue,\n                fontSize: unsetKeywordValue,\n                fontFamily: unsetKeywordValue,\n                fontStyle: unsetKeywordValue,\n                fontWeight: unsetKeywordValue,\n                fontVariant: unsetKeywordValue,\n                textAlign: unsetKeywordValue,\n                textBaseline: unsetKeywordValue,\n                textTransform: unsetKeywordValue,\n                zIndex: unsetKeywordValue,\n                filter: unsetKeywordValue,\n                shadowType: unsetKeywordValue,\n            }\n            : null;\n        /**\n         * Renderers will use these used values.\n         */\n        _this.parsedStyle = {\n        // opacity: '',\n        // fillOpacity: '',\n        // strokeOpacity: '',\n        // transformOrigin: '',\n        // visibility: '',\n        // pointerEvents: '',\n        // lineWidth: '',\n        // lineCap: '',\n        // lineJoin: '',\n        // increasedLineWidthForHitTesting: '',\n        // fontSize: '',\n        // fontFamily: '',\n        // fontStyle: '',\n        // fontWeight: '',\n        // fontVariant: '',\n        // textAlign: '',\n        // textBaseline: '',\n        // textTransform: '',\n        };\n        /**\n         * @see https://developer.mozilla.org/en-US/docs/Web/API/Element/attributes\n         */\n        _this.attributes = {};\n        return _this;\n    }\n    Object.defineProperty(Element.prototype, \"className\", {\n        /**\n         * used in `getElementsByClassName`\n         * @see https://developer.mozilla.org/en-US/docs/Web/API/Document/getElementsByClassName\n         */\n        get: function () {\n            // @ts-ignore\n            return this.getAttribute('class') || '';\n        },\n        set: function (className) {\n            this.setAttribute('class', className);\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Element.prototype, \"classList\", {\n        /**\n         * @see https://developer.mozilla.org/en-US/docs/Web/API/Element/classList\n         */\n        get: function () {\n            return this.className.split(' ').filter(function (c) { return c !== ''; });\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Element.prototype, \"tagName\", {\n        get: function () {\n            return this.nodeName;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Element.prototype, \"children\", {\n        get: function () {\n            return this.childNodes;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Element.prototype, \"childElementCount\", {\n        get: function () {\n            return this.childNodes.length;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Element.prototype, \"firstElementChild\", {\n        get: function () {\n            return this.firstChild;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Element.prototype, \"lastElementChild\", {\n        get: function () {\n            return this.lastChild;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Element.prototype, \"parentElement\", {\n        get: function () {\n            return this.parentNode;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Element.prototype, \"nextSibling\", {\n        get: function () {\n            if (this.parentNode) {\n                var index = this.parentNode.childNodes.indexOf(this);\n                return this.parentNode.childNodes[index + 1] || null;\n            }\n            return null;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Element.prototype, \"previousSibling\", {\n        get: function () {\n            if (this.parentNode) {\n                var index = this.parentNode.childNodes.indexOf(this);\n                return this.parentNode.childNodes[index - 1] || null;\n            }\n            return null;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Element.prototype.cloneNode = function (deep) {\n        throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED);\n    };\n    Element.prototype.appendChild = function (child, index) {\n        var _a;\n        if (child.destroyed) {\n            throw new Error(ERROR_MSG_APPEND_DESTROYED_ELEMENT);\n        }\n        runtime.sceneGraphService.attach(child, this, index);\n        if ((_a = this.ownerDocument) === null || _a === void 0 ? void 0 : _a.defaultView) {\n            this.ownerDocument.defaultView.mountChildren(child);\n        }\n        // @ts-ignore\n        if (this.isMutationObserved) {\n            insertedEvent.relatedNode = this;\n            child.dispatchEvent(insertedEvent);\n        }\n        return child;\n    };\n    Element.prototype.insertBefore = function (newChild, refChild) {\n        if (!refChild) {\n            this.appendChild(newChild);\n        }\n        else {\n            if (newChild.parentElement) {\n                newChild.parentElement.removeChild(newChild);\n            }\n            var index = this.childNodes.indexOf(refChild);\n            if (index === -1) {\n                this.appendChild(newChild);\n            }\n            else {\n                this.appendChild(newChild, index);\n            }\n        }\n        return newChild;\n    };\n    Element.prototype.replaceChild = function (newChild, oldChild) {\n        var index = this.childNodes.indexOf(oldChild);\n        this.removeChild(oldChild);\n        this.appendChild(newChild, index);\n        return oldChild;\n    };\n    Element.prototype.removeChild = function (child) {\n        var _a;\n        // should emit on itself before detach\n        removedEvent.relatedNode = this;\n        child.dispatchEvent(removedEvent);\n        if ((_a = child.ownerDocument) === null || _a === void 0 ? void 0 : _a.defaultView) {\n            child.ownerDocument.defaultView.unmountChildren(child);\n        }\n        // remove from scene graph\n        runtime.sceneGraphService.detach(child);\n        return child;\n    };\n    /**\n     * Remove all children which can be appended to its original parent later again.\n     */\n    Element.prototype.removeChildren = function () {\n        for (var i = this.childNodes.length - 1; i >= 0; i--) {\n            var child = this.childNodes[i];\n            this.removeChild(child);\n        }\n    };\n    /**\n     * Recursively destroy all children which can not be appended to its original parent later again.\n     */\n    Element.prototype.destroyChildren = function () {\n        for (var i = this.childNodes.length - 1; i >= 0; i--) {\n            var child = this.childNodes[i];\n            if (child.childNodes.length) {\n                child.destroyChildren();\n            }\n            child.destroy();\n        }\n    };\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Element/matches\n     */\n    Element.prototype.matches = function (selector) {\n        return runtime.sceneGraphService.matches(selector, this);\n    };\n    Element.prototype.getElementById = function (id) {\n        return runtime.sceneGraphService.querySelector(\"#\".concat(id), this);\n    };\n    Element.prototype.getElementsByName = function (name) {\n        return runtime.sceneGraphService.querySelectorAll(\"[name=\\\"\".concat(name, \"\\\"]\"), this);\n    };\n    Element.prototype.getElementsByClassName = function (className) {\n        return runtime.sceneGraphService.querySelectorAll(\".\".concat(className), this);\n    };\n    Element.prototype.getElementsByTagName = function (tagName) {\n        return runtime.sceneGraphService.querySelectorAll(tagName, this);\n    };\n    Element.prototype.querySelector = function (selectors) {\n        return runtime.sceneGraphService.querySelector(selectors, this);\n    };\n    Element.prototype.querySelectorAll = function (selectors) {\n        return runtime.sceneGraphService.querySelectorAll(selectors, this);\n    };\n    /**\n     * should traverses the element and its parents (heading toward the document root)\n     * until it finds a node that matches the specified CSS selector.\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Element/closest\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Element/closest#polyfill\n     */\n    Element.prototype.closest = function (selectors) {\n        var el = this;\n        do {\n            if (runtime.sceneGraphService.matches(selectors, el))\n                return el;\n            el = el.parentElement;\n        } while (el !== null);\n        return null;\n    };\n    /**\n     * search in scene group, but should not include itself\n     */\n    Element.prototype.find = function (filter) {\n        var _this = this;\n        var target = null;\n        this.forEach(function (object) {\n            if (object !== _this && filter(object)) {\n                target = object;\n                return true;\n            }\n            return false;\n        });\n        return target;\n    };\n    Element.prototype.findAll = function (filter) {\n        var _this = this;\n        var objects = [];\n        this.forEach(function (object) {\n            if (object !== _this && filter(object)) {\n                objects.push(object);\n            }\n        });\n        return objects;\n    };\n    /**\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Element/after\n     */\n    Element.prototype.after = function () {\n        var _this = this;\n        var nodes = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            nodes[_i] = arguments[_i];\n        }\n        if (this.parentNode) {\n            var index_1 = this.parentNode.childNodes.indexOf(this);\n            nodes.forEach(function (node, i) { var _a; return (_a = _this.parentNode) === null || _a === void 0 ? void 0 : _a.appendChild(node, index_1 + i + 1); });\n        }\n    };\n    /**\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Element/before\n     */\n    Element.prototype.before = function () {\n        var _a;\n        var nodes = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            nodes[_i] = arguments[_i];\n        }\n        if (this.parentNode) {\n            var index = this.parentNode.childNodes.indexOf(this);\n            var _b = __read(nodes), first = _b[0], rest = _b.slice(1);\n            this.parentNode.appendChild(first, index);\n            (_a = first).after.apply(_a, __spreadArray([], __read(rest), false));\n        }\n    };\n    /**\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Element/replaceWith\n     */\n    Element.prototype.replaceWith = function () {\n        var nodes = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            nodes[_i] = arguments[_i];\n        }\n        this.after.apply(this, __spreadArray([], __read(nodes), false));\n        this.remove();\n    };\n    /**\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Element/append\n     */\n    Element.prototype.append = function () {\n        var _this = this;\n        var nodes = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            nodes[_i] = arguments[_i];\n        }\n        nodes.forEach(function (node) { return _this.appendChild(node); });\n    };\n    /**\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Element/prepend\n     */\n    Element.prototype.prepend = function () {\n        var _this = this;\n        var nodes = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            nodes[_i] = arguments[_i];\n        }\n        nodes.forEach(function (node, i) { return _this.appendChild(node, i); });\n    };\n    /**\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Element/replaceChildren\n     */\n    Element.prototype.replaceChildren = function () {\n        var nodes = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            nodes[_i] = arguments[_i];\n        }\n        while (this.childNodes.length && this.firstChild) {\n            this.removeChild(this.firstChild);\n        }\n        this.append.apply(this, __spreadArray([], __read(nodes), false));\n    };\n    /**\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Element/remove\n     */\n    Element.prototype.remove = function () {\n        if (this.parentNode) {\n            return this.parentNode.removeChild(this);\n        }\n        return this;\n    };\n    Element.prototype.destroy = function () {\n        // destroy itself before remove\n        this.dispatchEvent(destroyEvent);\n        // remove from scenegraph first\n        this.remove();\n        // remove event listeners\n        this.emitter.removeAllListeners();\n        this.destroyed = true;\n    };\n    Element.prototype.getGeometryBounds = function () {\n        return runtime.sceneGraphService.getGeometryBounds(this);\n    };\n    Element.prototype.getRenderBounds = function () {\n        return runtime.sceneGraphService.getBounds(this, true);\n    };\n    /**\n     * get bounds in world space, account for children\n     */\n    Element.prototype.getBounds = function () {\n        return runtime.sceneGraphService.getBounds(this);\n    };\n    /**\n     * get bounds in local space, account for children\n     */\n    Element.prototype.getLocalBounds = function () {\n        return runtime.sceneGraphService.getLocalBounds(this);\n    };\n    /**\n     * account for context's bounds in client space,\n     * but not accounting for children\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Element/getBoundingClientRect\n     */\n    Element.prototype.getBoundingClientRect = function () {\n        return runtime.sceneGraphService.getBoundingClientRect(this);\n    };\n    /**\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Element/getClientRects\n     */\n    Element.prototype.getClientRects = function () {\n        return [this.getBoundingClientRect()];\n    };\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Element/computedStyleMap\n     * eg. circle.computedStyleMap().get('fill');\n     */\n    Element.prototype.computedStyleMap = function () {\n        return new Map(Object.entries(this.computedStyle));\n    };\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Element/getAttributeNames\n     */\n    Element.prototype.getAttributeNames = function () {\n        return Object.keys(this.attributes);\n    };\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Element/getAttribute\n     */\n    Element.prototype.getAttribute = function (name) {\n        // @see https://github.com/antvis/G/issues/1267\n        if (isSymbol(name)) {\n            return runtime.enableCSSParsing ? null : undefined;\n        }\n        var value = this.attributes[name];\n        if (value === undefined) {\n            if (runtime.enableAttributeDashCased) {\n                var attributeName = formatAttributeName(name);\n                value = this.attributes[attributeName];\n            }\n            // if the given attribute does not exist, the value returned will either be null or \"\"\n            return runtime.enableCSSParsing ? (isNil(value) ? null : value) : value;\n        }\n        else {\n            return value;\n        }\n    };\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Element/hasAttribute\n     */\n    Element.prototype.hasAttribute = function (qualifiedName) {\n        return this.getAttributeNames().includes(qualifiedName);\n    };\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Element/hasAttributes\n     */\n    Element.prototype.hasAttributes = function () {\n        return !!this.getAttributeNames().length;\n    };\n    /**\n     * should use removeAttribute() instead of setting the attribute value to null either directly or using setAttribute(). Many attributes will not behave as expected if you set them to null.\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Element/removeAttribute\n     */\n    Element.prototype.removeAttribute = function (attributeName) {\n        this.setAttribute(attributeName, null);\n        delete this.attributes[attributeName];\n    };\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Element/setAttribute\n     */\n    Element.prototype.setAttribute = function (attributeName, value, force, memoize) {\n        this.attributes[attributeName] = value;\n    };\n    Element.prototype.getAttributeNS = function (namespace, localName) {\n        throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED);\n    };\n    Element.prototype.getAttributeNode = function (qualifiedName) {\n        throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED);\n    };\n    Element.prototype.getAttributeNodeNS = function (namespace, localName) {\n        throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED);\n    };\n    Element.prototype.hasAttributeNS = function (namespace, localName) {\n        throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED);\n    };\n    Element.prototype.removeAttributeNS = function (namespace, localName) {\n        throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED);\n    };\n    Element.prototype.removeAttributeNode = function (attr) {\n        throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED);\n    };\n    Element.prototype.setAttributeNS = function (namespace, qualifiedName, value) {\n        throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED);\n    };\n    Element.prototype.setAttributeNode = function (attr) {\n        throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED);\n    };\n    Element.prototype.setAttributeNodeNS = function (attr) {\n        throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED);\n    };\n    Element.prototype.toggleAttribute = function (qualifiedName, force) {\n        throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED);\n    };\n    return Element;\n}(Node));\n\nfunction isDisplayObject(value) {\n    return !!(value === null || value === void 0 ? void 0 : value.nodeName);\n}\nvar Proxy = runtime.globalThis.Proxy\n    ? runtime.globalThis.Proxy\n    : function () { };\nvar mutationEvent = new MutationEvent(ElementEvent.ATTR_MODIFIED, null, null, null, null, MutationEvent.MODIFICATION, null, null);\nvar DEFAULT_STYLE_PROPS = {\n    opacity: '',\n    fillOpacity: '',\n    strokeOpacity: '',\n    fill: '',\n    stroke: '',\n    transform: '',\n    transformOrigin: '',\n    visibility: '',\n    pointerEvents: '',\n    lineWidth: '',\n    lineCap: '',\n    lineJoin: '',\n    increasedLineWidthForHitTesting: '',\n    fontSize: '',\n    fontFamily: '',\n    fontStyle: '',\n    fontWeight: '',\n    fontVariant: '',\n    textAlign: '',\n    textBaseline: '',\n    textTransform: '',\n    zIndex: '',\n    filter: '',\n    shadowType: '',\n};\nvar DEFAULT_PARSED_STYLE_PROPS = {\n    fill: noneColor,\n    stroke: noneColor,\n    transform: [],\n    zIndex: 0,\n    filter: [],\n    shadowType: 'outer',\n    miterLimit: 10,\n};\n// const DEFAULT_PARSED_STYLE_PROPS_CSS_DISABLED = {\n//   ...DEFAULT_PARSED_STYLE_PROPS,\n//   opacity: 1,\n//   fillOpacity: 1,\n//   strokeOpacity: 1,\n//   visibility: 'visible',\n//   pointerEvents: 'auto',\n//   lineWidth: 1,\n//   lineCap: 'butt',\n//   lineJoin: 'miter',\n//   increasedLineWidthForHitTesting: 0,\n//   fillRule: 'nonzero',\n//   // TODO: transformOrigin\n// };\nvar INHERITABLE_BASE_STYLE_PROPS = [\n    'opacity',\n    'fillOpacity',\n    'strokeOpacity',\n    'transformOrigin',\n    'visibility',\n    'pointerEvents',\n    'lineWidth',\n    'lineCap',\n    'lineJoin',\n    'increasedLineWidthForHitTesting',\n];\nvar INHERITABLE_STYLE_PROPS = __spreadArray(__spreadArray([], __read(INHERITABLE_BASE_STYLE_PROPS), false), [\n    'fontSize',\n    'fontFamily',\n    'fontStyle',\n    'fontWeight',\n    'fontVariant',\n    'textAlign',\n    'textBaseline',\n    'textTransform',\n], false);\nvar DATASET_PREFIX = 'data-';\n/**\n * prototype chains: DisplayObject -> Element -> Node -> EventTarget\n *\n * mixins: Animatable, Transformable, Visible\n * @see https://github.com/tannerntannern/ts-mixer/blob/master/README.md#mixing-generic-classes\n *\n * Provide abilities in scene graph, such as:\n * * transform `translate/rotate/scale`\n * * add/remove child\n * * visibility and z-index\n *\n * Those abilities are implemented with those components: `Transform/Sortable/Visible`.\n *\n * Emit following events:\n * * init\n * * destroy\n * * attributeChanged\n */\nvar DisplayObject = /** @class */ (function (_super) {\n    __extends(DisplayObject, _super);\n    function DisplayObject(config) {\n        var _this = _super.call(this) || this;\n        _this.isCustomElement = false;\n        _this.isMutationObserved = false;\n        /**\n         * push to active animations after calling `animate()`\n         */\n        _this.activeAnimations = [];\n        // assign name, id to config\n        // eg. group.get('name')\n        _this.config = config;\n        // init scene graph node\n        _this.id = _this.config.id || '';\n        _this.name = _this.config.name || '';\n        if (_this.config.className || _this.config.class) {\n            _this.className = _this.config.className || _this.config.class;\n        }\n        _this.nodeName = _this.config.type || Shape.GROUP;\n        if (runtime.enableCSSParsing) {\n            Object.assign(_this.attributes, DEFAULT_STYLE_PROPS);\n            Object.assign(_this.parsedStyle, DEFAULT_PARSED_STYLE_PROPS, _this.config.initialParsedStyle);\n        }\n        else if (_this.config.initialParsedStyle) {\n            Object.assign(_this.parsedStyle, \n            // DEFAULT_PARSED_STYLE_PROPS_CSS_DISABLED,\n            _this.config.initialParsedStyle);\n        }\n        // start to process attributes\n        _this.initAttributes(_this.config.style);\n        if (runtime.enableDataset) {\n            _this.dataset = new Proxy({}, {\n                get: function (target, name) {\n                    var formattedName = \"\".concat(DATASET_PREFIX).concat(kebabize(name));\n                    if (target[formattedName] !== undefined) {\n                        return target[formattedName];\n                    }\n                    return _this.getAttribute(formattedName);\n                },\n                set: function (_, prop, value) {\n                    _this.setAttribute(\"\".concat(DATASET_PREFIX).concat(kebabize(prop)), value);\n                    return true;\n                },\n            });\n        }\n        if (runtime.enableStyleSyntax) {\n            _this.style = new Proxy(\n            // @ts-ignore\n            {\n                // ...this.attributes,\n                setProperty: function (propertyName, value) {\n                    _this.setAttribute(propertyName, value);\n                },\n                getPropertyValue: function (propertyName) {\n                    return _this.getAttribute(propertyName);\n                },\n                removeProperty: function (propertyName) {\n                    _this.removeAttribute(propertyName);\n                },\n                item: function () {\n                    return '';\n                },\n            }, {\n                get: function (target, name) {\n                    if (target[name] !== undefined) {\n                        // if (name in target) {\n                        return target[name];\n                    }\n                    return _this.getAttribute(name);\n                },\n                set: function (_, prop, value) {\n                    _this.setAttribute(prop, value);\n                    return true;\n                },\n            });\n        }\n        return _this;\n    }\n    DisplayObject.prototype.destroy = function () {\n        _super.prototype.destroy.call(this);\n        // stop all active animations\n        this.getAnimations().forEach(function (animation) {\n            animation.cancel();\n        });\n        // FIXME\n        // this.renderable = null;\n        // this.cullable = null;\n        // this.transformable = null;\n        // this.rBushNode = null;\n        // this.geometry = null;\n        // this.sortable = null;\n    };\n    DisplayObject.prototype.cloneNode = function (deep, customCloneFunc) {\n        var clonedStyle = __assign({}, this.attributes);\n        for (var attributeName in clonedStyle) {\n            var attribute = clonedStyle[attributeName];\n            // @see https://github.com/antvis/G/issues/1095\n            if (isDisplayObject(attribute) &&\n                // share the same clipPath if possible\n                attributeName !== 'clipPath' &&\n                attributeName !== 'offsetPath' &&\n                attributeName !== 'textPath') {\n                clonedStyle[attributeName] = attribute.cloneNode(deep);\n            }\n            // TODO: clone other type\n            if (customCloneFunc) {\n                clonedStyle[attributeName] = customCloneFunc(attributeName, attribute);\n            }\n        }\n        var cloned = new this.constructor({\n            // copy id & name\n            // @see https://developer.mozilla.org/en-US/docs/Web/API/Node/cloneNode#notes\n            id: this.id,\n            name: this.name,\n            className: this.name,\n            interactive: this.interactive,\n            style: clonedStyle,\n        });\n        // apply transform\n        cloned.setLocalTransform(this.getLocalTransform());\n        if (deep) {\n            this.children.forEach(function (child) {\n                // skip marker\n                if (!child.style.isMarker) {\n                    var clonedChild = child.cloneNode(deep);\n                    cloned.appendChild(clonedChild);\n                }\n            });\n        }\n        return cloned;\n    };\n    DisplayObject.prototype.initAttributes = function (attributes) {\n        if (attributes === void 0) { attributes = {}; }\n        var renderable = this.renderable;\n        var options = {\n            forceUpdateGeometry: true,\n            // usedAttributes:\n            //   // only Group / Text should account for text relative props\n            //   this.tagName === Shape.GROUP || this.tagName === Shape.TEXT\n            //     ? INHERITABLE_STYLE_PROPS\n            //     : INHERITABLE_BASE_STYLE_PROPS,\n        };\n        if (runtime.enableCSSParsing) {\n            // @ts-ignore\n            options.usedAttributes = INHERITABLE_STYLE_PROPS;\n        }\n        // account for FCP, process properties as less as possible\n        var formattedAttributes = attributes;\n        if (runtime.enableAttributeDashCased) {\n            // @ts-ignore\n            formattedAttributes = {};\n            for (var name_1 in attributes) {\n                var attributeName = formatAttributeName(name_1);\n                formattedAttributes[attributeName] = attributes[name_1];\n            }\n        }\n        runtime.styleValueRegistry.processProperties(this, formattedAttributes, options);\n        // redraw at next frame\n        renderable.dirty = true;\n    };\n    DisplayObject.prototype.setAttribute = function (name, value, force, memoize) {\n        if (force === void 0) { force = false; }\n        if (memoize === void 0) { memoize = true; }\n        if (runtime.enableAttributeDashCased) {\n            name = formatAttributeName(name);\n        }\n        // ignore undefined value\n        if (isUndefined(value)) {\n            return;\n        }\n        if (force || value !== this.attributes[name]) {\n            this.internalSetAttribute(name, value, { memoize: memoize });\n            _super.prototype.setAttribute.call(this, name, value);\n        }\n    };\n    /**\n     * called when attributes get changed or initialized\n     */\n    DisplayObject.prototype.internalSetAttribute = function (name, value, parseOptions) {\n        var _a;\n        if (parseOptions === void 0) { parseOptions = {}; }\n        var renderable = this.renderable;\n        var oldValue = this.attributes[name];\n        var oldParsedValue = this.parsedStyle[name];\n        runtime.styleValueRegistry.processProperties(this, (_a = {},\n            _a[name] = value,\n            _a), parseOptions);\n        // redraw at next frame\n        renderable.dirty = true;\n        var newParsedValue = this.parsedStyle[name];\n        if (this.isConnected) {\n            mutationEvent.relatedNode = this;\n            mutationEvent.prevValue = oldValue;\n            mutationEvent.newValue = value;\n            mutationEvent.attrName = name;\n            mutationEvent.prevParsedValue = oldParsedValue;\n            mutationEvent.newParsedValue = newParsedValue;\n            if (this.isMutationObserved) {\n                this.dispatchEvent(mutationEvent);\n            }\n            else {\n                mutationEvent.target = this;\n                this.ownerDocument.defaultView.dispatchEvent(mutationEvent, true);\n            }\n        }\n        if (((this.isCustomElement && this.isConnected) || !this.isCustomElement) &&\n            this.attributeChangedCallback) {\n            this.attributeChangedCallback(name, oldValue, value, oldParsedValue, newParsedValue);\n        }\n    };\n    // #region transformable\n    /**\n     * returns different values than getBoundingClientRect(), as the latter returns value relative to the viewport\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/SVGGraphicsElement/getBBox\n     *\n     * FIXME: It is worth noting that getBBox responds to original untransformed values of a drawn object.\n     * @see https://www.w3.org/Graphics/SVG/IG/resources/svgprimer.html#getBBox\n     */\n    DisplayObject.prototype.getBBox = function () {\n        var aabb = this.getBounds();\n        var _a = __read(aabb.getMin(), 2), left = _a[0], top = _a[1];\n        var _b = __read(aabb.getMax(), 2), right = _b[0], bottom = _b[1];\n        return new Rectangle(left, top, right - left, bottom - top);\n    };\n    DisplayObject.prototype.setOrigin = function (position, y, z) {\n        if (y === void 0) { y = 0; }\n        if (z === void 0) { z = 0; }\n        runtime.sceneGraphService.setOrigin(this, createVec3(position, y, z));\n        return this;\n    };\n    DisplayObject.prototype.getOrigin = function () {\n        return runtime.sceneGraphService.getOrigin(this);\n    };\n    /**\n     * set position in world space\n     */\n    DisplayObject.prototype.setPosition = function (position, y, z) {\n        if (y === void 0) { y = 0; }\n        if (z === void 0) { z = 0; }\n        runtime.sceneGraphService.setPosition(this, createVec3(position, y, z));\n        return this;\n    };\n    /**\n     * set position in local space\n     */\n    DisplayObject.prototype.setLocalPosition = function (position, y, z) {\n        if (y === void 0) { y = 0; }\n        if (z === void 0) { z = 0; }\n        runtime.sceneGraphService.setLocalPosition(this, createVec3(position, y, z));\n        return this;\n    };\n    /**\n     * translate in world space\n     */\n    DisplayObject.prototype.translate = function (position, y, z) {\n        if (y === void 0) { y = 0; }\n        if (z === void 0) { z = 0; }\n        runtime.sceneGraphService.translate(this, createVec3(position, y, z));\n        return this;\n    };\n    /**\n     * translate in local space\n     */\n    DisplayObject.prototype.translateLocal = function (position, y, z) {\n        if (y === void 0) { y = 0; }\n        if (z === void 0) { z = 0; }\n        runtime.sceneGraphService.translateLocal(this, createVec3(position, y, z));\n        return this;\n    };\n    DisplayObject.prototype.getPosition = function () {\n        return runtime.sceneGraphService.getPosition(this);\n    };\n    DisplayObject.prototype.getLocalPosition = function () {\n        return runtime.sceneGraphService.getLocalPosition(this);\n    };\n    /**\n     * compatible with G 3.0\n     *\n     * scaling in local space\n     * scale(10) = scale(10, 10, 10)\n     *\n     * we can't set scale in world space\n     */\n    DisplayObject.prototype.scale = function (scaling, y, z) {\n        return this.scaleLocal(scaling, y, z);\n    };\n    DisplayObject.prototype.scaleLocal = function (scaling, y, z) {\n        if (typeof scaling === 'number') {\n            y = y || scaling;\n            z = z || scaling;\n            scaling = createVec3(scaling, y, z);\n        }\n        runtime.sceneGraphService.scaleLocal(this, scaling);\n        return this;\n    };\n    /**\n     * set scaling in local space\n     */\n    DisplayObject.prototype.setLocalScale = function (scaling, y, z) {\n        if (typeof scaling === 'number') {\n            y = y || scaling;\n            z = z || scaling;\n            scaling = createVec3(scaling, y, z);\n        }\n        runtime.sceneGraphService.setLocalScale(this, scaling);\n        return this;\n    };\n    /**\n     * get scaling in local space\n     */\n    DisplayObject.prototype.getLocalScale = function () {\n        return runtime.sceneGraphService.getLocalScale(this);\n    };\n    /**\n     * get scaling in world space\n     */\n    DisplayObject.prototype.getScale = function () {\n        return runtime.sceneGraphService.getScale(this);\n    };\n    /**\n     * only return degrees of Z axis in world space\n     */\n    DisplayObject.prototype.getEulerAngles = function () {\n        var _a = __read(getEuler(vec3.create(), runtime.sceneGraphService.getWorldTransform(this)), 3), ez = _a[2];\n        return rad2deg(ez);\n    };\n    /**\n     * only return degrees of Z axis in local space\n     */\n    DisplayObject.prototype.getLocalEulerAngles = function () {\n        var _a = __read(getEuler(vec3.create(), runtime.sceneGraphService.getLocalRotation(this)), 3), ez = _a[2];\n        return rad2deg(ez);\n    };\n    /**\n     * set euler angles(degrees) in world space\n     */\n    DisplayObject.prototype.setEulerAngles = function (z) {\n        runtime.sceneGraphService.setEulerAngles(this, 0, 0, z);\n        return this;\n    };\n    /**\n     * set euler angles(degrees) in local space\n     */\n    DisplayObject.prototype.setLocalEulerAngles = function (z) {\n        runtime.sceneGraphService.setLocalEulerAngles(this, 0, 0, z);\n        return this;\n    };\n    DisplayObject.prototype.rotateLocal = function (x, y, z) {\n        if (isNil(y) && isNil(z)) {\n            runtime.sceneGraphService.rotateLocal(this, 0, 0, x);\n        }\n        else {\n            runtime.sceneGraphService.rotateLocal(this, x, y, z);\n        }\n        return this;\n    };\n    DisplayObject.prototype.rotate = function (x, y, z) {\n        if (isNil(y) && isNil(z)) {\n            runtime.sceneGraphService.rotate(this, 0, 0, x);\n        }\n        else {\n            runtime.sceneGraphService.rotate(this, x, y, z);\n        }\n        return this;\n    };\n    DisplayObject.prototype.setRotation = function (rotation, y, z, w) {\n        runtime.sceneGraphService.setRotation(this, rotation, y, z, w);\n        return this;\n    };\n    DisplayObject.prototype.setLocalRotation = function (rotation, y, z, w) {\n        runtime.sceneGraphService.setLocalRotation(this, rotation, y, z, w);\n        return this;\n    };\n    DisplayObject.prototype.setLocalSkew = function (skew, y) {\n        runtime.sceneGraphService.setLocalSkew(this, skew, y);\n        return this;\n    };\n    DisplayObject.prototype.getRotation = function () {\n        return runtime.sceneGraphService.getRotation(this);\n    };\n    DisplayObject.prototype.getLocalRotation = function () {\n        return runtime.sceneGraphService.getLocalRotation(this);\n    };\n    DisplayObject.prototype.getLocalSkew = function () {\n        return runtime.sceneGraphService.getLocalSkew(this);\n    };\n    DisplayObject.prototype.getLocalTransform = function () {\n        return runtime.sceneGraphService.getLocalTransform(this);\n    };\n    DisplayObject.prototype.getWorldTransform = function () {\n        return runtime.sceneGraphService.getWorldTransform(this);\n    };\n    DisplayObject.prototype.setLocalTransform = function (transform) {\n        runtime.sceneGraphService.setLocalTransform(this, transform);\n        return this;\n    };\n    DisplayObject.prototype.resetLocalTransform = function () {\n        runtime.sceneGraphService.resetLocalTransform(this);\n    };\n    // #endregion transformable\n    // #region animatable\n    /**\n     * returns an array of all Animation objects affecting this element\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/Element/getAnimations\n     */\n    DisplayObject.prototype.getAnimations = function () {\n        return this.activeAnimations;\n    };\n    /**\n     * create an animation with WAAPI\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Element/animate\n     */\n    DisplayObject.prototype.animate = function (keyframes, options) {\n        var _a;\n        var timeline = (_a = this.ownerDocument) === null || _a === void 0 ? void 0 : _a.timeline;\n        if (timeline) {\n            return timeline.play(this, keyframes, options);\n        }\n        return null;\n    };\n    // #endregion animatable\n    // #region visible\n    /**\n     * shortcut for Used value of `visibility`\n     */\n    DisplayObject.prototype.isVisible = function () {\n        var _a, _b;\n        return runtime.enableCSSParsing\n            ? ((_a = this.parsedStyle) === null || _a === void 0 ? void 0 : _a.visibility) === 'visible'\n            : ((_b = this.parsedStyle) === null || _b === void 0 ? void 0 : _b.visibility) !== 'hidden';\n    };\n    Object.defineProperty(DisplayObject.prototype, \"interactive\", {\n        get: function () {\n            return this.isInteractive();\n        },\n        set: function (b) {\n            this.style.pointerEvents = b ? 'auto' : 'none';\n        },\n        enumerable: false,\n        configurable: true\n    });\n    DisplayObject.prototype.isInteractive = function () {\n        var _a;\n        return ((_a = this.parsedStyle) === null || _a === void 0 ? void 0 : _a.pointerEvents) !== 'none';\n    };\n    DisplayObject.prototype.isCulled = function () {\n        return !!(this.cullable && this.cullable.enable && !this.cullable.visible);\n    };\n    /**\n     * bring to front in current group\n     */\n    DisplayObject.prototype.toFront = function () {\n        if (this.parentNode) {\n            this.style.zIndex =\n                Math.max.apply(Math, __spreadArray([], __read(this.parentNode.children.map(function (child) {\n                    return Number(child.style.zIndex);\n                })), false)) + 1;\n        }\n        return this;\n    };\n    /**\n     * send to back in current group\n     */\n    DisplayObject.prototype.toBack = function () {\n        if (this.parentNode) {\n            this.style.zIndex =\n                Math.min.apply(Math, __spreadArray([], __read(this.parentNode.children.map(function (child) {\n                    return Number(child.style.zIndex);\n                })), false)) - 1;\n        }\n        return this;\n    };\n    // #endregion visible\n    // #region deprecated\n    /**\n     * compatible with G 3.0\n     * @alias object.config\n     * @deprecated\n     */\n    DisplayObject.prototype.getConfig = function () {\n        return this.config;\n    };\n    DisplayObject.prototype.attr = function () {\n        var _this = this;\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        var _a = __read(args, 2), name = _a[0], value = _a[1];\n        if (!name) {\n            return this.attributes;\n        }\n        if (isObject(name)) {\n            Object.keys(name).forEach(function (key) {\n                _this.setAttribute(key, name[key]);\n            });\n            return this;\n        }\n        if (args.length === 2) {\n            this.setAttribute(name, value);\n            return this;\n        }\n        return this.attributes[name];\n    };\n    /**\n     * return 3x3 matrix in world space\n     * @deprecated\n     */\n    DisplayObject.prototype.getMatrix = function (transformMat4) {\n        var transform = transformMat4 || this.getWorldTransform();\n        var _a = __read(mat4.getTranslation(vec3.create(), transform), 2), tx = _a[0], ty = _a[1];\n        var _b = __read(mat4.getScaling(vec3.create(), transform), 2), sx = _b[0], sy = _b[1];\n        var rotation = mat4.getRotation(quat$1.create(), transform);\n        var _c = __read(getEuler(vec3.create(), rotation), 3), eux = _c[0], euz = _c[2];\n        // gimbal lock at 90 degrees\n        return fromRotationTranslationScale(eux || euz, tx, ty, sx, sy);\n    };\n    /**\n     * return 3x3 matrix in local space\n     * @deprecated\n     */\n    DisplayObject.prototype.getLocalMatrix = function () {\n        return this.getMatrix(this.getLocalTransform());\n    };\n    /**\n     * set 3x3 matrix in world space\n     * @deprecated\n     */\n    DisplayObject.prototype.setMatrix = function (mat) {\n        var _a = __read(decompose(mat), 5), tx = _a[0], ty = _a[1], scalingX = _a[2], scalingY = _a[3], angle = _a[4];\n        this.setEulerAngles(angle)\n            .setPosition(tx, ty)\n            .setLocalScale(scalingX, scalingY);\n    };\n    /**\n     * set 3x3 matrix in local space\n     * @deprecated\n     */\n    DisplayObject.prototype.setLocalMatrix = function (mat) {\n        var _a = __read(decompose(mat), 5), tx = _a[0], ty = _a[1], scalingX = _a[2], scalingY = _a[3], angle = _a[4];\n        this.setLocalEulerAngles(angle)\n            .setLocalPosition(tx, ty)\n            .setLocalScale(scalingX, scalingY);\n    };\n    /**\n     * Use `visibility: visible` instead.\n     * @deprecated\n     */\n    DisplayObject.prototype.show = function () {\n        if (runtime.enableCSSParsing) {\n            this.style.visibility = 'visible';\n        }\n        else {\n            this.forEach(function (object) {\n                object.style.visibility = 'visible';\n            });\n        }\n    };\n    /**\n     * Use `visibility: hidden` instead.\n     * @deprecated\n     */\n    DisplayObject.prototype.hide = function () {\n        if (runtime.enableCSSParsing) {\n            this.style.visibility = 'hidden';\n        }\n        else {\n            this.forEach(function (object) {\n                object.style.visibility = 'hidden';\n            });\n        }\n    };\n    /**\n     * Use `childElementCount` instead.\n     * @deprecated\n     */\n    DisplayObject.prototype.getCount = function () {\n        return this.childElementCount;\n    };\n    /**\n     * Use `parentElement` instead.\n     * @deprecated\n     */\n    DisplayObject.prototype.getParent = function () {\n        return this.parentElement;\n    };\n    /**\n     * Use `children` instead.\n     * @deprecated\n     */\n    DisplayObject.prototype.getChildren = function () {\n        return this.children;\n    };\n    /**\n     * Use `firstElementChild` instead.\n     * @deprecated\n     */\n    DisplayObject.prototype.getFirst = function () {\n        return this.firstElementChild;\n    };\n    /**\n     * Use `lastElementChild` instead.\n     * @deprecated\n     */\n    DisplayObject.prototype.getLast = function () {\n        return this.lastElementChild;\n    };\n    /**\n     * Use `this.children[index]` instead.\n     * @deprecated\n     */\n    DisplayObject.prototype.getChildByIndex = function (index) {\n        return this.children[index] || null;\n    };\n    /**\n     * Use `appendChild` instead.\n     * @deprecated\n     */\n    DisplayObject.prototype.add = function (child, index) {\n        return this.appendChild(child, index);\n    };\n    /**\n     * @deprecated\n     */\n    DisplayObject.prototype.set = function (name, value) {\n        // @ts-ignore\n        this.config[name] = value;\n    };\n    /**\n     * @deprecated\n     */\n    DisplayObject.prototype.get = function (name) {\n        return this.config[name];\n    };\n    /**\n     * Use `setPosition` instead.\n     * @deprecated\n     */\n    DisplayObject.prototype.moveTo = function (position, y, z) {\n        if (y === void 0) { y = 0; }\n        if (z === void 0) { z = 0; }\n        this.setPosition(position, y, z);\n        return this;\n    };\n    /**\n     * Use `setPosition` instead.\n     * @deprecated\n     */\n    DisplayObject.prototype.move = function (position, y, z) {\n        if (y === void 0) { y = 0; }\n        if (z === void 0) { z = 0; }\n        this.setPosition(position, y, z);\n        return this;\n    };\n    /**\n     * Use `this.style.zIndex` instead.\n     * @deprecated\n     */\n    DisplayObject.prototype.setZIndex = function (zIndex) {\n        this.style.zIndex = zIndex;\n        return this;\n    };\n    return DisplayObject;\n}(Element));\n\nvar Circle = /** @class */ (function (_super) {\n    __extends(Circle, _super);\n    function Circle(options) {\n        if (options === void 0) { options = {}; }\n        return _super.call(this, __assign({ type: Shape.CIRCLE }, options)) || this;\n    }\n    return Circle;\n}(DisplayObject));\n\n/**\n * shadow root\n * @see https://yuque.antfin-inc.com/antv/czqvg5/pgqipg\n */\nvar CustomElement = /** @class */ (function (_super) {\n    __extends(CustomElement, _super);\n    // private shadowNodes: DisplayObject[] = [];\n    function CustomElement(_a) {\n        if (_a === void 0) { _a = {}; }\n        var _this = this;\n        var style = _a.style, rest = __rest(_a, [\"style\"]);\n        _this = _super.call(this, __assign({ style: runtime.enableCSSParsing\n                ? __assign({}, style) : __assign({}, style) }, rest)) || this;\n        // static get observedAttributes(): string[] {\n        //   return [];\n        // }\n        _this.isCustomElement = true;\n        return _this;\n    }\n    return CustomElement;\n}(DisplayObject));\n\nvar Ellipse = /** @class */ (function (_super) {\n    __extends(Ellipse, _super);\n    function Ellipse(options) {\n        if (options === void 0) { options = {}; }\n        return _super.call(this, __assign({ type: Shape.ELLIPSE }, options)) || this;\n    }\n    return Ellipse;\n}(DisplayObject));\n\n/**\n * its attributes are inherited by its children.\n * @see https://developer.mozilla.org/zh-CN/docs/Web/SVG/Element/g\n *\n * @example\n * <g fill=\"white\" stroke=\"green\" stroke-width=\"5\">\n    <circle cx=\"40\" cy=\"40\" r=\"25\" />\n    <circle cx=\"60\" cy=\"60\" r=\"25\" />\n  </g>\n */\nvar Group = /** @class */ (function (_super) {\n    __extends(Group, _super);\n    function Group(options) {\n        if (options === void 0) { options = {}; }\n        return _super.call(this, __assign({ type: Shape.GROUP }, options)) || this;\n    }\n    return Group;\n}(DisplayObject));\n\n/**\n * HTML container\n * @see https://github.com/pmndrs/drei#html\n */\nvar HTML = /** @class */ (function (_super) {\n    __extends(HTML, _super);\n    function HTML(_a) {\n        if (_a === void 0) { _a = {}; }\n        var _this = this;\n        var style = _a.style, rest = __rest(_a, [\"style\"]);\n        _this = _super.call(this, __assign({ type: Shape.HTML, style: runtime.enableCSSParsing\n                ? __assign({ x: '', y: '', width: 'auto', height: 'auto', innerHTML: '' }, style) : __assign({}, style) }, rest)) || this;\n        _this.cullable.enable = false;\n        return _this;\n    }\n    /**\n     * return wrapper HTMLElement\n     * * <div> in g-webgl/canvas\n     * * <foreignObject> in g-svg\n     */\n    HTML.prototype.getDomElement = function () {\n        return this.parsedStyle.$el;\n    };\n    /**\n     * override with $el.getBoundingClientRect\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Element/getBoundingClientRect\n     */\n    HTML.prototype.getBoundingClientRect = function () {\n        if (this.parsedStyle.$el) {\n            return this.parsedStyle.$el.getBoundingClientRect();\n        }\n        else {\n            var _a = this.parsedStyle, x = _a.x, y = _a.y, width = _a.width, height = _a.height;\n            return new Rectangle(x, y, width, height);\n        }\n    };\n    HTML.prototype.getClientRects = function () {\n        return [this.getBoundingClientRect()];\n    };\n    HTML.prototype.getBounds = function () {\n        var _a, _b;\n        var clientRect = this.getBoundingClientRect();\n        // calc context's offset\n        // @ts-ignore\n        var canvasRect = (_b = (_a = this.ownerDocument) === null || _a === void 0 ? void 0 : _a.defaultView) === null || _b === void 0 ? void 0 : _b.getContextService().getBoundingClientRect();\n        var aabb = new AABB();\n        var minX = clientRect.left - ((canvasRect === null || canvasRect === void 0 ? void 0 : canvasRect.left) || 0);\n        var minY = clientRect.top - ((canvasRect === null || canvasRect === void 0 ? void 0 : canvasRect.top) || 0);\n        aabb.setMinMax([minX, minY, 0], [minX + clientRect.width, minY + clientRect.height, 0]);\n        return aabb;\n    };\n    HTML.prototype.getLocalBounds = function () {\n        if (this.parentNode) {\n            var parentInvert = mat4.invert(mat4.create(), this.parentNode.getWorldTransform());\n            var bounds = this.getBounds();\n            if (!AABB.isEmpty(bounds)) {\n                var localBounds = new AABB();\n                localBounds.setFromTransformedAABB(bounds, parentInvert);\n                return localBounds;\n            }\n        }\n        return this.getBounds();\n    };\n    return HTML;\n}(DisplayObject));\n\nvar Image = /** @class */ (function (_super) {\n    __extends(Image, _super);\n    function Image(options) {\n        if (options === void 0) { options = {}; }\n        return _super.call(this, __assign({ type: Shape.IMAGE }, options)) || this;\n    }\n    return Image;\n}(DisplayObject));\n\n/**\n * Create a line connecting two points.\n * @see https://developer.mozilla.org/en-US/docs/Web/SVG/Element/line\n *\n * Also support for using marker.\n */\nvar Line = /** @class */ (function (_super) {\n    __extends(Line, _super);\n    function Line(_a) {\n        if (_a === void 0) { _a = {}; }\n        var _this = this;\n        var style = _a.style, rest = __rest(_a, [\"style\"]);\n        _this = _super.call(this, __assign({ type: Shape.LINE, style: __assign({ x1: 0, y1: 0, x2: 0, y2: 0, z1: 0, z2: 0 }, style) }, rest)) || this;\n        _this.markerStartAngle = 0;\n        _this.markerEndAngle = 0;\n        var _b = _this.parsedStyle, markerStart = _b.markerStart, markerEnd = _b.markerEnd;\n        if (markerStart && isDisplayObject(markerStart)) {\n            _this.markerStartAngle = markerStart.getLocalEulerAngles();\n            _this.appendChild(markerStart);\n        }\n        if (markerEnd && isDisplayObject(markerEnd)) {\n            _this.markerEndAngle = markerEnd.getLocalEulerAngles();\n            _this.appendChild(markerEnd);\n        }\n        _this.transformMarker(true);\n        _this.transformMarker(false);\n        return _this;\n    }\n    Line.prototype.attributeChangedCallback = function (attrName, oldValue, newValue, prevParsedValue, newParsedValue) {\n        if (attrName === 'x1' ||\n            attrName === 'y1' ||\n            attrName === 'x2' ||\n            attrName === 'y2' ||\n            attrName === 'markerStartOffset' ||\n            attrName === 'markerEndOffset') {\n            this.transformMarker(true);\n            this.transformMarker(false);\n        }\n        else if (attrName === 'markerStart') {\n            if (prevParsedValue && isDisplayObject(prevParsedValue)) {\n                this.markerStartAngle = 0;\n                prevParsedValue.remove();\n            }\n            // CSSKeyword 'unset'\n            if (newParsedValue && isDisplayObject(newParsedValue)) {\n                this.markerStartAngle = newParsedValue.getLocalEulerAngles();\n                this.appendChild(newParsedValue);\n                this.transformMarker(true);\n            }\n        }\n        else if (attrName === 'markerEnd') {\n            if (prevParsedValue && isDisplayObject(prevParsedValue)) {\n                this.markerEndAngle = 0;\n                prevParsedValue.remove();\n            }\n            if (newParsedValue && isDisplayObject(newParsedValue)) {\n                this.markerEndAngle = newParsedValue.getLocalEulerAngles();\n                this.appendChild(newParsedValue);\n                this.transformMarker(false);\n            }\n        }\n    };\n    Line.prototype.transformMarker = function (isStart) {\n        var _a = this.parsedStyle, markerStart = _a.markerStart, markerEnd = _a.markerEnd, markerStartOffset = _a.markerStartOffset, markerEndOffset = _a.markerEndOffset, x1 = _a.x1, x2 = _a.x2, y1 = _a.y1, y2 = _a.y2;\n        var marker = isStart ? markerStart : markerEnd;\n        if (!marker || !isDisplayObject(marker)) {\n            return;\n        }\n        var rad = 0;\n        var x;\n        var y;\n        var ox;\n        var oy;\n        var offset;\n        var originalAngle;\n        if (isStart) {\n            ox = x1;\n            oy = y1;\n            x = x2 - x1;\n            y = y2 - y1;\n            offset = markerStartOffset || 0;\n            originalAngle = this.markerStartAngle;\n        }\n        else {\n            ox = x2;\n            oy = y2;\n            x = x1 - x2;\n            y = y1 - y2;\n            offset = markerEndOffset || 0;\n            originalAngle = this.markerEndAngle;\n        }\n        rad = Math.atan2(y, x);\n        // account for markerOffset\n        marker.setLocalEulerAngles((rad * 180) / Math.PI + originalAngle);\n        marker.setLocalPosition(ox + Math.cos(rad) * offset, oy + Math.sin(rad) * offset);\n    };\n    Line.prototype.getPoint = function (ratio, inWorldSpace) {\n        if (inWorldSpace === void 0) { inWorldSpace = false; }\n        // TODO: account for z1/z2 in 3D line\n        var _a = this.parsedStyle, x1 = _a.x1, y1 = _a.y1, x2 = _a.x2, y2 = _a.y2;\n        var _b = linePointAt(x1, y1, x2, y2, ratio), x = _b.x, y = _b.y;\n        var transformed = vec3.transformMat4(vec3.create(), vec3.fromValues(x, y, 0), inWorldSpace ? this.getWorldTransform() : this.getLocalTransform());\n        // apply local transformation\n        return new Point(transformed[0], transformed[1]);\n    };\n    Line.prototype.getPointAtLength = function (distance, inWorldSpace) {\n        if (inWorldSpace === void 0) { inWorldSpace = false; }\n        return this.getPoint(distance / this.getTotalLength(), inWorldSpace);\n    };\n    Line.prototype.getTotalLength = function () {\n        // TODO: account for z1/z2 in 3D line\n        var _a = this.parsedStyle, x1 = _a.x1, y1 = _a.y1, x2 = _a.x2, y2 = _a.y2;\n        return lineLength(x1, y1, x2, y2);\n    };\n    return Line;\n}(DisplayObject));\n\nvar Path = /** @class */ (function (_super) {\n    __extends(Path, _super);\n    function Path(_a) {\n        if (_a === void 0) { _a = {}; }\n        var _this = this;\n        var style = _a.style, rest = __rest(_a, [\"style\"]);\n        _this = _super.call(this, __assign({ type: Shape.PATH, style: runtime.enableCSSParsing\n                ? __assign({ d: '', miterLimit: '' }, style) : __assign({}, style), initialParsedStyle: runtime.enableCSSParsing\n                ? null\n                : {\n                    miterLimit: 4,\n                    d: __assign({}, EMPTY_PARSED_PATH),\n                } }, rest)) || this;\n        _this.markerStartAngle = 0;\n        _this.markerEndAngle = 0;\n        /**\n         * markers placed at the mid\n         */\n        _this.markerMidList = [];\n        var _b = _this.parsedStyle, markerStart = _b.markerStart, markerEnd = _b.markerEnd, markerMid = _b.markerMid;\n        if (markerStart && isDisplayObject(markerStart)) {\n            _this.markerStartAngle = markerStart.getLocalEulerAngles();\n            _this.appendChild(markerStart);\n        }\n        if (markerMid && isDisplayObject(markerMid)) {\n            _this.placeMarkerMid(markerMid);\n        }\n        if (markerEnd && isDisplayObject(markerEnd)) {\n            _this.markerEndAngle = markerEnd.getLocalEulerAngles();\n            _this.appendChild(markerEnd);\n        }\n        _this.transformMarker(true);\n        _this.transformMarker(false);\n        return _this;\n    }\n    Path.prototype.attributeChangedCallback = function (attrName, oldValue, newValue, prevParsedValue, newParsedValue) {\n        if (attrName === 'd') {\n            // recalc markers\n            this.transformMarker(true);\n            this.transformMarker(false);\n            this.placeMarkerMid(this.parsedStyle.markerMid);\n        }\n        else if (attrName === 'markerStartOffset' ||\n            attrName === 'markerEndOffset') {\n            this.transformMarker(true);\n            this.transformMarker(false);\n        }\n        else if (attrName === 'markerStart') {\n            if (prevParsedValue && isDisplayObject(prevParsedValue)) {\n                this.markerStartAngle = 0;\n                prevParsedValue.remove();\n            }\n            // CSSKeyword 'unset'\n            if (newParsedValue && isDisplayObject(newParsedValue)) {\n                this.markerStartAngle = newParsedValue.getLocalEulerAngles();\n                this.appendChild(newParsedValue);\n                this.transformMarker(true);\n            }\n        }\n        else if (attrName === 'markerEnd') {\n            if (prevParsedValue && isDisplayObject(prevParsedValue)) {\n                this.markerEndAngle = 0;\n                prevParsedValue.remove();\n            }\n            if (newParsedValue && isDisplayObject(newParsedValue)) {\n                this.markerEndAngle = newParsedValue.getLocalEulerAngles();\n                this.appendChild(newParsedValue);\n                this.transformMarker(false);\n            }\n        }\n        else if (attrName === 'markerMid') {\n            this.placeMarkerMid(newParsedValue);\n        }\n    };\n    Path.prototype.transformMarker = function (isStart) {\n        var _a = this.parsedStyle, markerStart = _a.markerStart, markerEnd = _a.markerEnd, markerStartOffset = _a.markerStartOffset, markerEndOffset = _a.markerEndOffset;\n        var marker = isStart ? markerStart : markerEnd;\n        if (!marker || !isDisplayObject(marker)) {\n            return;\n        }\n        var rad = 0;\n        var x;\n        var y;\n        var ox;\n        var oy;\n        var offset;\n        var originalAngle;\n        if (isStart) {\n            var _b = __read(this.getStartTangent(), 2), p1 = _b[0], p2 = _b[1];\n            ox = p2[0];\n            oy = p2[1];\n            x = p1[0] - p2[0];\n            y = p1[1] - p2[1];\n            offset = markerStartOffset || 0;\n            originalAngle = this.markerStartAngle;\n        }\n        else {\n            var _c = __read(this.getEndTangent(), 2), p1 = _c[0], p2 = _c[1];\n            ox = p2[0];\n            oy = p2[1];\n            x = p1[0] - p2[0];\n            y = p1[1] - p2[1];\n            offset = markerEndOffset || 0;\n            originalAngle = this.markerEndAngle;\n        }\n        rad = Math.atan2(y, x);\n        // account for markerOffset\n        marker.setLocalEulerAngles((rad * 180) / Math.PI + originalAngle);\n        marker.setLocalPosition(ox + Math.cos(rad) * offset, oy + Math.sin(rad) * offset);\n    };\n    Path.prototype.placeMarkerMid = function (marker) {\n        var segments = this.parsedStyle.d.segments;\n        // clear all existed markers\n        this.markerMidList.forEach(function (marker) {\n            marker.remove();\n        });\n        if (marker && isDisplayObject(marker)) {\n            for (var i = 1; i < segments.length - 1; i++) {\n                var _a = __read(segments[i].currentPoint, 2), ox = _a[0], oy = _a[1];\n                var cloned = i === 1 ? marker : marker.cloneNode(true);\n                this.markerMidList.push(cloned);\n                this.appendChild(cloned);\n                cloned.setLocalPosition(ox, oy);\n                // TODO: orient of marker\n            }\n        }\n    };\n    /**\n     * Returns the total length of the path.\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/SVGGeometryElement/getTotalLength\n     */\n    Path.prototype.getTotalLength = function () {\n        return getOrCalculatePathTotalLength(this);\n    };\n    /**\n     * Returns the point at a given distance along the path.\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/SVGGeometryElement/getPointAtLength\n     */\n    Path.prototype.getPointAtLength = function (distance, inWorldSpace) {\n        if (inWorldSpace === void 0) { inWorldSpace = false; }\n        var absolutePath = this.parsedStyle.d.absolutePath;\n        var _a = getPointAtLength(absolutePath, distance), x = _a.x, y = _a.y;\n        var transformed = vec3.transformMat4(vec3.create(), vec3.fromValues(x, y, 0), inWorldSpace ? this.getWorldTransform() : this.getLocalTransform());\n        // apply local transformation\n        return new Point(transformed[0], transformed[1]);\n    };\n    /**\n     * Returns the point at a given ratio of the total length in path.\n     */\n    Path.prototype.getPoint = function (ratio, inWorldSpace) {\n        if (inWorldSpace === void 0) { inWorldSpace = false; }\n        return this.getPointAtLength(ratio * getOrCalculatePathTotalLength(this), inWorldSpace);\n    };\n    /**\n     * Get start tangent vector\n     */\n    Path.prototype.getStartTangent = function () {\n        var segments = this.parsedStyle.d.segments;\n        var result = [];\n        if (segments.length > 1) {\n            var startPoint = segments[0].currentPoint;\n            var endPoint = segments[1].currentPoint;\n            var tangent = segments[1].startTangent;\n            result = [];\n            if (tangent) {\n                result.push([startPoint[0] - tangent[0], startPoint[1] - tangent[1]]);\n                result.push([startPoint[0], startPoint[1]]);\n            }\n            else {\n                result.push([endPoint[0], endPoint[1]]);\n                result.push([startPoint[0], startPoint[1]]);\n            }\n        }\n        return result;\n    };\n    /**\n     * Get end tangent vector\n     */\n    Path.prototype.getEndTangent = function () {\n        var segments = this.parsedStyle.d.segments;\n        var length = segments.length;\n        var result = [];\n        if (length > 1) {\n            var startPoint = segments[length - 2].currentPoint;\n            var endPoint = segments[length - 1].currentPoint;\n            var tangent = segments[length - 1].endTangent;\n            result = [];\n            if (tangent) {\n                result.push([endPoint[0] - tangent[0], endPoint[1] - tangent[1]]);\n                result.push([endPoint[0], endPoint[1]]);\n            }\n            else {\n                result.push([startPoint[0], startPoint[1]]);\n                result.push([endPoint[0], endPoint[1]]);\n            }\n        }\n        return result;\n    };\n    return Path;\n}(DisplayObject));\n\nvar Polygon = /** @class */ (function (_super) {\n    __extends(Polygon, _super);\n    function Polygon(_a) {\n        if (_a === void 0) { _a = {}; }\n        var _this = this;\n        var style = _a.style, rest = __rest(_a, [\"style\"]);\n        _this = _super.call(this, __assign({ type: Shape.POLYGON, style: runtime.enableCSSParsing\n                ? __assign({ points: '', miterLimit: '', isClosed: true }, style) : __assign({}, style), initialParsedStyle: runtime.enableCSSParsing\n                ? null\n                : {\n                    points: {\n                        points: [],\n                        totalLength: 0,\n                        segments: [],\n                    },\n                    miterLimit: 4,\n                    isClosed: true,\n                } }, rest)) || this;\n        _this.markerStartAngle = 0;\n        _this.markerEndAngle = 0;\n        /**\n         * markers placed at the mid\n         */\n        _this.markerMidList = [];\n        var _b = _this.parsedStyle, markerStart = _b.markerStart, markerEnd = _b.markerEnd, markerMid = _b.markerMid;\n        if (markerStart && isDisplayObject(markerStart)) {\n            _this.markerStartAngle = markerStart.getLocalEulerAngles();\n            _this.appendChild(markerStart);\n        }\n        if (markerMid && isDisplayObject(markerMid)) {\n            _this.placeMarkerMid(markerMid);\n        }\n        if (markerEnd && isDisplayObject(markerEnd)) {\n            _this.markerEndAngle = markerEnd.getLocalEulerAngles();\n            _this.appendChild(markerEnd);\n        }\n        _this.transformMarker(true);\n        _this.transformMarker(false);\n        return _this;\n    }\n    Polygon.prototype.attributeChangedCallback = function (attrName, oldValue, newValue, prevParsedValue, newParsedValue) {\n        if (attrName === 'points') {\n            // recalc markers\n            this.transformMarker(true);\n            this.transformMarker(false);\n            this.placeMarkerMid(this.parsedStyle.markerMid);\n        }\n        else if (attrName === 'markerStartOffset' ||\n            attrName === 'markerEndOffset') {\n            this.transformMarker(true);\n            this.transformMarker(false);\n        }\n        else if (attrName === 'markerStart') {\n            if (prevParsedValue && isDisplayObject(prevParsedValue)) {\n                this.markerStartAngle = 0;\n                prevParsedValue.remove();\n            }\n            // CSSKeyword 'unset'\n            if (newParsedValue && isDisplayObject(newParsedValue)) {\n                this.markerStartAngle = newParsedValue.getLocalEulerAngles();\n                this.appendChild(newParsedValue);\n                this.transformMarker(true);\n            }\n        }\n        else if (attrName === 'markerEnd') {\n            if (prevParsedValue && isDisplayObject(prevParsedValue)) {\n                this.markerEndAngle = 0;\n                prevParsedValue.remove();\n            }\n            if (newParsedValue && isDisplayObject(newParsedValue)) {\n                this.markerEndAngle = newParsedValue.getLocalEulerAngles();\n                this.appendChild(newParsedValue);\n                this.transformMarker(false);\n            }\n        }\n        else if (attrName === 'markerMid') {\n            this.placeMarkerMid(newParsedValue);\n        }\n    };\n    Polygon.prototype.transformMarker = function (isStart) {\n        var _a = this.parsedStyle, markerStart = _a.markerStart, markerEnd = _a.markerEnd, markerStartOffset = _a.markerStartOffset, markerEndOffset = _a.markerEndOffset, P = _a.points;\n        var points = (P || {}).points;\n        var marker = isStart ? markerStart : markerEnd;\n        if (!marker || !isDisplayObject(marker) || !points) {\n            return;\n        }\n        var rad = 0;\n        var x;\n        var y;\n        var ox;\n        var oy;\n        var offset;\n        var originalAngle;\n        ox = points[0][0];\n        oy = points[0][1];\n        if (isStart) {\n            x = points[1][0] - points[0][0];\n            y = points[1][1] - points[0][1];\n            offset = markerStartOffset || 0;\n            originalAngle = this.markerStartAngle;\n        }\n        else {\n            var length_1 = points.length;\n            if (!this.parsedStyle.isClosed) {\n                ox = points[length_1 - 1][0];\n                oy = points[length_1 - 1][1];\n                x = points[length_1 - 2][0] - points[length_1 - 1][0];\n                y = points[length_1 - 2][1] - points[length_1 - 1][1];\n            }\n            else {\n                x = points[length_1 - 1][0] - points[0][0];\n                y = points[length_1 - 1][1] - points[0][1];\n            }\n            offset = markerEndOffset || 0;\n            originalAngle = this.markerEndAngle;\n        }\n        rad = Math.atan2(y, x);\n        // account for markerOffset\n        marker.setLocalEulerAngles((rad * 180) / Math.PI + originalAngle);\n        marker.setLocalPosition(ox + Math.cos(rad) * offset, oy + Math.sin(rad) * offset);\n    };\n    Polygon.prototype.placeMarkerMid = function (marker) {\n        var P = this.parsedStyle.points;\n        var points = (P || {}).points;\n        // clear all existed markers\n        this.markerMidList.forEach(function (marker) {\n            marker.remove();\n        });\n        this.markerMidList = [];\n        if (marker && isDisplayObject(marker) && points) {\n            for (var i = 1; i < (this.parsedStyle.isClosed ? points.length : points.length - 1); i++) {\n                var ox = points[i][0];\n                var oy = points[i][1];\n                var cloned = i === 1 ? marker : marker.cloneNode(true);\n                this.markerMidList.push(cloned);\n                this.appendChild(cloned);\n                cloned.setLocalPosition(ox, oy);\n                // TODO: orient of marker\n            }\n        }\n    };\n    return Polygon;\n}(DisplayObject));\n\n/**\n * Polyline inherits the marker-related capabilities of Polygon.\n */\nvar Polyline = /** @class */ (function (_super) {\n    __extends(Polyline, _super);\n    function Polyline(_a) {\n        if (_a === void 0) { _a = {}; }\n        var style = _a.style, rest = __rest(_a, [\"style\"]);\n        return _super.call(this, __assign({ type: Shape.POLYLINE, style: runtime.enableCSSParsing\n                ? __assign({ points: '', miterLimit: '', isClosed: false }, style) : __assign({}, style), initialParsedStyle: runtime.enableCSSParsing\n                ? null\n                : {\n                    points: {\n                        points: [],\n                        totalLength: 0,\n                        segments: [],\n                    },\n                    miterLimit: 4,\n                    isClosed: false,\n                } }, rest)) || this;\n    }\n    Polyline.prototype.getTotalLength = function () {\n        return getOrCalculatePolylineTotalLength(this);\n    };\n    Polyline.prototype.getPointAtLength = function (distance, inWorldSpace) {\n        if (inWorldSpace === void 0) { inWorldSpace = false; }\n        return this.getPoint(distance / this.getTotalLength(), inWorldSpace);\n    };\n    Polyline.prototype.getPoint = function (ratio, inWorldSpace) {\n        if (inWorldSpace === void 0) { inWorldSpace = false; }\n        var points = this.parsedStyle.points.points;\n        if (this.parsedStyle.points.segments.length === 0) {\n            var segments_1 = [];\n            var tempLength_1 = 0;\n            var segmentT_1;\n            var segmentL_1;\n            var totalLength_1 = this.getTotalLength();\n            points.forEach(function (p, i) {\n                if (points[i + 1]) {\n                    segmentT_1 = [0, 0];\n                    segmentT_1[0] = tempLength_1 / totalLength_1;\n                    segmentL_1 = lineLength(p[0], p[1], points[i + 1][0], points[i + 1][1]);\n                    tempLength_1 += segmentL_1;\n                    segmentT_1[1] = tempLength_1 / totalLength_1;\n                    segments_1.push(segmentT_1);\n                }\n            });\n            this.parsedStyle.points.segments = segments_1;\n        }\n        var subt = 0;\n        var index = 0;\n        this.parsedStyle.points.segments.forEach(function (v, i) {\n            if (ratio >= v[0] && ratio <= v[1]) {\n                subt = (ratio - v[0]) / (v[1] - v[0]);\n                index = i;\n            }\n        });\n        var _a = linePointAt(points[index][0], points[index][1], points[index + 1][0], points[index + 1][1], subt), x = _a.x, y = _a.y;\n        var transformed = vec3.transformMat4(vec3.create(), vec3.fromValues(x, y, 0), inWorldSpace ? this.getWorldTransform() : this.getLocalTransform());\n        // apply local transformation\n        return new Point(transformed[0], transformed[1]);\n    };\n    Polyline.prototype.getStartTangent = function () {\n        var points = this.parsedStyle.points.points;\n        var result = [];\n        result.push([points[1][0], points[1][1]]);\n        result.push([points[0][0], points[0][1]]);\n        return result;\n    };\n    Polyline.prototype.getEndTangent = function () {\n        var points = this.parsedStyle.points.points;\n        var l = points.length - 1;\n        var result = [];\n        result.push([points[l - 1][0], points[l - 1][1]]);\n        result.push([points[l][0], points[l][1]]);\n        return result;\n    };\n    return Polyline;\n}(Polygon));\n\nvar Rect = /** @class */ (function (_super) {\n    __extends(Rect, _super);\n    function Rect(options) {\n        if (options === void 0) { options = {}; }\n        return _super.call(this, __assign({ type: Shape.RECT }, options)) || this;\n    }\n    return Rect;\n}(DisplayObject));\n\n/**\n * <text> @see https://developer.mozilla.org/en-US/docs/Web/API/SVGTextElement\n */\nvar Text = /** @class */ (function (_super) {\n    __extends(Text, _super);\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/SVGTextContentElement#constants\n     */\n    // LENGTHADJUST_SPACING: number = 1;\n    // LENGTHADJUST_SPACINGANDGLYPHS: number = 2;\n    // LENGTHADJUST_UNKNOWN: number = 0;\n    function Text(_a) {\n        if (_a === void 0) { _a = {}; }\n        var style = _a.style, rest = __rest(_a, [\"style\"]);\n        return _super.call(this, __assign({ type: Shape.TEXT, style: runtime.enableCSSParsing\n                ? __assign({ x: '', y: '', text: '', fontSize: '', fontFamily: '', fontStyle: '', fontWeight: '', fontVariant: '', textAlign: '', textBaseline: '', textTransform: '', fill: 'black', letterSpacing: '', lineHeight: '', miterLimit: '', \n                    // whiteSpace: 'pre',\n                    wordWrap: false, wordWrapWidth: 0, leading: 0, dx: '', dy: '' }, style) : __assign({ fill: 'black' }, style) }, rest)) || this;\n    }\n    // lengthAdjust: SVGAnimatedEnumeration;\n    // textLength: SVGAnimatedLength;\n    // getCharNumAtPosition(point?: DOMPointInit): number {\n    //   throw new Error('Method not implemented.');\n    // }\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/SVGTextContentElement\n     */\n    Text.prototype.getComputedTextLength = function () {\n        var _a;\n        this.getGeometryBounds();\n        return ((_a = this.parsedStyle.metrics) === null || _a === void 0 ? void 0 : _a.maxLineWidth) || 0;\n    };\n    // getEndPositionOfChar(charnum: number): DOMPoint {\n    //   throw new Error('Method not implemented.');\n    // }\n    // getExtentOfChar(charnum: number): DOMRect {\n    //   throw new Error('Method not implemented.');\n    // }\n    // getNumberOfChars(): number {\n    //   throw new Error('Method not implemented.');\n    // }\n    // getRotationOfChar(charnum: number): number {\n    //   throw new Error('Method not implemented.');\n    // }\n    // getStartPositionOfChar(charnum: number): DOMPoint {\n    //   throw new Error('Method not implemented.');\n    // }\n    // getSubStringLength(charnum: number, nchars: number): number {\n    //   throw new Error('Method not implemented.');\n    // }\n    // selectSubString(charnum: number, nchars: number): void {\n    //   throw new Error('Method not implemented.');\n    // }\n    Text.prototype.getLineBoundingRects = function () {\n        var _a;\n        this.getGeometryBounds();\n        return ((_a = this.parsedStyle.metrics) === null || _a === void 0 ? void 0 : _a.lineMetrics) || [];\n    };\n    Text.prototype.isOverflowing = function () {\n        this.getGeometryBounds();\n        return !!this.parsedStyle.isOverflowing;\n    };\n    return Text;\n}(DisplayObject));\n\n/**\n * canvas.customElements\n *\n * @see https://developer.mozilla.org/en-US/docs/Web/API/CustomElementRegistry\n */\nvar CustomElementRegistry = /** @class */ (function () {\n    function CustomElementRegistry() {\n        this.registry = {};\n        this.define(Shape.CIRCLE, Circle);\n        this.define(Shape.ELLIPSE, Ellipse);\n        this.define(Shape.RECT, Rect);\n        this.define(Shape.IMAGE, Image);\n        this.define(Shape.LINE, Line);\n        this.define(Shape.GROUP, Group);\n        this.define(Shape.PATH, Path);\n        this.define(Shape.POLYGON, Polygon);\n        this.define(Shape.POLYLINE, Polyline);\n        this.define(Shape.TEXT, Text);\n        this.define(Shape.HTML, HTML);\n    }\n    CustomElementRegistry.prototype.define = function (name, constructor) {\n        this.registry[name] = constructor;\n    };\n    /**\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/CustomElementRegistry/get\n     */\n    CustomElementRegistry.prototype.get = function (name) {\n        return this.registry[name];\n    };\n    return CustomElementRegistry;\n}());\n\n/**\n * holds useful CSS-related methods.\n * @see https://developer.mozilla.org/en-US/docs/Web/API/CSS\n *\n * * CSS Typed OM @see https://developer.mozilla.org/en-US/docs/Web/API/CSS/factory_functions\n * * register property @see https://developer.mozilla.org/en-US/docs/Web/API/CSS/RegisterProperty\n * * CSS Layout API\n */\nvar CSS = {\n    /**\n     * <number>\n     * @see https://drafts.csswg.org/css-values-4/#number-value\n     */\n    number: function (n) {\n        return new CSSUnitValue(n);\n    },\n    /**\n     * <percentage>\n     * @see https://drafts.csswg.org/css-values-4/#percentage-value\n     */\n    percent: function (n) {\n        return new CSSUnitValue(n, '%');\n    },\n    /**\n     * <length>\n     */\n    px: function (n) {\n        return new CSSUnitValue(n, 'px');\n    },\n    /**\n     * <length>\n     */\n    em: function (n) {\n        return new CSSUnitValue(n, 'em');\n    },\n    rem: function (n) {\n        return new CSSUnitValue(n, 'rem');\n    },\n    /**\n     * <angle>\n     */\n    deg: function (n) {\n        return new CSSUnitValue(n, 'deg');\n    },\n    /**\n     * <angle>\n     */\n    grad: function (n) {\n        return new CSSUnitValue(n, 'grad');\n    },\n    /**\n     * <angle>\n     */\n    rad: function (n) {\n        return new CSSUnitValue(n, 'rad');\n    },\n    /**\n     * <angle>\n     */\n    turn: function (n) {\n        return new CSSUnitValue(n, 'turn');\n    },\n    /**\n     * <time>\n     */\n    s: function (n) {\n        return new CSSUnitValue(n, 's');\n    },\n    /**\n     * <time>\n     */\n    ms: function (n) {\n        return new CSSUnitValue(n, 'ms');\n    },\n    /**\n     * CSS Properties & Values API\n     *\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/CSS_Properties_and_Values_API\n     * @see https://drafts.css-houdini.org/css-properties-values-api/#registering-custom-properties\n     * @see https://developer.mozilla.org/en-US/docs/Web/API/CSS/RegisterProperty\n     */\n    registerProperty: function (definition) {\n        var name = definition.name, inherits = definition.inherits, interpolable = definition.interpolable, initialValue = definition.initialValue, syntax = definition.syntax;\n        runtime.styleValueRegistry.registerMetadata({\n            n: name,\n            inh: inherits,\n            int: interpolable,\n            d: initialValue,\n            syntax: syntax,\n        });\n    },\n    /**\n     * CSS Layout API\n     * register layout\n     *\n     * @see https://github.com/w3c/css-houdini-drafts/blob/main/css-layout-api/EXPLAINER.md\n     * @see https://developer.mozilla.org/en-US/docs/Web/Guide/Houdini#css_layout_api\n     */\n    registerLayout: function (name, clazz) {\n        runtime.layoutRegistry.registerLayout(name, clazz);\n    },\n};\n\n/**\n * the entry of DOM tree\n * Document -> Node -> EventTarget\n * @see https://developer.mozilla.org/en-US/docs/Web/API/Document\n */\nvar Document = /** @class */ (function (_super) {\n    __extends(Document, _super);\n    function Document() {\n        var _this = _super.call(this) || this;\n        /**\n         * only document has defaultView, points to canvas,\n         * @see https://developer.mozilla.org/en-US/docs/Web/API/Document/defaultView\n         */\n        _this.defaultView = null;\n        _this.ownerDocument = null;\n        _this.nodeName = 'document';\n        // create timeline\n        try {\n            _this.timeline = new runtime.AnimationTimeline(_this);\n        }\n        catch (e) { }\n        /**\n         * for inherited properties, the initial value is used on the root element only,\n         * as long as no specified value is supplied.\n         * @see https://developer.mozilla.org/en-US/docs/Web/CSS/initial_value\n         */\n        var initialStyle = {};\n        BUILT_IN_PROPERTIES.forEach(function (_a) {\n            var n = _a.n, inh = _a.inh, d = _a.d;\n            if (inh && d) {\n                initialStyle[n] = isFunction(d) ? d(Shape.GROUP) : d;\n            }\n        });\n        // like <html> in DOM tree\n        _this.documentElement = new Group({\n            id: 'g-root',\n            style: initialStyle,\n        });\n        _this.documentElement.ownerDocument = _this;\n        _this.documentElement.parentNode = _this;\n        _this.childNodes = [_this.documentElement];\n        return _this;\n    }\n    Object.defineProperty(Document.prototype, \"children\", {\n        get: function () {\n            return this.childNodes;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Document.prototype, \"childElementCount\", {\n        get: function () {\n            return this.childNodes.length;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Document.prototype, \"firstElementChild\", {\n        get: function () {\n            return this.firstChild;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Document.prototype, \"lastElementChild\", {\n        get: function () {\n            return this.lastChild;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * @example const circle = document.createElement('circle', { style: { r: 10 } });\n     */\n    Document.prototype.createElement = function (tagName, options) {\n        // @observablehq/plot will create <svg>\n        if (tagName === 'svg') {\n            return this.documentElement;\n        }\n        // d3 will use <tspan>\n        var clazz = this.defaultView.customElements.get(tagName);\n        if (!clazz) {\n            console.warn('Unsupported tagName: ', tagName);\n            clazz = tagName === 'tspan' ? Text : Group;\n        }\n        var shape = new clazz(options);\n        shape.ownerDocument = this;\n        return shape;\n    };\n    Document.prototype.createElementNS = function (namespaceURI, tagName, options) {\n        return this.createElement(tagName, options);\n    };\n    Document.prototype.cloneNode = function (deep) {\n        throw new Error(ERROR_MSG_METHOD_NOT_IMPLEMENTED);\n    };\n    Document.prototype.destroy = function () {\n        try {\n            this.documentElement.destroyChildren();\n            this.timeline.destroy();\n        }\n        catch (e) { }\n    };\n    /**\n     * Picking 2D graphics with RBush based on BBox, fast but inaccurate.\n     */\n    Document.prototype.elementsFromBBox = function (minX, minY, maxX, maxY) {\n        var rBush = this.defaultView.context.rBushRoot;\n        var rBushNodes = rBush.search({ minX: minX, minY: minY, maxX: maxX, maxY: maxY });\n        var hitTestList = [];\n        rBushNodes.forEach(function (_a) {\n            var displayObject = _a.displayObject;\n            var _b = displayObject.parsedStyle.pointerEvents, pointerEvents = _b === void 0 ? 'auto' : _b;\n            // account for `visibility`\n            // @see https://developer.mozilla.org/en-US/docs/Web/CSS/pointer-events\n            var isVisibilityAffected = [\n                'auto',\n                'visiblepainted',\n                'visiblefill',\n                'visiblestroke',\n                'visible',\n            ].includes(pointerEvents);\n            if ((!isVisibilityAffected ||\n                (isVisibilityAffected && displayObject.isVisible())) &&\n                !displayObject.isCulled() &&\n                displayObject.isInteractive()) {\n                hitTestList.push(displayObject);\n            }\n        });\n        // find group with max z-index\n        hitTestList.sort(function (a, b) { return b.sortable.renderOrder - a.sortable.renderOrder; });\n        return hitTestList;\n    };\n    Document.prototype.elementFromPointSync = function (x, y) {\n        var _a = this.defaultView.canvas2Viewport({\n            x: x,\n            y: y,\n        }), viewportX = _a.x, viewportY = _a.y;\n        var _b = this.defaultView.getConfig(), width = _b.width, height = _b.height;\n        // outside canvas' viewport\n        if (viewportX < 0 ||\n            viewportY < 0 ||\n            viewportX > width ||\n            viewportY > height) {\n            return null;\n        }\n        var _c = this.defaultView.viewport2Client({\n            x: viewportX,\n            y: viewportY,\n        }), clientX = _c.x, clientY = _c.y;\n        var picked = this.defaultView\n            .getRenderingService()\n            .hooks.pickSync.call({\n            topmost: true,\n            position: {\n                x: x,\n                y: y,\n                viewportX: viewportX,\n                viewportY: viewportY,\n                clientX: clientX,\n                clientY: clientY,\n            },\n            picked: [],\n        }).picked;\n        return (picked && picked[0]) || this.documentElement;\n    };\n    /**\n     * Do picking with API instead of triggering interactive events.\n     *\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Document/elementFromPoint\n     */\n    Document.prototype.elementFromPoint = function (x, y) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _a, viewportX, viewportY, _b, width, height, _c, clientX, clientY, picked;\n            return __generator(this, function (_d) {\n                switch (_d.label) {\n                    case 0:\n                        _a = this.defaultView.canvas2Viewport({\n                            x: x,\n                            y: y,\n                        }), viewportX = _a.x, viewportY = _a.y;\n                        _b = this.defaultView.getConfig(), width = _b.width, height = _b.height;\n                        // outside canvas' viewport\n                        if (viewportX < 0 ||\n                            viewportY < 0 ||\n                            viewportX > width ||\n                            viewportY > height) {\n                            return [2 /*return*/, null];\n                        }\n                        _c = this.defaultView.viewport2Client({\n                            x: viewportX,\n                            y: viewportY,\n                        }), clientX = _c.x, clientY = _c.y;\n                        return [4 /*yield*/, this.defaultView\n                                .getRenderingService()\n                                .hooks.pick.promise({\n                                topmost: true,\n                                position: {\n                                    x: x,\n                                    y: y,\n                                    viewportX: viewportX,\n                                    viewportY: viewportY,\n                                    clientX: clientX,\n                                    clientY: clientY,\n                                },\n                                picked: [],\n                            })];\n                    case 1:\n                        picked = (_d.sent()).picked;\n                        return [2 /*return*/, (picked && picked[0]) || this.documentElement];\n                }\n            });\n        });\n    };\n    Document.prototype.elementsFromPointSync = function (x, y) {\n        var _a = this.defaultView.canvas2Viewport({\n            x: x,\n            y: y,\n        }), viewportX = _a.x, viewportY = _a.y;\n        var _b = this.defaultView.getConfig(), width = _b.width, height = _b.height;\n        // outside canvas' viewport\n        if (viewportX < 0 ||\n            viewportY < 0 ||\n            viewportX > width ||\n            viewportY > height) {\n            return [];\n        }\n        var _c = this.defaultView.viewport2Client({\n            x: viewportX,\n            y: viewportY,\n        }), clientX = _c.x, clientY = _c.y;\n        var picked = this.defaultView\n            .getRenderingService()\n            .hooks.pickSync.call({\n            topmost: false,\n            position: {\n                x: x,\n                y: y,\n                viewportX: viewportX,\n                viewportY: viewportY,\n                clientX: clientX,\n                clientY: clientY,\n            },\n            picked: [],\n        }).picked;\n        if (picked[picked.length - 1] !== this.documentElement) {\n            picked.push(this.documentElement);\n        }\n        return picked;\n    };\n    /**\n     * Do picking with API instead of triggering interactive events.\n     *\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Document/elementsFromPoint\n     */\n    Document.prototype.elementsFromPoint = function (x, y) {\n        return __awaiter(this, void 0, void 0, function () {\n            var _a, viewportX, viewportY, _b, width, height, _c, clientX, clientY, picked;\n            return __generator(this, function (_d) {\n                switch (_d.label) {\n                    case 0:\n                        _a = this.defaultView.canvas2Viewport({\n                            x: x,\n                            y: y,\n                        }), viewportX = _a.x, viewportY = _a.y;\n                        _b = this.defaultView.getConfig(), width = _b.width, height = _b.height;\n                        // outside canvas' viewport\n                        if (viewportX < 0 ||\n                            viewportY < 0 ||\n                            viewportX > width ||\n                            viewportY > height) {\n                            return [2 /*return*/, []];\n                        }\n                        _c = this.defaultView.viewport2Client({\n                            x: viewportX,\n                            y: viewportY,\n                        }), clientX = _c.x, clientY = _c.y;\n                        return [4 /*yield*/, this.defaultView\n                                .getRenderingService()\n                                .hooks.pick.promise({\n                                topmost: false,\n                                position: {\n                                    x: x,\n                                    y: y,\n                                    viewportX: viewportX,\n                                    viewportY: viewportY,\n                                    clientX: clientX,\n                                    clientY: clientY,\n                                },\n                                picked: [],\n                            })];\n                    case 1:\n                        picked = (_d.sent()).picked;\n                        if (picked[picked.length - 1] !== this.documentElement) {\n                            picked.push(this.documentElement);\n                        }\n                        return [2 /*return*/, picked];\n                }\n            });\n        });\n    };\n    /**\n     * eg. Uncaught DOMException: Failed to execute 'appendChild' on 'Node': Only one element on document allowed.\n     */\n    Document.prototype.appendChild = function (newChild, index) {\n        throw new Error(ERROR_MSG_USE_DOCUMENT_ELEMENT);\n    };\n    Document.prototype.insertBefore = function (newChild, refChild) {\n        throw new Error(ERROR_MSG_USE_DOCUMENT_ELEMENT);\n    };\n    Document.prototype.removeChild = function (oldChild, destroy) {\n        throw new Error(ERROR_MSG_USE_DOCUMENT_ELEMENT);\n    };\n    Document.prototype.replaceChild = function (newChild, oldChild, destroy) {\n        throw new Error(ERROR_MSG_USE_DOCUMENT_ELEMENT);\n    };\n    Document.prototype.append = function () {\n        throw new Error(ERROR_MSG_USE_DOCUMENT_ELEMENT);\n    };\n    Document.prototype.prepend = function () {\n        throw new Error(ERROR_MSG_USE_DOCUMENT_ELEMENT);\n    };\n    /**\n     * Execute query on documentElement.\n     */\n    Document.prototype.getElementById = function (id) {\n        return this.documentElement.getElementById(id);\n    };\n    Document.prototype.getElementsByName = function (name) {\n        return this.documentElement.getElementsByName(name);\n    };\n    Document.prototype.getElementsByTagName = function (tagName) {\n        return this.documentElement.getElementsByTagName(tagName);\n    };\n    Document.prototype.getElementsByClassName = function (className) {\n        return this.documentElement.getElementsByClassName(className);\n    };\n    Document.prototype.querySelector = function (selectors) {\n        return this.documentElement.querySelector(selectors);\n    };\n    Document.prototype.querySelectorAll = function (selectors) {\n        return this.documentElement.querySelectorAll(selectors);\n    };\n    Document.prototype.find = function (filter) {\n        return this.documentElement.find(filter);\n    };\n    Document.prototype.findAll = function (filter) {\n        return this.documentElement.findAll(filter);\n    };\n    return Document;\n}(Node));\n\n/**\n * apply following rules:\n * 1. `visibility` in scenegraph node\n * 2. other custom culling strategies, eg. frustum culling\n */\nvar CullingPlugin = /** @class */ (function () {\n    function CullingPlugin(strategies) {\n        this.strategies = strategies;\n    }\n    CullingPlugin.prototype.apply = function (context) {\n        var camera = context.camera, renderingService = context.renderingService, renderingContext = context.renderingContext;\n        var strategies = this.strategies;\n        renderingService.hooks.cull.tap(CullingPlugin.tag, function (object) {\n            if (object) {\n                var cullable = object.cullable;\n                // cullable.visible = true;\n                // const renderBounds = object.getRenderBounds();\n                // if (AABB.isEmpty(renderBounds)) {\n                //   cullable.visible = false;\n                // } else {\n                //   const isShape2D = shape2D.indexOf(object.nodeName as Shape) > -1;\n                //   const [p0, p1, p2, p3] = camera.getFrustum().planes;\n                //   tmpAABB.setMinMax([-p1.distance, -p3.distance, 0], [p0.distance, p2.distance, 0]);\n                //   cullable.visible = isShape2D ? renderBounds.intersects(tmpAABB) : true;\n                // }\n                if (strategies.length === 0) {\n                    cullable.visible = renderingContext.unculledEntities.indexOf(object.entity) > -1;\n                }\n                else {\n                    // eg. implemented by g-webgl(frustum culling)\n                    cullable.visible = strategies.every(function (strategy) { return strategy.isVisible(camera, object); });\n                }\n                if (!object.isCulled() && object.isVisible()) {\n                    return object;\n                }\n                else {\n                    // if (this.renderingContext.renderListLastFrame.indexOf(object) > -1) {\n                    object.dispatchEvent(new CustomEvent(ElementEvent.CULLED));\n                    // }\n                }\n                return null;\n            }\n            return object;\n        });\n        renderingService.hooks.afterRender.tap(CullingPlugin.tag, function (object) {\n            object.cullable.visibilityPlaneMask = -1;\n        });\n    };\n    CullingPlugin.tag = 'Culling';\n    return CullingPlugin;\n}());\n\n/**\n * support mouse & touch events\n * @see https://github.com/pixijs/pixi.js/blob/dev/packages/interaction/README.md\n *\n * also provide some extra events such as `drag`\n */\nvar EventPlugin = /** @class */ (function () {\n    function EventPlugin() {\n        var _this = this;\n        this.autoPreventDefault = false;\n        this.rootPointerEvent = new FederatedPointerEvent(null);\n        this.rootWheelEvent = new FederatedWheelEvent(null);\n        this.onPointerMove = function (nativeEvent) {\n            var e_1, _a;\n            var _b, _c;\n            var canvas = (_c = (_b = _this.context.renderingContext.root) === null || _b === void 0 ? void 0 : _b.ownerDocument) === null || _c === void 0 ? void 0 : _c.defaultView;\n            if (canvas.supportsTouchEvents &&\n                nativeEvent.pointerType === 'touch')\n                return;\n            var normalizedEvents = _this.normalizeToPointerEvent(nativeEvent, canvas);\n            try {\n                for (var normalizedEvents_1 = __values(normalizedEvents), normalizedEvents_1_1 = normalizedEvents_1.next(); !normalizedEvents_1_1.done; normalizedEvents_1_1 = normalizedEvents_1.next()) {\n                    var normalizedEvent = normalizedEvents_1_1.value;\n                    var event_1 = _this.bootstrapEvent(_this.rootPointerEvent, normalizedEvent, canvas, nativeEvent);\n                    _this.context.eventService.mapEvent(event_1);\n                }\n            }\n            catch (e_1_1) { e_1 = { error: e_1_1 }; }\n            finally {\n                try {\n                    if (normalizedEvents_1_1 && !normalizedEvents_1_1.done && (_a = normalizedEvents_1.return)) _a.call(normalizedEvents_1);\n                }\n                finally { if (e_1) throw e_1.error; }\n            }\n            _this.setCursor(_this.context.eventService.cursor);\n        };\n        this.onClick = function (nativeEvent) {\n            var e_2, _a;\n            var _b, _c;\n            var canvas = (_c = (_b = _this.context.renderingContext.root) === null || _b === void 0 ? void 0 : _b.ownerDocument) === null || _c === void 0 ? void 0 : _c.defaultView;\n            var normalizedEvents = _this.normalizeToPointerEvent(nativeEvent, canvas);\n            try {\n                for (var normalizedEvents_2 = __values(normalizedEvents), normalizedEvents_2_1 = normalizedEvents_2.next(); !normalizedEvents_2_1.done; normalizedEvents_2_1 = normalizedEvents_2.next()) {\n                    var normalizedEvent = normalizedEvents_2_1.value;\n                    var event_2 = _this.bootstrapEvent(_this.rootPointerEvent, normalizedEvent, canvas, nativeEvent);\n                    _this.context.eventService.mapEvent(event_2);\n                }\n            }\n            catch (e_2_1) { e_2 = { error: e_2_1 }; }\n            finally {\n                try {\n                    if (normalizedEvents_2_1 && !normalizedEvents_2_1.done && (_a = normalizedEvents_2.return)) _a.call(normalizedEvents_2);\n                }\n                finally { if (e_2) throw e_2.error; }\n            }\n            _this.setCursor(_this.context.eventService.cursor);\n        };\n    }\n    EventPlugin.prototype.apply = function (context) {\n        var _this = this;\n        this.context = context;\n        var renderingService = context.renderingService;\n        var canvas = this.context.renderingContext.root.ownerDocument.defaultView;\n        this.context.eventService.setPickHandler(function (position) {\n            var picked = _this.context.renderingService.hooks.pickSync.call({\n                position: position,\n                picked: [],\n                topmost: true, // we only concern the topmost element\n            }).picked;\n            return picked[0] || null;\n        });\n        renderingService.hooks.pointerWheel.tap(EventPlugin.tag, function (nativeEvent) {\n            var wheelEvent = _this.normalizeWheelEvent(nativeEvent);\n            _this.context.eventService.mapEvent(wheelEvent);\n        });\n        renderingService.hooks.pointerDown.tap(EventPlugin.tag, function (nativeEvent) {\n            var e_3, _a;\n            if (canvas.supportsTouchEvents &&\n                nativeEvent.pointerType === 'touch')\n                return;\n            var events = _this.normalizeToPointerEvent(nativeEvent, canvas);\n            if (_this.autoPreventDefault && events[0].isNormalized) {\n                var cancelable = nativeEvent.cancelable || !('cancelable' in nativeEvent);\n                if (cancelable) {\n                    nativeEvent.preventDefault();\n                }\n            }\n            try {\n                for (var events_1 = __values(events), events_1_1 = events_1.next(); !events_1_1.done; events_1_1 = events_1.next()) {\n                    var event_3 = events_1_1.value;\n                    var federatedEvent = _this.bootstrapEvent(_this.rootPointerEvent, event_3, canvas, nativeEvent);\n                    _this.context.eventService.mapEvent(federatedEvent);\n                }\n            }\n            catch (e_3_1) { e_3 = { error: e_3_1 }; }\n            finally {\n                try {\n                    if (events_1_1 && !events_1_1.done && (_a = events_1.return)) _a.call(events_1);\n                }\n                finally { if (e_3) throw e_3.error; }\n            }\n            _this.setCursor(_this.context.eventService.cursor);\n        });\n        renderingService.hooks.pointerUp.tap(EventPlugin.tag, function (nativeEvent) {\n            var e_4, _a;\n            if (canvas.supportsTouchEvents &&\n                nativeEvent.pointerType === 'touch')\n                return;\n            // account for element in SVG\n            var $element = _this.context.contextService.getDomElement();\n            var isNativeEventFromCanvas = _this.context.eventService.isNativeEventFromCanvas($element, nativeEvent);\n            var outside = !isNativeEventFromCanvas ? 'outside' : '';\n            var normalizedEvents = _this.normalizeToPointerEvent(nativeEvent, canvas);\n            try {\n                for (var normalizedEvents_3 = __values(normalizedEvents), normalizedEvents_3_1 = normalizedEvents_3.next(); !normalizedEvents_3_1.done; normalizedEvents_3_1 = normalizedEvents_3.next()) {\n                    var normalizedEvent = normalizedEvents_3_1.value;\n                    var event_4 = _this.bootstrapEvent(_this.rootPointerEvent, normalizedEvent, canvas, nativeEvent);\n                    event_4.type += outside;\n                    _this.context.eventService.mapEvent(event_4);\n                }\n            }\n            catch (e_4_1) { e_4 = { error: e_4_1 }; }\n            finally {\n                try {\n                    if (normalizedEvents_3_1 && !normalizedEvents_3_1.done && (_a = normalizedEvents_3.return)) _a.call(normalizedEvents_3);\n                }\n                finally { if (e_4) throw e_4.error; }\n            }\n            _this.setCursor(_this.context.eventService.cursor);\n        });\n        renderingService.hooks.pointerMove.tap(EventPlugin.tag, this.onPointerMove);\n        renderingService.hooks.pointerOver.tap(EventPlugin.tag, this.onPointerMove);\n        renderingService.hooks.pointerOut.tap(EventPlugin.tag, this.onPointerMove);\n        renderingService.hooks.click.tap(EventPlugin.tag, this.onClick);\n        renderingService.hooks.pointerCancel.tap(EventPlugin.tag, function (nativeEvent) {\n            var e_5, _a;\n            var normalizedEvents = _this.normalizeToPointerEvent(nativeEvent, canvas);\n            try {\n                for (var normalizedEvents_4 = __values(normalizedEvents), normalizedEvents_4_1 = normalizedEvents_4.next(); !normalizedEvents_4_1.done; normalizedEvents_4_1 = normalizedEvents_4.next()) {\n                    var normalizedEvent = normalizedEvents_4_1.value;\n                    var event_5 = _this.bootstrapEvent(_this.rootPointerEvent, normalizedEvent, canvas, nativeEvent);\n                    _this.context.eventService.mapEvent(event_5);\n                }\n            }\n            catch (e_5_1) { e_5 = { error: e_5_1 }; }\n            finally {\n                try {\n                    if (normalizedEvents_4_1 && !normalizedEvents_4_1.done && (_a = normalizedEvents_4.return)) _a.call(normalizedEvents_4);\n                }\n                finally { if (e_5) throw e_5.error; }\n            }\n            _this.setCursor(_this.context.eventService.cursor);\n        });\n    };\n    EventPlugin.prototype.bootstrapEvent = function (event, normalizedEvent, view, nativeEvent) {\n        event.view = view;\n        event.originalEvent = null;\n        event.nativeEvent = nativeEvent;\n        event.pointerId = normalizedEvent.pointerId;\n        event.width = normalizedEvent.width;\n        event.height = normalizedEvent.height;\n        event.isPrimary = normalizedEvent.isPrimary;\n        event.pointerType = normalizedEvent.pointerType;\n        event.pressure = normalizedEvent.pressure;\n        event.tangentialPressure = normalizedEvent.tangentialPressure;\n        event.tiltX = normalizedEvent.tiltX;\n        event.tiltY = normalizedEvent.tiltY;\n        event.twist = normalizedEvent.twist;\n        this.transferMouseData(event, normalizedEvent);\n        var _a = this.context.eventService.client2Viewport({\n            x: normalizedEvent.clientX,\n            y: normalizedEvent.clientY,\n        }), x = _a.x, y = _a.y;\n        event.viewport.x = x;\n        event.viewport.y = y;\n        var _b = this.context.eventService.viewport2Canvas(event.viewport), canvasX = _b.x, canvasY = _b.y;\n        event.canvas.x = canvasX;\n        event.canvas.y = canvasY;\n        event.global.copyFrom(event.canvas);\n        event.offset.copyFrom(event.canvas);\n        event.isTrusted = nativeEvent.isTrusted;\n        if (event.type === 'pointerleave') {\n            event.type = 'pointerout';\n        }\n        if (event.type.startsWith('mouse')) {\n            event.type = event.type.replace('mouse', 'pointer');\n        }\n        if (event.type.startsWith('touch')) {\n            event.type = TOUCH_TO_POINTER[event.type] || event.type;\n        }\n        return event;\n    };\n    EventPlugin.prototype.normalizeWheelEvent = function (nativeEvent) {\n        var event = this.rootWheelEvent;\n        this.transferMouseData(event, nativeEvent);\n        event.deltaMode = nativeEvent.deltaMode;\n        event.deltaX = nativeEvent.deltaX;\n        event.deltaY = nativeEvent.deltaY;\n        event.deltaZ = nativeEvent.deltaZ;\n        var _a = this.context.eventService.client2Viewport({\n            x: nativeEvent.clientX,\n            y: nativeEvent.clientY,\n        }), x = _a.x, y = _a.y;\n        event.viewport.x = x;\n        event.viewport.y = y;\n        var _b = this.context.eventService.viewport2Canvas(event.viewport), canvasX = _b.x, canvasY = _b.y;\n        event.canvas.x = canvasX;\n        event.canvas.y = canvasY;\n        event.global.copyFrom(event.canvas);\n        event.offset.copyFrom(event.canvas);\n        event.nativeEvent = nativeEvent;\n        event.type = nativeEvent.type;\n        return event;\n    };\n    /**\n     * Transfers base & mouse event data from the nativeEvent to the federated event.\n     */\n    EventPlugin.prototype.transferMouseData = function (event, nativeEvent) {\n        event.isTrusted = nativeEvent.isTrusted;\n        event.srcElement = nativeEvent.srcElement;\n        event.timeStamp = clock.now();\n        event.type = nativeEvent.type;\n        event.altKey = nativeEvent.altKey;\n        event.metaKey = nativeEvent.metaKey;\n        event.shiftKey = nativeEvent.shiftKey;\n        event.ctrlKey = nativeEvent.ctrlKey;\n        event.button = nativeEvent.button;\n        event.buttons = nativeEvent.buttons;\n        event.client.x = nativeEvent.clientX;\n        event.client.y = nativeEvent.clientY;\n        event.movement.x = nativeEvent.movementX;\n        event.movement.y = nativeEvent.movementY;\n        event.page.x = nativeEvent.pageX;\n        event.page.y = nativeEvent.pageY;\n        event.screen.x = nativeEvent.screenX;\n        event.screen.y = nativeEvent.screenY;\n        event.relatedTarget = null;\n    };\n    EventPlugin.prototype.setCursor = function (cursor) {\n        this.context.contextService.applyCursorStyle(cursor || this.context.config.cursor || 'default');\n    };\n    EventPlugin.prototype.normalizeToPointerEvent = function (event, canvas) {\n        var normalizedEvents = [];\n        if (canvas.isTouchEvent(event)) {\n            for (var i = 0; i < event.changedTouches.length; i++) {\n                var touch = event.changedTouches[i];\n                // use changedTouches instead of touches since touchend has no touches\n                // @see https://stackoverflow.com/a/10079076\n                if (isUndefined(touch.button))\n                    touch.button = 0;\n                if (isUndefined(touch.buttons))\n                    touch.buttons = 1;\n                if (isUndefined(touch.isPrimary)) {\n                    touch.isPrimary =\n                        event.touches.length === 1 && event.type === 'touchstart';\n                }\n                if (isUndefined(touch.width))\n                    touch.width = touch.radiusX || 1;\n                if (isUndefined(touch.height))\n                    touch.height = touch.radiusY || 1;\n                if (isUndefined(touch.tiltX))\n                    touch.tiltX = 0;\n                if (isUndefined(touch.tiltY))\n                    touch.tiltY = 0;\n                if (isUndefined(touch.pointerType))\n                    touch.pointerType = 'touch';\n                // @see https://developer.mozilla.org/zh-CN/docs/Web/API/Touch/identifier\n                if (isUndefined(touch.pointerId))\n                    touch.pointerId = touch.identifier || 0;\n                if (isUndefined(touch.pressure))\n                    touch.pressure = touch.force || 0.5;\n                if (isUndefined(touch.twist))\n                    touch.twist = 0;\n                if (isUndefined(touch.tangentialPressure))\n                    touch.tangentialPressure = 0;\n                touch.isNormalized = true;\n                touch.type = event.type;\n                normalizedEvents.push(touch);\n            }\n        }\n        else if (canvas.isMouseEvent(event)) {\n            var tempEvent = event;\n            if (isUndefined(tempEvent.isPrimary))\n                tempEvent.isPrimary = true;\n            if (isUndefined(tempEvent.width))\n                tempEvent.width = 1;\n            if (isUndefined(tempEvent.height))\n                tempEvent.height = 1;\n            if (isUndefined(tempEvent.tiltX))\n                tempEvent.tiltX = 0;\n            if (isUndefined(tempEvent.tiltY))\n                tempEvent.tiltY = 0;\n            if (isUndefined(tempEvent.pointerType))\n                tempEvent.pointerType = 'mouse';\n            if (isUndefined(tempEvent.pointerId))\n                tempEvent.pointerId = MOUSE_POINTER_ID;\n            if (isUndefined(tempEvent.pressure))\n                tempEvent.pressure = 0.5;\n            if (isUndefined(tempEvent.twist))\n                tempEvent.twist = 0;\n            if (isUndefined(tempEvent.tangentialPressure))\n                tempEvent.tangentialPressure = 0;\n            tempEvent.isNormalized = true;\n            normalizedEvents.push(tempEvent);\n        }\n        else {\n            normalizedEvents.push(event);\n        }\n        return normalizedEvents;\n    };\n    EventPlugin.tag = 'Event';\n    return EventPlugin;\n}());\n\n// group is not a 2d shape\nvar shape2D = [\n    Shape.CIRCLE,\n    Shape.ELLIPSE,\n    Shape.IMAGE,\n    Shape.RECT,\n    Shape.LINE,\n    Shape.POLYLINE,\n    Shape.POLYGON,\n    Shape.TEXT,\n    Shape.PATH,\n    Shape.HTML,\n];\nvar FrustumCullingStrategy = /** @class */ (function () {\n    function FrustumCullingStrategy() {\n    }\n    FrustumCullingStrategy.prototype.isVisible = function (camera, object) {\n        // return true;\n        var _a, _b;\n        var cullable = object.cullable;\n        if (!cullable.enable) {\n            return true;\n        }\n        var renderBounds = object.getRenderBounds();\n        if (AABB.isEmpty(renderBounds)) {\n            return false;\n        }\n        // get VP matrix from camera\n        var frustum = camera.getFrustum();\n        var parentVisibilityPlaneMask = (_b = (_a = object.parentNode) === null || _a === void 0 ? void 0 : _a.cullable) === null || _b === void 0 ? void 0 : _b.visibilityPlaneMask;\n        cullable.visibilityPlaneMask = this.computeVisibilityWithPlaneMask(object, renderBounds, parentVisibilityPlaneMask || Mask.INDETERMINATE, frustum.planes);\n        cullable.visible = cullable.visibilityPlaneMask !== Mask.OUTSIDE;\n        return cullable.visible;\n    };\n    /**\n     *\n     * @see「Optimized View Frustum Culling Algorithms for Bounding Boxes」\n     * @see https://github.com/antvis/GWebGPUEngine/issues/3\n     *\n     * * 基础相交测试 the basic intersection test\n     * * 标记 masking @see https://cesium.com/blog/2015/08/04/fast-hierarchical-culling/\n     * * TODO: 平面一致性测试 the plane-coherency test\n     * * TODO: 支持 mesh 指定自身的剔除策略，参考 Babylon.js @see https://doc.babylonjs.com/how_to/optimizing_your_scene#changing-mesh-culling-strategy\n     *\n     * @param aabb aabb\n     * @param parentPlaneMask mask of parent\n     * @param planes planes of frustum\n     */\n    FrustumCullingStrategy.prototype.computeVisibilityWithPlaneMask = function (object, aabb, parentPlaneMask, planes) {\n        if (parentPlaneMask === Mask.OUTSIDE || parentPlaneMask === Mask.INSIDE) {\n            // 父节点完全位于视锥内或者外部，直接返回\n            return parentPlaneMask;\n        }\n        // Start with MASK_INSIDE (all zeros) so that after the loop, the return value can be compared with MASK_INSIDE.\n        // (Because if there are fewer than 31 planes, the upper bits wont be changed.)\n        var mask = Mask.INSIDE;\n        var isShape2D = shape2D.indexOf(object.nodeName) > -1;\n        // Use viewport culling for 2D shapes\n        // @see https://github.com/antvis/g/issues/914\n        for (var k = 0, len = planes.length; k < len; ++k) {\n            // For k greater than 31 (since 31 is the maximum number of INSIDE/INTERSECTING bits we can store), skip the optimization.\n            var flag = 1 << k;\n            if ((parentPlaneMask & flag) === 0) {\n                // 父节点处于当前面内部，可以跳过\n                continue;\n            }\n            // skip near & far planes when testing 2D shapes\n            if (isShape2D && (k === 4 || k === 5)) {\n                continue;\n            }\n            // p-vertex n-vertex <-|plane p-vertex n-vertex\n            // 使用 p-vertex 和 n-vertex 加速，避免进行平面和 aabb 全部顶点的相交检测\n            var _a = planes[k], normal = _a.normal, distance = _a.distance;\n            if (vec3.dot(normal, aabb.getPositiveFarPoint(planes[k])) + distance <\n                0) {\n                return Mask.OUTSIDE;\n            }\n            if (vec3.dot(normal, aabb.getNegativeFarPoint(planes[k])) + distance <\n                0) {\n                // 和当前面相交，对应位置为1，继续检测下一个面\n                mask |= flag;\n            }\n        }\n        return mask;\n    };\n    return FrustumCullingStrategy;\n}());\n\nvar PrepareRendererPlugin = /** @class */ (function () {\n    function PrepareRendererPlugin() {\n        /**\n         * sync to RBush later\n         */\n        this.toSync = new Set();\n        this.isFirstTimeRendering = true;\n        this.syncing = false;\n        this.isFirstTimeRenderingFinished = false;\n    }\n    PrepareRendererPlugin.prototype.apply = function (context) {\n        var _this = this;\n        var _a;\n        var renderingService = context.renderingService, renderingContext = context.renderingContext, rBushRoot = context.rBushRoot;\n        var canvas = renderingContext.root.ownerDocument.defaultView;\n        this.rBush = rBushRoot;\n        var handleAttributeChanged = function (e) {\n            var object = e.target;\n            object.renderable.dirty = true;\n            renderingService.dirtify();\n        };\n        var handleBoundsChanged = function (e) {\n            var affectChildren = e.detail.affectChildren;\n            var object = e.target;\n            if (affectChildren) {\n                object.forEach(function (node) {\n                    _this.toSync.add(node);\n                });\n            }\n            var p = object;\n            while (p) {\n                if (p.renderable) {\n                    _this.toSync.add(p);\n                }\n                p = p.parentElement;\n            }\n            // this.pushToSync(e.composedPath().slice(0, -2) as DisplayObject[]);\n            renderingService.dirtify();\n        };\n        var handleMounted = function (e) {\n            var object = e.target;\n            if (runtime.enableSizeAttenuation) {\n                runtime.styleValueRegistry.updateSizeAttenuation(object, canvas.getCamera().getZoom());\n            }\n            if (runtime.enableCSSParsing) {\n                // recalc style values\n                runtime.styleValueRegistry.recalc(object);\n            }\n            runtime.sceneGraphService.dirtifyToRoot(object);\n            renderingService.dirtify();\n        };\n        var handleUnmounted = function (e) {\n            var object = e.target;\n            var rBushNode = object.rBushNode;\n            if (rBushNode.aabb) {\n                _this.rBush.remove(rBushNode.aabb);\n            }\n            _this.toSync.delete(object);\n            runtime.sceneGraphService.dirtifyToRoot(object);\n            renderingService.dirtify();\n        };\n        renderingService.hooks.init.tap(PrepareRendererPlugin.tag, function () {\n            canvas.addEventListener(ElementEvent.MOUNTED, handleMounted);\n            canvas.addEventListener(ElementEvent.UNMOUNTED, handleUnmounted);\n            canvas.addEventListener(ElementEvent.ATTR_MODIFIED, handleAttributeChanged);\n            canvas.addEventListener(ElementEvent.BOUNDS_CHANGED, handleBoundsChanged);\n        });\n        renderingService.hooks.destroy.tap(PrepareRendererPlugin.tag, function () {\n            canvas.removeEventListener(ElementEvent.MOUNTED, handleMounted);\n            canvas.removeEventListener(ElementEvent.UNMOUNTED, handleUnmounted);\n            canvas.removeEventListener(ElementEvent.ATTR_MODIFIED, handleAttributeChanged);\n            canvas.removeEventListener(ElementEvent.BOUNDS_CHANGED, handleBoundsChanged);\n            _this.toSync.clear();\n        });\n        var ric = (_a = runtime.globalThis.requestIdleCallback) !== null && _a !== void 0 ? _a : raf.bind(runtime.globalThis);\n        renderingService.hooks.endFrame.tap(PrepareRendererPlugin.tag, function () {\n            if (_this.isFirstTimeRendering) {\n                _this.isFirstTimeRendering = false;\n                _this.syncing = true;\n                ric(function () {\n                    _this.syncRTree(true);\n                    _this.isFirstTimeRenderingFinished = true;\n                });\n            }\n            else {\n                _this.syncRTree();\n            }\n        });\n    };\n    PrepareRendererPlugin.prototype.syncRTree = function (force) {\n        var _this = this;\n        if (force === void 0) { force = false; }\n        if (!force && (this.syncing || this.toSync.size === 0)) {\n            return;\n        }\n        this.syncing = true;\n        // bounds changed, need re-inserting its children\n        var bulk = [];\n        Array.from(this.toSync)\n            // some objects may be removed since last frame\n            .filter(function (object) { return object.isConnected; })\n            .forEach(function (node) {\n            var rBushNode = node.rBushNode;\n            // clear dirty node\n            if (rBushNode && rBushNode.aabb) {\n                _this.rBush.remove(rBushNode.aabb);\n            }\n            var renderBounds = node.getRenderBounds();\n            if (renderBounds) {\n                var renderable = node.renderable;\n                if (force) {\n                    if (!renderable.dirtyRenderBounds) {\n                        renderable.dirtyRenderBounds = new AABB();\n                    }\n                    // save last dirty aabb\n                    renderable.dirtyRenderBounds.update(renderBounds.center, renderBounds.halfExtents);\n                }\n                var _a = __read(renderBounds.getMin(), 2), minX = _a[0], minY = _a[1];\n                var _b = __read(renderBounds.getMax(), 2), maxX = _b[0], maxY = _b[1];\n                if (!rBushNode.aabb) {\n                    rBushNode.aabb = {};\n                }\n                rBushNode.aabb.displayObject = node;\n                rBushNode.aabb.minX = minX;\n                rBushNode.aabb.minY = minY;\n                rBushNode.aabb.maxX = maxX;\n                rBushNode.aabb.maxY = maxY;\n            }\n            if (rBushNode.aabb) {\n                // TODO: NaN occurs when width/height of Rect is 0\n                if (!isNaN(rBushNode.aabb.maxX) &&\n                    !isNaN(rBushNode.aabb.maxX) &&\n                    !isNaN(rBushNode.aabb.minX) &&\n                    !isNaN(rBushNode.aabb.minY)) {\n                    bulk.push(rBushNode.aabb);\n                }\n            }\n        });\n        // use bulk inserting, which is ~2-3 times faster\n        // @see https://github.com/mourner/rbush#bulk-inserting-data\n        this.rBush.load(bulk);\n        bulk.length = 0;\n        this.toSync.clear();\n        this.syncing = false;\n    };\n    PrepareRendererPlugin.tag = 'Prepare';\n    return PrepareRendererPlugin;\n}());\n\nfunction isCanvas(value) {\n    return !!value.document;\n}\nvar CanvasEvent;\n(function (CanvasEvent) {\n    CanvasEvent[\"READY\"] = \"ready\";\n    CanvasEvent[\"BEFORE_RENDER\"] = \"beforerender\";\n    CanvasEvent[\"RERENDER\"] = \"rerender\";\n    CanvasEvent[\"AFTER_RENDER\"] = \"afterrender\";\n    CanvasEvent[\"BEFORE_DESTROY\"] = \"beforedestroy\";\n    CanvasEvent[\"AFTER_DESTROY\"] = \"afterdestroy\";\n    CanvasEvent[\"RESIZE\"] = \"resize\";\n    CanvasEvent[\"DIRTY_RECTANGLE\"] = \"dirtyrectangle\";\n    CanvasEvent[\"RENDERER_CHANGED\"] = \"rendererchanged\";\n})(CanvasEvent || (CanvasEvent = {}));\nvar DEFAULT_CAMERA_Z = 500;\nvar DEFAULT_CAMERA_NEAR = 0.1;\nvar DEFAULT_CAMERA_FAR = 1000;\n/**\n * reuse custom event preventing from re-create them in every frame\n */\nvar mountedEvent = new CustomEvent(ElementEvent.MOUNTED);\nvar unmountedEvent = new CustomEvent(ElementEvent.UNMOUNTED);\nvar beforeRenderEvent = new CustomEvent(CanvasEvent.BEFORE_RENDER);\nvar rerenderEvent = new CustomEvent(CanvasEvent.RERENDER);\nvar afterRenderEvent = new CustomEvent(CanvasEvent.AFTER_RENDER);\n/**\n * can be treated like Window in DOM\n * provide some extra methods like `window`, such as:\n * * `window.requestAnimationFrame`\n * * `window.devicePixelRatio`\n *\n * prototype chains: Canvas(Window) -> EventTarget\n */\nvar Canvas = /** @class */ (function (_super) {\n    __extends(Canvas, _super);\n    function Canvas(config) {\n        var _this = _super.call(this) || this;\n        /**\n         * @see https://developer.mozilla.org/en-US/docs/Web/API/Element\n         */\n        _this.Element = DisplayObject;\n        _this.inited = false;\n        _this.context = {};\n        // create document\n        _this.document = new Document();\n        _this.document.defaultView = _this;\n        // create registry of custom elements\n        _this.customElements = new CustomElementRegistry();\n        var container = config.container, canvas = config.canvas, offscreenCanvas = config.offscreenCanvas, width = config.width, height = config.height, devicePixelRatio = config.devicePixelRatio, renderer = config.renderer, background = config.background, cursor = config.cursor, document = config.document, requestAnimationFrame = config.requestAnimationFrame, cancelAnimationFrame = config.cancelAnimationFrame, createImage = config.createImage, supportsPointerEvents = config.supportsPointerEvents, supportsTouchEvents = config.supportsTouchEvents, supportsCSSTransform = config.supportsCSSTransform, supportsMutipleCanvasesInOneContainer = config.supportsMutipleCanvasesInOneContainer, useNativeClickEvent = config.useNativeClickEvent, alwaysTriggerPointerEventOnCanvas = config.alwaysTriggerPointerEventOnCanvas, isTouchEvent = config.isTouchEvent, isMouseEvent = config.isMouseEvent;\n        if (!supportsMutipleCanvasesInOneContainer) {\n            cleanExistedCanvas(container, _this);\n        }\n        var canvasWidth = width;\n        var canvasHeight = height;\n        var dpr = devicePixelRatio;\n        // use user-defined <canvas> or OffscreenCanvas\n        if (canvas) {\n            // infer width & height with dpr\n            dpr = devicePixelRatio || (isBrowser && window.devicePixelRatio) || 1;\n            dpr = dpr >= 1 ? Math.ceil(dpr) : 1;\n            canvasWidth = width || getWidth(canvas) || canvas.width / dpr;\n            canvasHeight = height || getHeight(canvas) || canvas.height / dpr;\n        }\n        // override it in runtime\n        if (offscreenCanvas) {\n            runtime.offscreenCanvas = offscreenCanvas;\n        }\n        /**\n         * implements `Window` interface\n         */\n        _this.devicePixelRatio = dpr;\n        _this.requestAnimationFrame =\n            requestAnimationFrame !== null && requestAnimationFrame !== void 0 ? requestAnimationFrame : raf.bind(runtime.globalThis);\n        _this.cancelAnimationFrame =\n            cancelAnimationFrame !== null && cancelAnimationFrame !== void 0 ? cancelAnimationFrame : caf.bind(runtime.globalThis);\n        /**\n         * limits query\n         */\n        // the following feature-detect from hammer.js\n        // @see https://github.com/hammerjs/hammer.js/blob/master/src/inputjs/input-consts.js#L5\n        _this.supportsTouchEvents =\n            supportsTouchEvents !== null && supportsTouchEvents !== void 0 ? supportsTouchEvents : 'ontouchstart' in runtime.globalThis;\n        _this.supportsPointerEvents =\n            supportsPointerEvents !== null && supportsPointerEvents !== void 0 ? supportsPointerEvents : !!runtime.globalThis.PointerEvent;\n        _this.isTouchEvent =\n            isTouchEvent !== null && isTouchEvent !== void 0 ? isTouchEvent : (function (event) {\n                return _this.supportsTouchEvents &&\n                    event instanceof runtime.globalThis.TouchEvent;\n            });\n        _this.isMouseEvent =\n            isMouseEvent !== null && isMouseEvent !== void 0 ? isMouseEvent : (function (event) {\n                return !runtime.globalThis.MouseEvent ||\n                    (event instanceof runtime.globalThis.MouseEvent &&\n                        (!_this.supportsPointerEvents ||\n                            !(event instanceof runtime.globalThis.PointerEvent)));\n            });\n        _this.initRenderingContext({\n            container: container,\n            canvas: canvas,\n            width: canvasWidth,\n            height: canvasHeight,\n            renderer: renderer,\n            offscreenCanvas: offscreenCanvas,\n            devicePixelRatio: dpr,\n            cursor: cursor || 'default',\n            background: background || 'transparent',\n            createImage: createImage,\n            document: document,\n            supportsCSSTransform: supportsCSSTransform,\n            useNativeClickEvent: useNativeClickEvent,\n            alwaysTriggerPointerEventOnCanvas: alwaysTriggerPointerEventOnCanvas,\n        });\n        _this.initDefaultCamera(canvasWidth, canvasHeight, renderer.clipSpaceNearZ);\n        _this.initRenderer(renderer, true);\n        return _this;\n    }\n    Canvas.prototype.initRenderingContext = function (mergedConfig) {\n        this.context.config = mergedConfig;\n        // bind rendering context, shared by all renderers\n        this.context.renderingContext = {\n            /**\n             * the root node in scene graph\n             */\n            root: this.document.documentElement,\n            renderListCurrentFrame: [],\n            unculledEntities: [],\n            renderReasons: new Set(),\n            force: false,\n            dirty: false,\n        };\n    };\n    Canvas.prototype.initDefaultCamera = function (width, height, clipSpaceNearZ) {\n        var _this = this;\n        // set a default ortho camera\n        var camera = new runtime.CameraContribution();\n        camera.clipSpaceNearZ = clipSpaceNearZ;\n        camera\n            .setType(CameraType.EXPLORING, CameraTrackingMode.DEFAULT)\n            .setPosition(width / 2, height / 2, DEFAULT_CAMERA_Z)\n            .setFocalPoint(width / 2, height / 2, 0)\n            .setOrthographic(width / -2, width / 2, height / 2, height / -2, DEFAULT_CAMERA_NEAR, DEFAULT_CAMERA_FAR);\n        // keep ref since it will use raf in camera animation\n        camera.canvas = this;\n        // redraw when camera changed\n        camera.eventEmitter.on(CameraEvent.UPDATED, function () {\n            _this.context.renderingContext.renderReasons.add(RenderReason.CAMERA_CHANGED);\n            if (runtime.enableSizeAttenuation &&\n                _this.getConfig().renderer.getConfig().enableSizeAttenuation) {\n                _this.updateSizeAttenuation();\n            }\n        });\n        // bind camera\n        this.context.camera = camera;\n    };\n    Canvas.prototype.updateSizeAttenuation = function () {\n        var zoom = this.getCamera().getZoom();\n        this.document.documentElement.forEach(function (node) {\n            runtime.styleValueRegistry.updateSizeAttenuation(node, zoom);\n        });\n    };\n    Canvas.prototype.getConfig = function () {\n        return this.context.config;\n    };\n    /**\n     * get the root displayObject in scenegraph\n     * @alias this.document.documentElement\n     */\n    Canvas.prototype.getRoot = function () {\n        return this.document.documentElement;\n    };\n    /**\n     * get the camera of canvas\n     */\n    Canvas.prototype.getCamera = function () {\n        return this.context.camera;\n    };\n    Canvas.prototype.getContextService = function () {\n        return this.context.contextService;\n    };\n    Canvas.prototype.getEventService = function () {\n        return this.context.eventService;\n    };\n    Canvas.prototype.getRenderingService = function () {\n        return this.context.renderingService;\n    };\n    Canvas.prototype.getRenderingContext = function () {\n        return this.context.renderingContext;\n    };\n    Canvas.prototype.getStats = function () {\n        return this.getRenderingService().getStats();\n    };\n    Object.defineProperty(Canvas.prototype, \"ready\", {\n        // /**\n        //  * @see https://developer.mozilla.org/zh-CN/docs/Web/API/Window/getComputedStyle\n        //  */\n        // getComputedStyle(node: DisplayObject) {\n        //   return node.computedStyle;\n        // }\n        get: function () {\n            var _this = this;\n            if (!this.readyPromise) {\n                this.readyPromise = new Promise(function (resolve) {\n                    _this.resolveReadyPromise = function () {\n                        resolve(_this);\n                    };\n                });\n                if (this.inited) {\n                    this.resolveReadyPromise();\n                }\n            }\n            return this.readyPromise;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * `cleanUp` means clean all the internal services of Canvas which happens when calling `canvas.destroy()`.\n     */\n    Canvas.prototype.destroy = function (cleanUp, skipTriggerEvent) {\n        if (cleanUp === void 0) { cleanUp = true; }\n        if (skipTriggerEvent === void 0) { skipTriggerEvent = false; }\n        if (!skipTriggerEvent) {\n            this.dispatchEvent(new CustomEvent(CanvasEvent.BEFORE_DESTROY));\n        }\n        if (this.frameId) {\n            var cancelRAF = this.getConfig().cancelAnimationFrame || cancelAnimationFrame;\n            cancelRAF(this.frameId);\n        }\n        // unmount all children\n        var root = this.getRoot();\n        this.unmountChildren(root);\n        if (cleanUp) {\n            // destroy Document\n            this.document.destroy();\n            this.getEventService().destroy();\n        }\n        // destroy services\n        this.getRenderingService().destroy();\n        this.getContextService().destroy();\n        // clear root after renderservice destroyed\n        if (cleanUp && this.context.rBushRoot) {\n            // clear rbush\n            this.context.rBushRoot.clear();\n            this.context.rBushRoot = null;\n            this.context.renderingContext.root = null;\n        }\n        if (!skipTriggerEvent) {\n            this.dispatchEvent(new CustomEvent(CanvasEvent.AFTER_DESTROY));\n        }\n    };\n    /**\n     * compatible with G 3.0\n     * @deprecated\n     * @alias resize\n     */\n    Canvas.prototype.changeSize = function (width, height) {\n        this.resize(width, height);\n    };\n    Canvas.prototype.resize = function (width, height) {\n        // update canvas' config\n        var canvasConfig = this.context.config;\n        canvasConfig.width = width;\n        canvasConfig.height = height;\n        // resize context\n        this.getContextService().resize(width, height);\n        // resize camera\n        var camera = this.context.camera;\n        var projectionMode = camera.getProjectionMode();\n        camera\n            .setPosition(width / 2, height / 2, DEFAULT_CAMERA_Z)\n            .setFocalPoint(width / 2, height / 2, 0);\n        if (projectionMode === CameraProjectionMode.ORTHOGRAPHIC) {\n            camera.setOrthographic(width / -2, width / 2, height / 2, height / -2, camera.getNear(), camera.getFar());\n        }\n        else {\n            camera.setAspect(width / height);\n        }\n        this.dispatchEvent(new CustomEvent(CanvasEvent.RESIZE, { width: width, height: height }));\n    };\n    // proxy to document.documentElement\n    Canvas.prototype.appendChild = function (child, index) {\n        return this.document.documentElement.appendChild(child, index);\n    };\n    Canvas.prototype.insertBefore = function (newChild, refChild) {\n        return this.document.documentElement.insertBefore(newChild, refChild);\n    };\n    Canvas.prototype.removeChild = function (child) {\n        return this.document.documentElement.removeChild(child);\n    };\n    /**\n     * Remove all children which can be appended to its original parent later again.\n     */\n    Canvas.prototype.removeChildren = function () {\n        this.document.documentElement.removeChildren();\n    };\n    /**\n     * Recursively destroy all children which can not be appended to its original parent later again.\n     * But the canvas remains running which means display objects can be appended later.\n     */\n    Canvas.prototype.destroyChildren = function () {\n        this.document.documentElement.destroyChildren();\n    };\n    Canvas.prototype.render = function (frame) {\n        var _this = this;\n        this.dispatchEvent(beforeRenderEvent);\n        var renderingService = this.getRenderingService();\n        renderingService.render(this.getConfig(), frame, function () {\n            // trigger actual rerender event\n            // @see https://github.com/antvis/G/issues/1268\n            _this.dispatchEvent(rerenderEvent);\n        });\n        this.dispatchEvent(afterRenderEvent);\n    };\n    Canvas.prototype.run = function () {\n        var _this = this;\n        var tick = function (time, frame) {\n            _this.render(frame);\n            _this.frameId = _this.requestAnimationFrame(tick);\n        };\n        tick();\n    };\n    Canvas.prototype.initRenderer = function (renderer, firstContentfullPaint) {\n        var _this = this;\n        if (firstContentfullPaint === void 0) { firstContentfullPaint = false; }\n        if (!renderer) {\n            throw new Error('Renderer is required.');\n        }\n        // reset\n        this.inited = false;\n        this.readyPromise = undefined;\n        // FIXME: should re-create here?\n        this.context.rBushRoot = new RBush();\n        // reset rendering plugins\n        this.context.renderingPlugins = [];\n        this.context.renderingPlugins.push(new EventPlugin(), new PrepareRendererPlugin(), \n        // new DirtyCheckPlugin(),\n        new CullingPlugin([new FrustumCullingStrategy()]));\n        //\n        this.loadRendererContainerModule(renderer);\n        // init context service\n        this.context.contextService = new this.context.ContextService(__assign(__assign({}, runtime), this.context));\n        // init rendering service\n        this.context.renderingService = new RenderingService(runtime, this.context);\n        // init event service\n        this.context.eventService = new EventService(runtime, this.context);\n        this.context.eventService.init();\n        if (this.context.contextService.init) {\n            this.context.contextService.init();\n            this.initRenderingService(renderer, firstContentfullPaint, true);\n        }\n        else {\n            this.context.contextService.initAsync().then(function () {\n                _this.initRenderingService(renderer, firstContentfullPaint);\n            });\n        }\n    };\n    Canvas.prototype.initRenderingService = function (renderer, firstContentfullPaint, async) {\n        var _this = this;\n        if (firstContentfullPaint === void 0) { firstContentfullPaint = false; }\n        if (async === void 0) { async = false; }\n        this.context.renderingService.init(function () {\n            _this.inited = true;\n            if (firstContentfullPaint) {\n                if (async) {\n                    _this.requestAnimationFrame(function () {\n                        _this.dispatchEvent(new CustomEvent(CanvasEvent.READY));\n                    });\n                }\n                else {\n                    _this.dispatchEvent(new CustomEvent(CanvasEvent.READY));\n                }\n                if (_this.readyPromise) {\n                    _this.resolveReadyPromise();\n                }\n            }\n            else {\n                _this.dispatchEvent(new CustomEvent(CanvasEvent.RENDERER_CHANGED));\n            }\n            if (!firstContentfullPaint) {\n                _this.getRoot().forEach(function (node) {\n                    var renderable = node.renderable;\n                    if (renderable) {\n                        renderable.renderBoundsDirty = true;\n                        renderable.boundsDirty = true;\n                        renderable.dirty = true;\n                    }\n                });\n            }\n            // keep current scenegraph unchanged, just trigger mounted event\n            _this.mountChildren(_this.getRoot());\n            if (renderer.getConfig().enableAutoRendering) {\n                _this.run();\n            }\n        });\n    };\n    Canvas.prototype.loadRendererContainerModule = function (renderer) {\n        var _this = this;\n        // load other container modules provided by g-canvas/g-svg/g-webgl\n        var plugins = renderer.getPlugins();\n        plugins.forEach(function (plugin) {\n            plugin.context = _this.context;\n            plugin.init(runtime);\n        });\n    };\n    Canvas.prototype.setRenderer = function (renderer) {\n        // update canvas' config\n        var canvasConfig = this.getConfig();\n        if (canvasConfig.renderer === renderer) {\n            return;\n        }\n        var oldRenderer = canvasConfig.renderer;\n        canvasConfig.renderer = renderer;\n        // keep all children undestroyed\n        this.destroy(false, true);\n        // destroy all plugins, reverse will mutate origin array\n        __spreadArray([], __read(oldRenderer === null || oldRenderer === void 0 ? void 0 : oldRenderer.getPlugins()), false).reverse().forEach(function (plugin) {\n            plugin.destroy(runtime);\n        });\n        this.initRenderer(renderer);\n    };\n    Canvas.prototype.setCursor = function (cursor) {\n        var canvasConfig = this.getConfig();\n        canvasConfig.cursor = cursor;\n        this.getContextService().applyCursorStyle(cursor);\n    };\n    Canvas.prototype.unmountChildren = function (parent) {\n        var _this = this;\n        // unmountChildren recursively\n        parent.childNodes.forEach(function (child) {\n            _this.unmountChildren(child);\n        });\n        if (this.inited) {\n            if (parent.isMutationObserved) {\n                parent.dispatchEvent(unmountedEvent);\n            }\n            else {\n                unmountedEvent.target = parent;\n                this.dispatchEvent(unmountedEvent, true);\n            }\n            // skip document.documentElement\n            if (parent !== this.document.documentElement) {\n                parent.ownerDocument = null;\n            }\n            parent.isConnected = false;\n        }\n        // trigger after unmounted\n        if (parent.isCustomElement) {\n            if (parent.disconnectedCallback) {\n                parent.disconnectedCallback();\n            }\n        }\n    };\n    Canvas.prototype.mountChildren = function (parent) {\n        var _this = this;\n        if (this.inited) {\n            if (!parent.isConnected) {\n                parent.ownerDocument = this.document;\n                parent.isConnected = true;\n                if (parent.isMutationObserved) {\n                    parent.dispatchEvent(mountedEvent);\n                }\n                else {\n                    mountedEvent.target = parent;\n                    this.dispatchEvent(mountedEvent, true);\n                }\n            }\n        }\n        else {\n            console.warn(\"[g]: You are trying to call `canvas.appendChild` before canvas' initialization finished. You can either await `canvas.ready` or listen to `CanvasEvent.READY` manually.\", 'appended child: ', parent.nodeName);\n        }\n        // recursively mount children\n        parent.childNodes.forEach(function (child) {\n            _this.mountChildren(child);\n        });\n        // trigger after mounted\n        if (parent.isCustomElement) {\n            if (parent.connectedCallback) {\n                parent.connectedCallback();\n            }\n        }\n    };\n    Canvas.prototype.client2Viewport = function (client) {\n        return this.getEventService().client2Viewport(client);\n    };\n    Canvas.prototype.viewport2Client = function (canvas) {\n        return this.getEventService().viewport2Client(canvas);\n    };\n    Canvas.prototype.viewport2Canvas = function (viewport) {\n        return this.getEventService().viewport2Canvas(viewport);\n    };\n    Canvas.prototype.canvas2Viewport = function (canvas) {\n        return this.getEventService().canvas2Viewport(canvas);\n    };\n    /**\n     * @deprecated\n     * @alias client2Viewport\n     */\n    Canvas.prototype.getPointByClient = function (clientX, clientY) {\n        return this.client2Viewport({ x: clientX, y: clientY });\n    };\n    /**\n     * @deprecated\n     * @alias viewport2Client\n     */\n    Canvas.prototype.getClientByPoint = function (x, y) {\n        return this.viewport2Client({ x: x, y: y });\n    };\n    return Canvas;\n}(EventTarget));\n\nexport { AABB, AbstractRenderer, AbstractRendererPlugin, BUILT_IN_PROPERTIES, CSS, CSSGradientValue, CSSKeywordValue, CSSRGB, CSSStyleValue, CSSUnitValue, Camera, CameraEvent, CameraProjectionMode, CameraTrackingMode, CameraType, Canvas, CanvasEvent, Circle, CircleUpdater, ClipSpaceNearZ, CustomElement, CustomElementRegistry, CustomEvent, DefaultSceneGraphSelector, DefaultSceneGraphService, DisplayObject, Document, ERROR_MSG_METHOD_NOT_IMPLEMENTED, Element, ElementEvent, Ellipse, EllipseUpdater, EventService, EventTarget, FederatedEvent, FederatedMouseEvent, FederatedPointerEvent, FederatedWheelEvent, Frustum, GradientType, Group, GroupUpdater, HTML, Image, Line, LineUpdater, Mask, MutationEvent, Node, OffscreenCanvasCreator, Path, PathUpdater, Plane, Point, Polygon, Polyline, PolylineUpdater, PropertySyntax, RBush, Rect, RectUpdater, Rectangle, RenderReason, RenderingService, Shape, SortReason, Strategy, Text, TextService, TextUpdater, UnitType, computeLinearGradient, computeRadialGradient, convertToPath, createVec3, decompose, definedProps, deg2rad, deg2turn, findClosestClipPathTarget, fromRotationTranslationScale, getAngle, getEuler, getOrCalculatePathTotalLength, grad2deg, isBrowser, isCSSGradientValue, isCSSRGB, isCanvas, isDisplayObject, isFederatedEvent, isFillOrStrokeAffected, isPattern, mergeColors, parseColor, parseLength, parsePath, parseTransform, parsedTransformToMat4, propertyMetadataCache, rad2deg, resetEntityCounter, runtime, setDOMSize, translatePathToString, turn2deg };\n//# sourceMappingURL=index.esm.js.map\n"],"names":["rbush","globalThis","window","g","self","exports","quickselect","arr","k","left","right","compare","quickselectStep","length","defaultCompare","n","m","z","Math","log","s","exp","sd","sqrt","max","floor","min","t","i","j","swap","tmp","a","b","RBush","maxEntries","this","_maxEntries","_minEntries","ceil","clear","findItem","item","items","equalsFn","indexOf","calcBBox","node","toBBox","distBBox","children","p","destNode","createNode","minX","Infinity","minY","maxX","maxY","child","extend","leaf","compareNodeMinX","compareNodeMinY","bboxArea","bboxMargin","enlargedArea","intersectionArea","contains","intersects","height","multiSelect","stack","pop","mid","push","prototype","all","_all","data","search","bbox","result","nodesToSearch","childBBox","collides","load","insert","_build","slice","_splitRoot","tmpNode","_insert","remove","parent","goingUp","path","indexes","index","splice","_condense","compareMinX","compareMinY","toJSON","fromJSON","apply","N","M","pow","N2","N1","right2","right3","_chooseSubtree","level","minArea","minEnlargement","targetNode","area","enlargement","isNode","insertPath","_split","_adjustParentBBoxes","_chooseSplitAxis","splitIndex","_chooseSplitIndex","newNode","minOverlap","bbox1","bbox2","overlap","_allDistMargin","sort","leftBBox","rightBBox","margin","i$1","child$1","siblings","factory","Shape","ClipSpaceNearZ","AbstractRendererPlugin","plugins","addRenderingPlugin","plugin","context","renderingPlugins","removeAllRenderingPlugins","_this","forEach","AbstractRenderer","config","clipSpaceNearZ","NEGATIVE_ONE","enableDirtyCheck","enableCulling","enableAutoRendering","enableDirtyRectangleRendering","enableDirtyRectangleRenderingDebug","enableSizeAttenuation","registerPlugin","findIndex","unregisterPlugin","getPlugins","getPlugin","name","find","getConfig","setConfig","Object","assign","copyVec3","subVec3","o","addVec3","scaleVec3","getAngle","angle","undefined","createVec3","x","y","Array","isArray","deg2rad","deg","PI","rad2deg","rad","getEuler","out","quat","halfPi","_a","sx","sy","sz","asin","atan2","getEulerFromMat4","w","y2","z2","w2","unit","test","getEulerFromQuat","decompose","mat","row0x","row0y","row1x","row1y","scalingX","scalingY","perspectiveMatrix","tmpVec4","row","pdum3","combine","scale1","scale2","Mask","AABB","center","halfExtents","isEmpty","aabb","update","setMinMax","getMin","getMax","add","tc","tcx","tcy","tcz","th","thx","thy","thz","tminx","tmaxx","tminy","tmaxy","tminz","tmaxz","oc","ocx","ocy","ocz","oh","ohx","ohy","ohz","ominx","omaxx","ominy","omaxy","ominz","omaxz","setFromTransformedAABB","bc","br","ac","ar","mx0","mx1","mx2","my0","my1","my2","mz0","mz1","mz2","mx0a","abs","mx1a","mx2a","my0a","my1a","my2a","mz0a","mz1a","mz2a","aMax","aMin","bMax","bMin","intersection","minVec3","getNegativeFarPoint","plane","pnVertexFlag","getPositiveFarPoint","Plane","distance","normal","updatePNVertexFlag","Number","distanceToPoint","point","normalize","invLen","intersectsLine","start","end","d0","CameraType","CameraTrackingMode","CameraProjectionMode","Frustum","planes","extractFromVPMatrix","projectionMatrix","m0","m1","m2","m3","m4","m5","m6","m7","m8","m9","m10","m11","m12","m13","m14","m15","Point","clone","copyFrom","Rectangle","width","top","bottom","ERROR_MSG_METHOD_NOT_IMPLEMENTED","ERROR_MSG_USE_DOCUMENT_ELEMENT","UnitType","UnitCategory","ValueRange","Nested","ParenLess","CameraEvent","MIN_DISTANCE","Camera","eventEmitter","matrix","up","forward","position","focalPoint","distanceVector","azimuth","elevation","roll","relAzimuth","relElevation","relRoll","dollyingStep","maxDistance","minDistance","zoom","rotateWorld","fov","near","far","aspect","projectionMatrixInverse","jitteredProjectionMatrix","enableUpdate","type","EXPLORING","trackingMode","DEFAULT","projectionMode","PERSPECTIVE","frustum","orthoMatrix","isOrtho","ORTHOGRAPHIC","getProjectionMode","getPerspective","getPerspectiveInverse","getFrustum","getPosition","getFocalPoint","getDollyingStep","getNear","getFar","getZoom","getOrthoMatrix","getView","view","setEnableUpdate","enabled","setType","setWorldRotation","_getAngles","TRACKING","setTrackingMode","setProjectionMode","Error","flag","getViewTransform","getWorldTransform","jitterProjectionMatrix","translation","clearJitterProjectionMatrix","setMatrix","_update","setProjectionMatrix","setFov","setPerspective","setAspect","setNear","setOrthographic","rright","setFar","setViewOffset","fullWidth","fullHeight","offsetX","offsetY","clearViewOffset","setZoom","setZoomByViewportPoint","viewportPoint","canvas","viewport2Canvas","ox","oy","rotate","setPosition","setFocalPoint","_b","cx","cy","dvec","dx","dy","pan","tan","zero","c","d","makePerspective","ZERO","triggerUpdate","l","r","scaleW","scaleH","_getOrthoMatrix","_setPosition","CINEMATIC","el","az","_getAxes","_getDistance","getDistance","getDistanceVector","setDistance","pos","f","setMaxDistance","setMinDistance","setAzimuth","computeMatrix","ORBITING","_getPosition","_getFocalPoint","getAzimuth","setElevation","getElevation","setRoll","getRoll","rotZ","rotX","rotY","rotQ","rotMatrix","viewMatrix","vpMatrix","emit","tx","ty","dolly","value","createLandmark","params","gotoLandmark","options","cancelLandmarkAnimation","memoize","func","resolver","TypeError","memoized","args","_i","arguments","key","cache","has","get","set","Cache","Map","CSSStyleValueType","unit_type","kEms","kPixels","kDegrees","kRadians","kGradians","kMilliseconds","kSeconds","kRems","kTurns","GradientType","unitFromName","kNumber","kPercentage","stringToUnitType","kUnknown","conversionToCanonicalUnitsScaleFactor","factor","unitTypeToString","kInteger","CSSStyleValue","isAngle","isLength","isRelativeUnit","isTime","toString","buildCSSText","kNo","isNumericValue","getType","kUnitType","kClampType","CSSColorValue","_super","colorSpace","call","kColorType","to","CSSGradientValue","CSSKeywordValue","kKeywordType","camelCase","str","replace","toUpperCase","kebabize","split","map","letter","idx","concat","toLowerCase","join","isFunction","FORMAT_ATTR_MAP","alias","strokeDasharray","strokeWidth","textAnchor","src","formatAttributeName","attributeName","formatInfinityOrNaN","number","suffix","isFinite","bool","DCHECK","isNaN","toCanonicalUnit","category","kUNumber","kULength","kUPercent","kUTime","kUAngle","canonicalUnitTypeForCategory","kUOther","unitTypeToUnitCategory","CSSUnitValue","unitOrName","equals","other","other_unit_value","convertTo","target_unit","canonical_unit","scale_factor","text","toFixed","unit_1","Opx","Strategy","SortReason","Odeg","CSSRGB","alpha","isNone","unsetKeywordValue","initialKeywordValue","inheritKeywordValue","keywordCache","unset","initial","inherit","getOrCreateKeyword","noneColor","transparentColor","getOrCreateRGBA","getOrCreateUnitValue","PropertySyntax","EMPTY_PARSED_PATH","absolutePath","hasArc","segments","polygons","polylines","curve","totalLength","rect","colorStopToString","colorStop","parseGradient$1","tokens","linearGradient","repeatingLinearGradient","radialGradient","repeatingRadialGradient","conicGradient","sideOrCorner","extentKeywords","positionKeywords","pixelValue","percentageValue","emValue","angleValue","startCall","endCall","comma","hexColor","literalColor","rgbColor","rgbaColor","input","error","msg","getAST","ast","matchListing","matchDefinition","matchGradient","matchLinearOrientation","matchListRadialOrientations","gradientType","pattern","orientationMatcher","matchCall","captures","orientation","scan","colorStops","matchColorStop","callback","match","radialOrientations","lookaheadCache","radialOrientation","matchRadialOrientation","radialType","circle","style","matchLength","matchExtentKeyword","matchCircle","ellipse","matchDistance","matchEllipse","at","matchAtPosition","extent","positionAt","defaultPosition","matchPositioning","positioning","location","matcher","color","matchNumber","captureIndex","regexp","blankCaptures","exec","consume","size","substring","code","computeLinearGradient","rcx","rcy","cos","sin","x1","y1","x2","computeRadialGradient","regexLG","regexRG","regexPR","regexColorStop","SideOrCornerToDegMap","angleToDeg","positonToCSSUnitValue","unitX","unitY","parseGradient","colorStr","_c","previousIndex","previousOffset","offset","spaceColorStops","steps","LinearGradient","type_1","RadialGradient","stop","parseFloat","parsedRadialGradient","gradientStr","parseRadialGradient","patternStr","repetition","image","parsePattern","isPattern","object","isCSSRGB","parseColor","rgba","opacity","mergeColors","round","parseDimension","unitRegExp","string","trim","matchedUnits","taggedUnitRegExp","source","RegExp","parseLengthUnmemoize","css","parseLength","parseLengthOrPercentageUnmemoize","parseLengthOrPercentage","parseAngleUnmemoize","parseAngle","mergeDimensions","target","nonNegative","leftValue","rightValue","canonicalUnit","leftCanonicalUnitValue","rightCanonicalUnitValue","convertPercentUnit","convertAngleUnit","parseDimensionArrayFormat","parsed","segment","parseDimensionArray","valueWithUnit","vec3Index","useMin","bounds","nodeName","GROUP","getLocalBounds","getGeometryBounds","supportedFilters","parseFilter","filterStr","filterRegExp","prevLastIndex","lastIndex","numberToString","parseNumberUnmemoize","parseNumber","mergeNumbers","clampedMergeNumbers","mergeNumberLists","numberList","getOrCalculatePathTotalLength","parsedStyle","isSamePoint","point1","point2","getExtraFromSegmentWithAngle","lineWidth","prePoint","currentPoint","nextPoint","currentAndPre","currentAndNext","preAndNext","currentAngle","acos","xExtra","yExtra","xAngle","yAngle","toSymmetry","angleBetween","v0","v1","pointOnEllipticalArc","p0","rx","ry","xAxisRotation","largeArcFlag","sweepFlag","p1","xAxisRotationRadians","ellipticalArcAngle","transformedPoint","radiiCheck","cRadicand","cCoef","transformedCenter","startVector","startAngle","sweepAngle","ellipseComponentX","ellipseComponentY","ellipticalArcStartAngle","ellipticalArcEndAngle","ellipticalArcCenter","resultantRx","resultantRy","getTangentAtRatio","ratio","sign","arcParams","xRotation","arcFlag","p2","xDist","yDist","dist","vMag","v","vRatio","u","vAngle","getArcParams","startPoint","xp","yp","lambda","diff","cxp","cyp","theta","dTheta","endAngle","ellipseToCommands","convertToPath","transform","getLocalTransform","commands","LINE","_d","_e","lineToCommands","CIRCLE","_f","_g","_h","_j","ELLIPSE","_k","_l","_m","_o","_p","POLYLINE","POLYGON","points","closed","polygonToCommands","RECT","_q","_r","width_1","_s","height_1","_t","_u","radius","hasRadius","some","tlr","trr","brr","blr","signX","signY","filter","command","rectToCommands","PATH","reduce","prev","cur","p3","commandsToPathString","internalParsePath","e","console","prevSegment","prevCmd","srcPoint","destPoint","removeRedundantMCommand","count","cmd","hasArcOrBezier","pathArray","extractPolygons","nextParams","startMovePoint","lastStartMovePointIndex","startTangent","endTangent","box","cubicParams","len","includes","cp","preSegment","cp1","cp2","dx1","dy1","dx2","dy2","path2Segments","xArr","yArr","segmentsWithAngle","getPathBBox","memoizedParsePath","parsePath","mergePaths","curve1","curve2","curves","curve0","parsePoints","pointsOrStr","pointStr","mergePoints","_","cast","contents","id","transformFunctions","matrix3d","rotatex","rotatey","rotatez","rotate3d","perspective","scale","scalex","scaley","scalez","scale3d","skew","skewx","skewy","translate","translatex","translatey","translatez","translate3d","parseTransform","transformRegExp","functionName","functionData","argTypes","parsedArgs","arg","parsedArg","A","T","L","parseTransformUnmemoize","convertItemToMatrix","sqrLength","length_1","sc","sq","multiplyMatrices","makeMatrixDecomposition","transformList","quaternion","m44","mat4x4","a03","a13","a23","a30","a31","a32","a33","decomposeMat4","convertToMatrix","composeMatrix","multiply","temp","numberToLongString","mergeMatrices","leftArgs","rightArgs","decompositionPair","list","q","fromQ","toQ","product","v2","dot","typeTo2D","typeTo3D","mergeTransforms","flipResults","_loop_1","defaultValue","lt","rt","leftResult","rightResult","types","merged","leftType","rightType","leftFunctionData","rightFunctionData","leftArgsCopy","rightArgsCopy","stringConversions","stringifiedArgs","parseTransformOrigin","values","convertKeyword2Percent","parseTransformOriginUnmemoize","keyword","BUILT_IN_PROPERTIES","int","inh","syntax","OPACITY_VALUE","PAINT","COLOR","LENGTH_PERCENTAGE","SHADOW_BLUR","LENGTH_PERCENTAGE_12","DEFINED_PATH","OFFSET_DISTANCE","ind","Z_INDEX","FILTER","TRANSFORM","TRANSFORM_ORIGIN","COORDINATE","LENGTH_PERCENTAGE_14","LIST_OF_POINTS","TEXT","TEXT_TRANSFORM","LENGTH","NUMBER","MARKER","GEOMETRY_ATTRIBUTE_NAMES","propertyMetadataCache","unresolvedProperties","WeakMap","DefaultStyleValueRegistry","runtime","property","registerMetadata","metadata","unregisterMetadata","getPropertySyntax","CSSPropertySyntaxFactory","processProperties","attributes","skipUpdateAttribute","skipParse","forceUpdateGeometry","usedAttributes","enableCSSParsing","skipUpdateAttribute_1","memoize_1","needUpdateGeometry_1","attributeNames_1","keys","computedStyle","parseProperty","from","Set","computeProperty","geometry","dirty","renderable","boundsDirty","renderBoundsDirty","sceneGraphService","dirtifyToRoot","postProcessProperty","isPropertyInheritable","internalSetAttribute","attributeNames","oldClipPath","clipPath","oldOffsetPath","offsetPath","needUpdateGeometry","fill","stroke","shadowColor","lineDash","textTransform","calculator","transformOrigin","markerStart","markerEnd","markerMid","zIndex","postProcessor","offsetDistance","computed","keywords","handler","parserUnmemoize","parser","isDocumentElement","used","inherited","resolved","tryToResolveProperty","addUnresolveProperty","oldParsedValue","propertyHandler","properties","parentElement","isPropertyResolved","usedValue","recalc","attributes_1","delete","updateGeometry","geometryUpdater","geometryUpdaterFactory","geometry_1","contentBounds","renderBounds","cz","hwidth","hheight","hdepth","increasedLineWidthForHitTesting","shadowType","expansion","SQRT2","halfLineWidth","shadowBlurInPixels","shadowBlur","shadowOffsetXInPixels","shadowOffsetX","shadowOffsetYInPixels","shadowOffsetY","shadowLeft","shadowRight","shadowTop","shadowBottom","blurRadius","flipX","usedOriginXValue","usedOriginYValue","setOrigin","updateSizeAttenuation","isSizeAttenuation","rawLineWidth","rawR","CSSPropertyAngle","parserWithCSSDisabled","mixer","oldParsed","CSSPropertyClipPath","oldPath","newPath","updateDisplayObjectDependency","childNodes","CSSPropertyColor","CSSPropertyFilter","getFontSize","fontSize","CSSPropertyLengthOrPercentage","registry","styleValueRegistry","parentNode","ownerDocument","documentElement","CSSPropertyLengthOrPercentage12","CSSPropertyLengthOrPercentage14","CSSPropertyMarker","oldMarker","newMarker","cloned","cloneNode","isMarker","CSSPropertyNumber","CSSPropertyOffsetDistance","getPoint","setLocalPosition","CSSPropertyOpacity","CSSPropertyPath","CSSPropertyPoints","CSSPropertyShadowBlur","CSSPropertyText","nodeValue","CSSPropertyTextTransform","rawText","getAttribute","transformedText","charAt","canvasMap","defaultCanvasIdCounter","isBrowser","document","isElement","sortByZIndex","o1","o2","zIndex1","zIndex2","parent_1","findClosestClipPathTarget","PX_SUFFIX","setDOMSize","$el","getStyle","defaultView","getComputedStyle","getPropertyValue","TOUCH_TO_POINTER","touchstart","touchend","touchendoutside","touchmove","touchcancel","clock","performance","now","Date","isFillOrStrokeAffected","pointerEvents","hasFill","hasStroke","isFillOtherThanNone","isStrokeOtherThanNone","uId","root","global","nowOffset","reservedCBs","lastTime","polyfillRaf","currentTime","gap","delay","setTimeout","copied","polyfillCaf","getRequestAnimationFrame","vp","predicate","raf","caf","getCancelAnimationFrame","requestAnimationFrame","cancelAnimationFrame","AsyncParallelHook","callbacks","getCallbacksNum","tapPromise","fn","promise","Promise","AsyncSeriesWaterfallHook","label","sent","SyncHook","tap","argsArr","SyncWaterfallHook","genericFontFamilies","stringRegExp","createSkewMatrix","skewMatrix","skewX","skewY","SCALE_EPSILON","tmpMat1","tmpMat2","parsedTransformToMat4","m_1","newScale","newTranslation","newAngles","newSkew","dd","setLocalTransform","resetLocalTransform","CSSPropertyTransform","CSSPropertyTransformOrigin","CSSPropertyZIndex","parentEntity","parentRenderable","parentSortable","sortable","dirtyReason","Z_INDEX_CHANGED","CircleUpdater","EllipseUpdater","LineUpdater","PathUpdater","PolylineUpdater","RectUpdater","contentWidth","contentHeight","TextUpdater","globalRuntime","isReadyToMeasure","textAlign","textBaseline","fontStyle","fontWeight","fontVariant","metrics","font","lines","lineWidths","lineHeight","maxLineWidth","fontProperties","ascent","descent","lineMetrics","offscreenCanvas","textService","measureText","lineXOffset","lineYOffset","GroupUpdater","RenderReason","FederatedEvent","manager","eventPhase","NONE","bubbles","cancelBubble","cancelable","defaultPrevented","propagationStopped","propagationImmediatelyStopped","layer","page","viewport","composed","CAPTURING_PHASE","AT_TARGET","BUBBLING_PHASE","defineProperty","enumerable","configurable","composedPath","propagationPath","preventDefault","nativeEvent","Event","stopImmediatePropagation","stopPropagation","initEvent","initUIEvent","FederatedMouseEvent","client","movement","screen","getModifierState","initMouseEvent","FederatedPointerEvent","isPrimary","getCoalescedEvents","getPredictedEvents","clonePointerEvent","FederatedWheelEvent","cloneWheelEvent","CustomEvent","eventName","detail","EventTarget","emitter","on","listener","addEventListener","capture","once","useDelegatedName","delegatedName","name_1","handleEvent","originListener_1","off","removeEventListener","removeAllEventListeners","removeAllListeners","dispatchEvent","skipPropagate","getEventService","Node","shadow","isConnected","baseURI","nodeType","e_1","next","done","textContent","e_1_1","return","content","removeChild","getRootNode","opts","host","hasChildNodes","isDefaultNamespace","namespace","lookupNamespaceURI","prefix","lookupPrefix","isEqualNode","otherNode","isSameNode","compareDocumentPosition","node1Root","node2Root","node1Hierarchy","node2Hierarchy","DOCUMENT_POSITION_DISCONNECTED","DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC","DOCUMENT_POSITION_PRECEDING","longerHierarchy","shorterHierarchy","DOCUMENT_POSITION_CONTAINED_BY","DOCUMENT_POSITION_FOLLOWING","DOCUMENT_POSITION_CONTAINS","longerStart","shorterHierarchyNode","longerHierarchyNode","contain","getAncestor","assigned","EventService","nativeHTMLMap","cursor","mappingTable","mappingState","trackingData","eventPool","tmpMatrix","tmpVec3","onPointerDown","createPointerEvent","pointerType","isRightButton","button","pointerId","pressTargetsByButton","freeEvent","onPointerUp","alwaysTriggerPointerEventOnCanvas","rootTarget","pressTarget","findMountedTarget","clickTarget","currentTarget","notifyTarget","clickEvent","clicksByButton","clickCount","timeStamp","clickHistory","preventClick","useNativeClickEvent","onPointerMove","isMouse","outTarget","overTargets","outType","outEvent","leaveEvent","overType","overEvent","overTargetAncestor","enterEvent","getCursor","onPointerOut","onPointerOver","onPointerUpOutside","onWheel","wheelEvent","createWheelEvent","onClick","onPointerCancel","init","renderingContext","addEventMapping","destroy","getScale","contextService","getBoundingClientRect","scaleX","scaleY","getDomElement","offsetWidth","offsetHeight","client2Viewport","viewport2Client","camera","getCamera","worldMatrix","canvas2Viewport","canvasP","clip","setPickHandler","pickHandler","priority","mapEvent","mappers","warn","notifyListeners","propagate","unshift","hitTest","viewportX","viewportY","disableHitTesting","isNativeEventFromCanvas","shadowRoot","getExistedHTML","event","eventTarget","existed","pickTarget","clientX","clientY","canvasX","canvasY","fallbackTarget","allocateEvent","copyPointerData","copyMouseData","copyData","originalEvent","existedHTML","copyWheelData","overTarget","pressure","tangentialPressure","tiltX","tiltY","twist","altKey","buttons","ctrlKey","metaKey","shiftKey","deltaMode","deltaX","deltaY","deltaZ","isTrusted","constructor","listeners","_events","removeListener","OffscreenCanvasCreator","getOrCreateCanvas","contextAttributes","getContext","willReadFrequently","OffscreenCanvas","createElement","ex","getOrCreateContext","ElementEvent","RenderingService","inited","stats","total","rendered","zIndexCounter","hooks","initAsync","dirtycheck","cull","beginFrame","beforeRender","render","afterRender","endFrame","pick","pickSync","pointerDown","pointerUp","pointerMove","pointerOut","pointerOver","pointerWheel","pointerCancel","click","then","getStats","disableDirtyRectangleRendering","renderer","renderReasons","CAMERA_CHANGED","canvasConfig","frame","rerenderCallback","syncHierarchy","triggerPendingEvents","dirtyRectangleRenderingDisabled","onlyCameraChanged","shouldTriggerRenderHooks","disableRenderHooks","renderDisplayObject","renderListCurrentFrame","displayObject","objectChanged","objectToRender","renderOrder","dirtyChildren","sorted","index_1","index_2","array","low","high","sortedIndex","clearPendingEvents","dirtify","DISPLAY_OBJECT_CHANGED","ATTRIBUTE_REGEXP","DefaultSceneGraphSelector","selectOne","query","startsWith","classList","getIdOrClassname","value_1","attributeToString","selectAll","findAll","name_2","value_2","is","className","name_3","matches","MutationEvent","typeArg","relatedNode","prevValue","newValue","attrName","attrChange","prevParsedValue","newParsedValue","ADDITION","MODIFICATION","REMOVAL","markRenderableDirty","rectUpdater","polylineUpdater","reparentEvent","REPARENT","DefaultSceneGraphService","parentInvertRotation","rotation","invParentRot","parentInvertMatrix","tmpPosition","zeroVec3","tr","pendingEvents","boundsChangedEvent","BOUNDS_CHANGED","element","degrees","transformable","rot","getRotation","parentRot","localRotation","dirtifyLocal","rotateLocal","setEulerAngles","parentRotation","setLocalEulerAngles","translateLocal","localPosition","parentTransform","worldTransform","setRotation","setLocalRotation","displayObjectDependencyMap","calcLocalTransform","tmpMat","tmpQuat","localSkew","localTransform","origin","tmpMat4","scaling","localScale","sceneGraphSelector","querySelector","querySelectorAll","attach","detached","detach","ADDED","dirtifyWorld","frozen","unfreezeParentToRoot","REMOVED","getOrigin","originVec","scaleLocal","setLocalScale","updatedScaling","setLocalSkew","localDirtyFlag","dirtyFlag","dirtifyWorldInternal","trigger","entity","isMutationObserved","affectChildren","informDependentDisplayObjects","oldDependencyMap","newDependencyMap","dependencyMap","ATTR_MODIFIED","isCustomElement","attributeChangedCallback","sync","getLocalPosition","getLocalRotation","getLocalScale","getLocalSkew","getTransformedGeometryBounds","existedAABB","getBounds","childBounds","clipped","clipPathBounds","parentInvert","localBounds","getContextService","top_1","childTransform","TEXT_METRICS","MetricsString","BaselineSymbol","BaselineMultiplier","HeightMultiplier","Newlines","BreakingSpaces","LATIN_REGEX","regexCannotStart","regexCannotEnd","TextService","fontMetricsCache","shouldBreakByKinsokuShorui","char","nextChar","isBreakingSpace","trimByKinsokuShorui","prevLine","lastChar","measureFont","offscreenCanvasCreator","metricsString","baseline","fillStyle","fillRect","fillText","imagedata","getImageData","pixels","line","wordWrap","strokeHeight","letterSpacing","textPath","textPathSide","textPathStartOffset","leading","fontFamily","fontSizeString","fontFamilies","fontFamily_1","toFontString","isOverflowing","lineWidth_1","lineHeight_1","offsetY_1","getTotalLength","setGraphemeOnPath","wordWrapWidth","maxLines","textOverflow","maxWidth","ellipsis","currentIndex","currentWidth","calcWidth","getFromCache","ellipsisWidth","chars","prevChar","charWidth","isNewline","currentLineLength","lastLineWidth","lastLineIndex","i_1","canBreakInLastChar","trimToBreakable","sumTextWidthByCache","charCodeAt","findBreakableIndex","trimmedChar","trimFrom","trimTo","sum","spacing","IMAGE","HTML","MESH","PERCENTAGE","ANGLE","CameraContribution","AnimationTimeline","EasingFunction","layoutRegistry","enableDataset","enableStyleSyntax","enableAttributeDashCased","entityCounter","insertedEvent","INSERTED","removedEvent","destroyEvent","DESTROY","Element","dirtyRenderBounds","cullable","strategy","Standard","visibilityPlaneMask","visible","enable","rBushNode","namespaceURI","scrollLeft","scrollTop","clientTop","clientLeft","destroyed","fillOpacity","strokeOpacity","visibility","lineCap","lineJoin","setAttribute","firstChild","lastChild","deep","appendChild","mountChildren","insertBefore","newChild","refChild","replaceChild","oldChild","unmountChildren","removeChildren","destroyChildren","selector","getElementById","getElementsByName","getElementsByClassName","getElementsByTagName","tagName","selectors","closest","objects","after","nodes","before","first","rest","replaceWith","append","prepend","replaceChildren","getRenderBounds","getClientRects","computedStyleMap","entries","getAttributeNames","isSymbol","hasAttribute","qualifiedName","hasAttributes","removeAttribute","force","getAttributeNS","localName","getAttributeNode","getAttributeNodeNS","hasAttributeNS","removeAttributeNS","removeAttributeNode","attr","setAttributeNS","setAttributeNode","setAttributeNodeNS","toggleAttribute","isDisplayObject","CanvasEvent","Proxy","mutationEvent","DEFAULT_STYLE_PROPS","DEFAULT_PARSED_STYLE_PROPS","miterLimit","INHERITABLE_STYLE_PROPS","DATASET_PREFIX","DisplayObject","activeAnimations","class","initialParsedStyle","initAttributes","dataset","formattedName","prop","setProperty","propertyName","removeProperty","getAnimations","animation","cancel","customCloneFunc","clonedStyle","attribute","interactive","clonedChild","formattedAttributes","parseOptions","oldValue","getBBox","getEulerAngles","getLocalEulerAngles","animate","keyframes","timeline","play","isVisible","isInteractive","isCulled","toFront","toBack","getMatrix","transformMat4","eux","euz","fromRotationTranslationScale","getLocalMatrix","setLocalMatrix","show","hide","getCount","childElementCount","getParent","getChildren","getFirst","firstElementChild","getLast","lastElementChild","getChildByIndex","moveTo","move","setZIndex","Circle","CustomElement","Ellipse","Group","innerHTML","clientRect","canvasRect","Image","Line","z1","markerStartAngle","markerEndAngle","transformMarker","isStart","markerStartOffset","markerEndOffset","marker","originalAngle","inWorldSpace","transformed","getPointAtLength","Path","markerMidList","placeMarkerMid","getStartTangent","getEndTangent","endPoint","tangent","Polygon","isClosed","Polyline","polyline","segmentT_1","segmentL_1","segments_1","tempLength_1","totalLength_1","subt","Rect","Text","getComputedTextLength","getLineBoundingRects","CustomElementRegistry","define","CSS","percent","px","em","rem","grad","turn","ms","registerProperty","definition","inherits","interpolable","initialValue","registerLayout","clazz","Document","initialStyle","customElements","shape","createElementNS","elementsFromBBox","rBushNodes","rBushRoot","hitTestList","isVisibilityAffected","elementFromPointSync","picked","getRenderingService","topmost","elementFromPoint","elementsFromPointSync","elementsFromPoint","CullingPlugin","strategies","renderingService","tag","unculledEntities","every","CULLED","EventPlugin","autoPreventDefault","rootPointerEvent","rootWheelEvent","supportsTouchEvents","normalizedEvents","normalizeToPointerEvent","normalizedEvents_1","normalizedEvents_1_1","normalizedEvent","event_1","bootstrapEvent","eventService","setCursor","e_2","normalizedEvents_2","normalizedEvents_2_1","event_2","e_2_1","normalizeWheelEvent","e_3","events","isNormalized","events_1","events_1_1","event_3","federatedEvent","e_3_1","e_4","$element","outside","normalizedEvents_3","normalizedEvents_3_1","event_4","e_4_1","e_5","normalizedEvents_4","normalizedEvents_4_1","event_5","e_5_1","transferMouseData","srcElement","movementX","movementY","pageX","pageY","screenX","screenY","relatedTarget","applyCursorStyle","isTouchEvent","changedTouches","touch","touches","radiusX","radiusY","identifier","isMouseEvent","tempEvent","shape2D","FrustumCullingStrategy","parentVisibilityPlaneMask","computeVisibilityWithPlaneMask","INDETERMINATE","OUTSIDE","parentPlaneMask","INSIDE","mask","isShape2D","PrepareRendererPlugin","toSync","isFirstTimeRendering","syncing","isFirstTimeRenderingFinished","rBush","handleAttributeChanged","handleBoundsChanged","handleMounted","handleUnmounted","MOUNTED","UNMOUNTED","ric","requestIdleCallback","bind","syncRTree","bulk","mountedEvent","unmountedEvent","beforeRenderEvent","BEFORE_RENDER","rerenderEvent","RERENDER","afterRenderEvent","AFTER_RENDER","Canvas","container","devicePixelRatio","background","createImage","supportsPointerEvents","supportsCSSTransform","supportsMutipleCanvasesInOneContainer","cleanExistedCanvas","canvasWidth","canvasHeight","dpr","getWidth","getHeight","PointerEvent","TouchEvent","MouseEvent","initRenderingContext","initDefaultCamera","initRenderer","mergedConfig","getRoot","getRenderingContext","readyPromise","resolve","resolveReadyPromise","cleanUp","skipTriggerEvent","BEFORE_DESTROY","frameId","AFTER_DESTROY","changeSize","resize","RESIZE","run","tick","time","firstContentfullPaint","loadRendererContainerModule","ContextService","initRenderingService","async","READY","RENDERER_CHANGED","setRenderer","oldRenderer","reverse","disconnectedCallback","connectedCallback","getPointByClient","getClientByPoint"],"sourceRoot":""}